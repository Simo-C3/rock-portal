(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function Mu(t,e){const n=Object.create(null),s=t.split(",");for(let r=0;r<s.length;r++)n[s[r]]=!0;return e?r=>!!n[r.toLowerCase()]:r=>!!n[r]}function Bu(t){if(X(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],r=Ve(s)?Uw(s):Bu(s);if(r)for(const i in r)e[i]=r[i]}return e}else{if(Ve(t))return t;if(Ce(t))return t}}const Fw=/;(?![^(]*\))/g,Vw=/:([^]+)/,$w=/\/\*.*?\*\//gs;function Uw(t){const e={};return t.replace($w,"").split(Fw).forEach(n=>{if(n){const s=n.split(Vw);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function da(t){let e="";if(Ve(t))e=t;else if(X(t))for(let n=0;n<t.length;n++){const s=da(t[n]);s&&(e+=s+" ")}else if(Ce(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const qw="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",jw=Mu(qw);function Wd(t){return!!t||t===""}const Qw=t=>Ve(t)?t:t==null?"":X(t)||Ce(t)&&(t.toString===Zd||!Z(t.toString))?JSON.stringify(t,Yd,2):String(t),Yd=(t,e)=>e&&e.__v_isRef?Yd(t,e.value):Gs(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,r])=>(n[`${s} =>`]=r,n),{})}:Jd(e)?{[`Set(${e.size})`]:[...e.values()]}:Ce(e)&&!X(e)&&!eg(e)?String(e):e,Ie={},Ks=[],Rt=()=>{},Hw=()=>!1,Kw=/^on[^a-z]/,ga=t=>Kw.test(t),Pu=t=>t.startsWith("onUpdate:"),ft=Object.assign,Lu=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Gw=Object.prototype.hasOwnProperty,ce=(t,e)=>Gw.call(t,e),X=Array.isArray,Gs=t=>pa(t)==="[object Map]",Jd=t=>pa(t)==="[object Set]",Z=t=>typeof t=="function",Ve=t=>typeof t=="string",Fu=t=>typeof t=="symbol",Ce=t=>t!==null&&typeof t=="object",Xd=t=>Ce(t)&&Z(t.then)&&Z(t.catch),Zd=Object.prototype.toString,pa=t=>Zd.call(t),zw=t=>pa(t).slice(8,-1),eg=t=>pa(t)==="[object Object]",Vu=t=>Ve(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Co=Mu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ma=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},Ww=/-(\w)/g,zt=ma(t=>t.replace(Ww,(e,n)=>n?n.toUpperCase():"")),Yw=/\B([A-Z])/g,Er=ma(t=>t.replace(Yw,"-$1").toLowerCase()),ya=ma(t=>t.charAt(0).toUpperCase()+t.slice(1)),hc=ma(t=>t?`on${ya(t)}`:""),li=(t,e)=>!Object.is(t,e),fc=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},Lo=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},tg=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Sh;const Jw=()=>Sh||(Sh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let $t;class Xw{constructor(e=!1){this.detached=e,this.active=!0,this.effects=[],this.cleanups=[],this.parent=$t,!e&&$t&&(this.index=($t.scopes||($t.scopes=[])).push(this)-1)}run(e){if(this.active){const n=$t;try{return $t=this,e()}finally{$t=n}}}on(){$t=this}off(){$t=this.parent}stop(e){if(this.active){let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.scopes)for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this.active=!1}}}function Zw(t,e=$t){e&&e.active&&e.effects.push(t)}const $u=t=>{const e=new Set(t);return e.w=0,e.n=0,e},ng=t=>(t.w&Cn)>0,sg=t=>(t.n&Cn)>0,eA=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Cn},tA=t=>{const{deps:e}=t;if(e.length){let n=0;for(let s=0;s<e.length;s++){const r=e[s];ng(r)&&!sg(r)?r.delete(t):e[n++]=r,r.w&=~Cn,r.n&=~Cn}e.length=n}},Lc=new WeakMap;let Kr=0,Cn=1;const Fc=30;let Nt;const us=Symbol(""),Vc=Symbol("");class Uu{constructor(e,n=null,s){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,Zw(this,s)}run(){if(!this.active)return this.fn();let e=Nt,n=En;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Nt,Nt=this,En=!0,Cn=1<<++Kr,Kr<=Fc?eA(this):Dh(this),this.fn()}finally{Kr<=Fc&&tA(this),Cn=1<<--Kr,Nt=this.parent,En=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Nt===this?this.deferStop=!0:this.active&&(Dh(this),this.onStop&&this.onStop(),this.active=!1)}}function Dh(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let En=!0;const rg=[];function Ir(){rg.push(En),En=!1}function br(){const t=rg.pop();En=t===void 0?!0:t}function It(t,e,n){if(En&&Nt){let s=Lc.get(t);s||Lc.set(t,s=new Map);let r=s.get(n);r||s.set(n,r=$u()),ig(r)}}function ig(t,e){let n=!1;Kr<=Fc?sg(t)||(t.n|=Cn,n=!ng(t)):n=!t.has(Nt),n&&(t.add(Nt),Nt.deps.push(t))}function nn(t,e,n,s,r,i){const o=Lc.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&X(t)){const c=tg(s);o.forEach((u,l)=>{(l==="length"||l>=c)&&a.push(u)})}else switch(n!==void 0&&a.push(o.get(n)),e){case"add":X(t)?Vu(n)&&a.push(o.get("length")):(a.push(o.get(us)),Gs(t)&&a.push(o.get(Vc)));break;case"delete":X(t)||(a.push(o.get(us)),Gs(t)&&a.push(o.get(Vc)));break;case"set":Gs(t)&&a.push(o.get(us));break}if(a.length===1)a[0]&&$c(a[0]);else{const c=[];for(const u of a)u&&c.push(...u);$c($u(c))}}function $c(t,e){const n=X(t)?t:[...t];for(const s of n)s.computed&&Nh(s);for(const s of n)s.computed||Nh(s)}function Nh(t,e){(t!==Nt||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const nA=Mu("__proto__,__v_isRef,__isVue"),og=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Fu)),sA=qu(),rA=qu(!1,!0),iA=qu(!0),kh=oA();function oA(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const s=he(this);for(let i=0,o=this.length;i<o;i++)It(s,"get",i+"");const r=s[e](...n);return r===-1||r===!1?s[e](...n.map(he)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){Ir();const s=he(this)[e].apply(this,n);return br(),s}}),t}function qu(t=!1,e=!1){return function(s,r,i){if(r==="__v_isReactive")return!t;if(r==="__v_isReadonly")return t;if(r==="__v_isShallow")return e;if(r==="__v_raw"&&i===(t?e?IA:hg:e?lg:ug).get(s))return s;const o=X(s);if(!t&&o&&ce(kh,r))return Reflect.get(kh,r,i);const a=Reflect.get(s,r,i);return(Fu(r)?og.has(r):nA(r))||(t||It(s,"get",r),e)?a:tt(a)?o&&Vu(r)?a:a.value:Ce(a)?t?fg(a):_r(a):a}}const aA=ag(),cA=ag(!0);function ag(t=!1){return function(n,s,r,i){let o=n[s];if(Zs(o)&&tt(o)&&!tt(r))return!1;if(!t&&(!Fo(r)&&!Zs(r)&&(o=he(o),r=he(r)),!X(n)&&tt(o)&&!tt(r)))return o.value=r,!0;const a=X(n)&&Vu(s)?Number(s)<n.length:ce(n,s),c=Reflect.set(n,s,r,i);return n===he(i)&&(a?li(r,o)&&nn(n,"set",s,r):nn(n,"add",s,r)),c}}function uA(t,e){const n=ce(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&n&&nn(t,"delete",e,void 0),s}function lA(t,e){const n=Reflect.has(t,e);return(!Fu(e)||!og.has(e))&&It(t,"has",e),n}function hA(t){return It(t,"iterate",X(t)?"length":us),Reflect.ownKeys(t)}const cg={get:sA,set:aA,deleteProperty:uA,has:lA,ownKeys:hA},fA={get:iA,set(t,e){return!0},deleteProperty(t,e){return!0}},dA=ft({},cg,{get:rA,set:cA}),ju=t=>t,wa=t=>Reflect.getPrototypeOf(t);function oo(t,e,n=!1,s=!1){t=t.__v_raw;const r=he(t),i=he(e);n||(e!==i&&It(r,"get",e),It(r,"get",i));const{has:o}=wa(r),a=s?ju:n?Ku:hi;if(o.call(r,e))return a(t.get(e));if(o.call(r,i))return a(t.get(i));t!==r&&t.get(e)}function ao(t,e=!1){const n=this.__v_raw,s=he(n),r=he(t);return e||(t!==r&&It(s,"has",t),It(s,"has",r)),t===r?n.has(t):n.has(t)||n.has(r)}function co(t,e=!1){return t=t.__v_raw,!e&&It(he(t),"iterate",us),Reflect.get(t,"size",t)}function Oh(t){t=he(t);const e=he(this);return wa(e).has.call(e,t)||(e.add(t),nn(e,"add",t,t)),this}function Rh(t,e){e=he(e);const n=he(this),{has:s,get:r}=wa(n);let i=s.call(n,t);i||(t=he(t),i=s.call(n,t));const o=r.call(n,t);return n.set(t,e),i?li(e,o)&&nn(n,"set",t,e):nn(n,"add",t,e),this}function Mh(t){const e=he(this),{has:n,get:s}=wa(e);let r=n.call(e,t);r||(t=he(t),r=n.call(e,t)),s&&s.call(e,t);const i=e.delete(t);return r&&nn(e,"delete",t,void 0),i}function Bh(){const t=he(this),e=t.size!==0,n=t.clear();return e&&nn(t,"clear",void 0,void 0),n}function uo(t,e){return function(s,r){const i=this,o=i.__v_raw,a=he(o),c=e?ju:t?Ku:hi;return!t&&It(a,"iterate",us),o.forEach((u,l)=>s.call(r,c(u),c(l),i))}}function lo(t,e,n){return function(...s){const r=this.__v_raw,i=he(r),o=Gs(i),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,u=r[t](...s),l=n?ju:e?Ku:hi;return!e&&It(i,"iterate",c?Vc:us),{next(){const{value:h,done:f}=u.next();return f?{value:h,done:f}:{value:a?[l(h[0]),l(h[1])]:l(h),done:f}},[Symbol.iterator](){return this}}}}function hn(t){return function(...e){return t==="delete"?!1:this}}function gA(){const t={get(i){return oo(this,i)},get size(){return co(this)},has:ao,add:Oh,set:Rh,delete:Mh,clear:Bh,forEach:uo(!1,!1)},e={get(i){return oo(this,i,!1,!0)},get size(){return co(this)},has:ao,add:Oh,set:Rh,delete:Mh,clear:Bh,forEach:uo(!1,!0)},n={get(i){return oo(this,i,!0)},get size(){return co(this,!0)},has(i){return ao.call(this,i,!0)},add:hn("add"),set:hn("set"),delete:hn("delete"),clear:hn("clear"),forEach:uo(!0,!1)},s={get(i){return oo(this,i,!0,!0)},get size(){return co(this,!0)},has(i){return ao.call(this,i,!0)},add:hn("add"),set:hn("set"),delete:hn("delete"),clear:hn("clear"),forEach:uo(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=lo(i,!1,!1),n[i]=lo(i,!0,!1),e[i]=lo(i,!1,!0),s[i]=lo(i,!0,!0)}),[t,n,e,s]}const[pA,mA,yA,wA]=gA();function Qu(t,e){const n=e?t?wA:yA:t?mA:pA;return(s,r,i)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?s:Reflect.get(ce(n,r)&&r in s?n:s,r,i)}const AA={get:Qu(!1,!1)},vA={get:Qu(!1,!0)},EA={get:Qu(!0,!1)},ug=new WeakMap,lg=new WeakMap,hg=new WeakMap,IA=new WeakMap;function bA(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function _A(t){return t.__v_skip||!Object.isExtensible(t)?0:bA(zw(t))}function _r(t){return Zs(t)?t:Hu(t,!1,cg,AA,ug)}function TA(t){return Hu(t,!1,dA,vA,lg)}function fg(t){return Hu(t,!0,fA,EA,hg)}function Hu(t,e,n,s,r){if(!Ce(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=r.get(t);if(i)return i;const o=_A(t);if(o===0)return t;const a=new Proxy(t,o===2?s:n);return r.set(t,a),a}function zs(t){return Zs(t)?zs(t.__v_raw):!!(t&&t.__v_isReactive)}function Zs(t){return!!(t&&t.__v_isReadonly)}function Fo(t){return!!(t&&t.__v_isShallow)}function dg(t){return zs(t)||Zs(t)}function he(t){const e=t&&t.__v_raw;return e?he(e):t}function gg(t){return Lo(t,"__v_skip",!0),t}const hi=t=>Ce(t)?_r(t):t,Ku=t=>Ce(t)?fg(t):t;function pg(t){En&&Nt&&(t=he(t),ig(t.dep||(t.dep=$u())))}function mg(t,e){t=he(t),t.dep&&$c(t.dep)}function tt(t){return!!(t&&t.__v_isRef===!0)}function CA(t){return yg(t,!1)}function xA(t){return yg(t,!0)}function yg(t,e){return tt(t)?t:new SA(t,e)}class SA{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:he(e),this._value=n?e:hi(e)}get value(){return pg(this),this._value}set value(e){const n=this.__v_isShallow||Fo(e)||Zs(e);e=n?e:he(e),li(e,this._rawValue)&&(this._rawValue=e,this._value=n?e:hi(e),mg(this))}}function Ws(t){return tt(t)?t.value:t}const DA={get:(t,e,n)=>Ws(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const r=t[e];return tt(r)&&!tt(n)?(r.value=n,!0):Reflect.set(t,e,n,s)}};function wg(t){return zs(t)?t:new Proxy(t,DA)}var Ag;class NA{constructor(e,n,s,r){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this[Ag]=!1,this._dirty=!0,this.effect=new Uu(e,()=>{this._dirty||(this._dirty=!0,mg(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=s}get value(){const e=he(this);return pg(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}Ag="__v_isReadonly";function kA(t,e,n=!1){let s,r;const i=Z(t);return i?(s=t,r=Rt):(s=t.get,r=t.set),new NA(s,r,i||!r,n)}function In(t,e,n,s){let r;try{r=s?t(...s):t()}catch(i){Aa(i,e,n)}return r}function Mt(t,e,n,s){if(Z(t)){const i=In(t,e,n,s);return i&&Xd(i)&&i.catch(o=>{Aa(o,e,n)}),i}const r=[];for(let i=0;i<t.length;i++)r.push(Mt(t[i],e,n,s));return r}function Aa(t,e,n,s=!0){const r=e?e.vnode:null;if(e){let i=e.parent;const o=e.proxy,a=n;for(;i;){const u=i.ec;if(u){for(let l=0;l<u.length;l++)if(u[l](t,o,a)===!1)return}i=i.parent}const c=e.appContext.config.errorHandler;if(c){In(c,null,10,[t,o,a]);return}}OA(t,n,r,s)}function OA(t,e,n,s=!0){console.error(t)}let fi=!1,Uc=!1;const et=[];let qt=0;const Ys=[];let Xt=null,Jn=0;const vg=Promise.resolve();let Gu=null;function Eg(t){const e=Gu||vg;return t?e.then(this?t.bind(this):t):e}function RA(t){let e=qt+1,n=et.length;for(;e<n;){const s=e+n>>>1;di(et[s])<t?e=s+1:n=s}return e}function zu(t){(!et.length||!et.includes(t,fi&&t.allowRecurse?qt+1:qt))&&(t.id==null?et.push(t):et.splice(RA(t.id),0,t),Ig())}function Ig(){!fi&&!Uc&&(Uc=!0,Gu=vg.then(_g))}function MA(t){const e=et.indexOf(t);e>qt&&et.splice(e,1)}function BA(t){X(t)?Ys.push(...t):(!Xt||!Xt.includes(t,t.allowRecurse?Jn+1:Jn))&&Ys.push(t),Ig()}function Ph(t,e=fi?qt+1:0){for(;e<et.length;e++){const n=et[e];n&&n.pre&&(et.splice(e,1),e--,n())}}function bg(t){if(Ys.length){const e=[...new Set(Ys)];if(Ys.length=0,Xt){Xt.push(...e);return}for(Xt=e,Xt.sort((n,s)=>di(n)-di(s)),Jn=0;Jn<Xt.length;Jn++)Xt[Jn]();Xt=null,Jn=0}}const di=t=>t.id==null?1/0:t.id,PA=(t,e)=>{const n=di(t)-di(e);if(n===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function _g(t){Uc=!1,fi=!0,et.sort(PA);const e=Rt;try{for(qt=0;qt<et.length;qt++){const n=et[qt];n&&n.active!==!1&&In(n,null,14)}}finally{qt=0,et.length=0,bg(),fi=!1,Gu=null,(et.length||Ys.length)&&_g()}}function LA(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||Ie;let r=n;const i=e.startsWith("update:"),o=i&&e.slice(7);if(o&&o in s){const l=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:f}=s[l]||Ie;f&&(r=n.map(g=>Ve(g)?g.trim():g)),h&&(r=n.map(tg))}let a,c=s[a=hc(e)]||s[a=hc(zt(e))];!c&&i&&(c=s[a=hc(Er(e))]),c&&Mt(c,t,6,r);const u=s[a+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Mt(u,t,6,r)}}function Tg(t,e,n=!1){const s=e.emitsCache,r=s.get(t);if(r!==void 0)return r;const i=t.emits;let o={},a=!1;if(!Z(t)){const c=u=>{const l=Tg(u,e,!0);l&&(a=!0,ft(o,l))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!a?(Ce(t)&&s.set(t,null),null):(X(i)?i.forEach(c=>o[c]=null):ft(o,i),Ce(t)&&s.set(t,o),o)}function va(t,e){return!t||!ga(e)?!1:(e=e.slice(2).replace(/Once$/,""),ce(t,e[0].toLowerCase()+e.slice(1))||ce(t,Er(e))||ce(t,e))}let ut=null,Cg=null;function Vo(t){const e=ut;return ut=t,Cg=t&&t.type.__scopeId||null,e}function Gr(t,e=ut,n){if(!e||t._n)return t;const s=(...r)=>{s._d&&Hh(-1);const i=Vo(e);let o;try{o=t(...r)}finally{Vo(i),s._d&&Hh(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function dc(t){const{type:e,vnode:n,proxy:s,withProxy:r,props:i,propsOptions:[o],slots:a,attrs:c,emit:u,render:l,renderCache:h,data:f,setupState:g,ctx:m,inheritAttrs:v}=t;let S,N;const V=Vo(t);try{if(n.shapeFlag&4){const G=r||s;S=Ut(l.call(G,G,h,i,g,f,m)),N=c}else{const G=e;S=Ut(G.length>1?G(i,{attrs:c,slots:a,emit:u}):G(i,null)),N=e.props?c:FA(c)}}catch(G){ei.length=0,Aa(G,t,1),S=je(er)}let M=S;if(N&&v!==!1){const G=Object.keys(N),{shapeFlag:te}=M;G.length&&te&7&&(o&&G.some(Pu)&&(N=VA(N,o)),M=nr(M,N))}return n.dirs&&(M=nr(M),M.dirs=M.dirs?M.dirs.concat(n.dirs):n.dirs),n.transition&&(M.transition=n.transition),S=M,Vo(V),S}const FA=t=>{let e;for(const n in t)(n==="class"||n==="style"||ga(n))&&((e||(e={}))[n]=t[n]);return e},VA=(t,e)=>{const n={};for(const s in t)(!Pu(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function $A(t,e,n){const{props:s,children:r,component:i}=t,{props:o,children:a,patchFlag:c}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return s?Lh(s,o,u):!!o;if(c&8){const l=e.dynamicProps;for(let h=0;h<l.length;h++){const f=l[h];if(o[f]!==s[f]&&!va(u,f))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?Lh(s,o,u):!0:!!o;return!1}function Lh(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let r=0;r<s.length;r++){const i=s[r];if(e[i]!==t[i]&&!va(n,i))return!0}return!1}function UA({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const qA=t=>t.__isSuspense;function jA(t,e){e&&e.pendingBranch?X(t)?e.effects.push(...t):e.effects.push(t):BA(t)}function xo(t,e){if(We){let n=We.provides;const s=We.parent&&We.parent.provides;s===n&&(n=We.provides=Object.create(s)),n[t]=e}}function en(t,e,n=!1){const s=We||ut;if(s){const r=s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides;if(r&&t in r)return r[t];if(arguments.length>1)return n&&Z(e)?e.call(s.proxy):e}}const ho={};function So(t,e,n){return xg(t,e,n)}function xg(t,e,{immediate:n,deep:s,flush:r,onTrack:i,onTrigger:o}=Ie){const a=We;let c,u=!1,l=!1;if(tt(t)?(c=()=>t.value,u=Fo(t)):zs(t)?(c=()=>t,s=!0):X(t)?(l=!0,u=t.some(M=>zs(M)||Fo(M)),c=()=>t.map(M=>{if(tt(M))return M.value;if(zs(M))return js(M);if(Z(M))return In(M,a,2)})):Z(t)?e?c=()=>In(t,a,2):c=()=>{if(!(a&&a.isUnmounted))return h&&h(),Mt(t,a,3,[f])}:c=Rt,e&&s){const M=c;c=()=>js(M())}let h,f=M=>{h=N.onStop=()=>{In(M,a,4)}},g;if(pi)if(f=Rt,e?n&&Mt(e,a,3,[c(),l?[]:void 0,f]):c(),r==="sync"){const M=$v();g=M.__watcherHandles||(M.__watcherHandles=[])}else return Rt;let m=l?new Array(t.length).fill(ho):ho;const v=()=>{if(N.active)if(e){const M=N.run();(s||u||(l?M.some((G,te)=>li(G,m[te])):li(M,m)))&&(h&&h(),Mt(e,a,3,[M,m===ho?void 0:l&&m[0]===ho?[]:m,f]),m=M)}else N.run()};v.allowRecurse=!!e;let S;r==="sync"?S=v:r==="post"?S=()=>gt(v,a&&a.suspense):(v.pre=!0,a&&(v.id=a.uid),S=()=>zu(v));const N=new Uu(c,S);e?n?v():m=N.run():r==="post"?gt(N.run.bind(N),a&&a.suspense):N.run();const V=()=>{N.stop(),a&&a.scope&&Lu(a.scope.effects,N)};return g&&g.push(V),V}function QA(t,e,n){const s=this.proxy,r=Ve(t)?t.includes(".")?Sg(s,t):()=>s[t]:t.bind(s,s);let i;Z(e)?i=e:(i=e.handler,n=e);const o=We;sr(this);const a=xg(r,i.bind(s),n);return o?sr(o):ls(),a}function Sg(t,e){const n=e.split(".");return()=>{let s=t;for(let r=0;r<n.length&&s;r++)s=s[n[r]];return s}}function js(t,e){if(!Ce(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),tt(t))js(t.value,e);else if(X(t))for(let n=0;n<t.length;n++)js(t[n],e);else if(Jd(t)||Gs(t))t.forEach(n=>{js(n,e)});else if(eg(t))for(const n in t)js(t[n],e);return t}function Li(t){return Z(t)?{setup:t,name:t.name}:t}const Xr=t=>!!t.type.__asyncLoader,Dg=t=>t.type.__isKeepAlive;function HA(t,e){Ng(t,"a",e)}function KA(t,e){Ng(t,"da",e)}function Ng(t,e,n=We){const s=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(Ea(e,s,n),n){let r=n.parent;for(;r&&r.parent;)Dg(r.parent.vnode)&&GA(s,e,n,r),r=r.parent}}function GA(t,e,n,s){const r=Ea(e,t,s,!0);kg(()=>{Lu(s[e],r)},n)}function Ea(t,e,n=We,s=!1){if(n){const r=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;Ir(),sr(n);const a=Mt(e,n,t,o);return ls(),br(),a});return s?r.unshift(i):r.push(i),i}}const on=t=>(e,n=We)=>(!pi||t==="sp")&&Ea(t,(...s)=>e(...s),n),zA=on("bm"),WA=on("m"),YA=on("bu"),JA=on("u"),XA=on("bum"),kg=on("um"),ZA=on("sp"),ev=on("rtg"),tv=on("rtc");function nv(t,e=We){Ea("ec",t,e)}function Hn(t,e,n,s){const r=t.dirs,i=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];i&&(a.oldValue=i[o].value);let c=a.dir[s];c&&(Ir(),Mt(c,n,8,[t.el,a,t,e]),br())}}const Og="components";function sv(t,e){return iv(Og,t,!0,e)||t}const rv=Symbol();function iv(t,e,n=!0,s=!1){const r=ut||We;if(r){const i=r.type;if(t===Og){const a=Lv(i,!1);if(a&&(a===e||a===zt(e)||a===ya(zt(e))))return i}const o=Fh(r[t]||i[t],e)||Fh(r.appContext[t],e);return!o&&s?i:o}}function Fh(t,e){return t&&(t[e]||t[zt(e)]||t[ya(zt(e))])}function fo(t,e,n,s){let r;const i=n&&n[s];if(X(t)||Ve(t)){r=new Array(t.length);for(let o=0,a=t.length;o<a;o++)r[o]=e(t[o],o,void 0,i&&i[o])}else if(typeof t=="number"){r=new Array(t);for(let o=0;o<t;o++)r[o]=e(o+1,o,void 0,i&&i[o])}else if(Ce(t))if(t[Symbol.iterator])r=Array.from(t,(o,a)=>e(o,a,void 0,i&&i[a]));else{const o=Object.keys(t);r=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const u=o[a];r[a]=e(t[u],u,a,i&&i[a])}}else r=[];return n&&(n[s]=r),r}function ov(t,e,n={},s,r){if(ut.isCE||ut.parent&&Xr(ut.parent)&&ut.parent.isCE)return e!=="default"&&(n.name=e),je("slot",n,s&&s());let i=t[e];i&&i._c&&(i._d=!1),vt();const o=i&&Rg(i(n)),a=Qs(ct,{key:n.key||o&&o.key||`_${e}`},o||(s?s():[]),o&&t._===1?64:-2);return!r&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),i&&i._c&&(i._d=!0),a}function Rg(t){return t.some(e=>Uo(e)?!(e.type===er||e.type===ct&&!Rg(e.children)):!0)?t:null}const qc=t=>t?Qg(t)?Xu(t)||t.proxy:qc(t.parent):null,Zr=ft(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>qc(t.parent),$root:t=>qc(t.root),$emit:t=>t.emit,$options:t=>Wu(t),$forceUpdate:t=>t.f||(t.f=()=>zu(t.update)),$nextTick:t=>t.n||(t.n=Eg.bind(t.proxy)),$watch:t=>QA.bind(t)}),gc=(t,e)=>t!==Ie&&!t.__isScriptSetup&&ce(t,e),av={get({_:t},e){const{ctx:n,setupState:s,data:r,props:i,accessCache:o,type:a,appContext:c}=t;let u;if(e[0]!=="$"){const g=o[e];if(g!==void 0)switch(g){case 1:return s[e];case 2:return r[e];case 4:return n[e];case 3:return i[e]}else{if(gc(s,e))return o[e]=1,s[e];if(r!==Ie&&ce(r,e))return o[e]=2,r[e];if((u=t.propsOptions[0])&&ce(u,e))return o[e]=3,i[e];if(n!==Ie&&ce(n,e))return o[e]=4,n[e];jc&&(o[e]=0)}}const l=Zr[e];let h,f;if(l)return e==="$attrs"&&It(t,"get",e),l(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==Ie&&ce(n,e))return o[e]=4,n[e];if(f=c.config.globalProperties,ce(f,e))return f[e]},set({_:t},e,n){const{data:s,setupState:r,ctx:i}=t;return gc(r,e)?(r[e]=n,!0):s!==Ie&&ce(s,e)?(s[e]=n,!0):ce(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:r,propsOptions:i}},o){let a;return!!n[o]||t!==Ie&&ce(t,o)||gc(e,o)||(a=i[0])&&ce(a,o)||ce(s,o)||ce(Zr,o)||ce(r.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:ce(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let jc=!0;function cv(t){const e=Wu(t),n=t.proxy,s=t.ctx;jc=!1,e.beforeCreate&&Vh(e.beforeCreate,t,"bc");const{data:r,computed:i,methods:o,watch:a,provide:c,inject:u,created:l,beforeMount:h,mounted:f,beforeUpdate:g,updated:m,activated:v,deactivated:S,beforeDestroy:N,beforeUnmount:V,destroyed:M,unmounted:G,render:te,renderTracked:re,renderTriggered:Ae,errorCaptured:rt,serverPrefetch:Os,expose:Pt,inheritAttrs:ln,components:Lt,directives:Rs,filters:jn}=e;if(u&&uv(u,s,null,t.appContext.config.unwrapInjectedRef),o)for(const ye in o){const ge=o[ye];Z(ge)&&(s[ye]=ge.bind(n))}if(r){const ye=r.call(n,n);Ce(ye)&&(t.data=_r(ye))}if(jc=!0,i)for(const ye in i){const ge=i[ye],xt=Z(ge)?ge.bind(n,n):Z(ge.get)?ge.get.bind(n,n):Rt,Qn=!Z(ge)&&Z(ge.set)?ge.set.bind(n):Rt,St=Tt({get:xt,set:Qn});Object.defineProperty(s,ye,{enumerable:!0,configurable:!0,get:()=>St.value,set:dt=>St.value=dt})}if(a)for(const ye in a)Mg(a[ye],s,n,ye);if(c){const ye=Z(c)?c.call(n):c;Reflect.ownKeys(ye).forEach(ge=>{xo(ge,ye[ge])})}l&&Vh(l,t,"c");function Be(ye,ge){X(ge)?ge.forEach(xt=>ye(xt.bind(n))):ge&&ye(ge.bind(n))}if(Be(zA,h),Be(WA,f),Be(YA,g),Be(JA,m),Be(HA,v),Be(KA,S),Be(nv,rt),Be(tv,re),Be(ev,Ae),Be(XA,V),Be(kg,G),Be(ZA,Os),X(Pt))if(Pt.length){const ye=t.exposed||(t.exposed={});Pt.forEach(ge=>{Object.defineProperty(ye,ge,{get:()=>n[ge],set:xt=>n[ge]=xt})})}else t.exposed||(t.exposed={});te&&t.render===Rt&&(t.render=te),ln!=null&&(t.inheritAttrs=ln),Lt&&(t.components=Lt),Rs&&(t.directives=Rs)}function uv(t,e,n=Rt,s=!1){X(t)&&(t=Qc(t));for(const r in t){const i=t[r];let o;Ce(i)?"default"in i?o=en(i.from||r,i.default,!0):o=en(i.from||r):o=en(i),tt(o)&&s?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[r]=o}}function Vh(t,e,n){Mt(X(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function Mg(t,e,n,s){const r=s.includes(".")?Sg(n,s):()=>n[s];if(Ve(t)){const i=e[t];Z(i)&&So(r,i)}else if(Z(t))So(r,t.bind(n));else if(Ce(t))if(X(t))t.forEach(i=>Mg(i,e,n,s));else{const i=Z(t.handler)?t.handler.bind(n):e[t.handler];Z(i)&&So(r,i,t)}}function Wu(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let c;return a?c=a:!r.length&&!n&&!s?c=e:(c={},r.length&&r.forEach(u=>$o(c,u,o,!0)),$o(c,e,o)),Ce(e)&&i.set(e,c),c}function $o(t,e,n,s=!1){const{mixins:r,extends:i}=e;i&&$o(t,i,n,!0),r&&r.forEach(o=>$o(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const a=lv[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const lv={data:$h,props:zn,emits:zn,methods:zn,computed:zn,beforeCreate:it,created:it,beforeMount:it,mounted:it,beforeUpdate:it,updated:it,beforeDestroy:it,beforeUnmount:it,destroyed:it,unmounted:it,activated:it,deactivated:it,errorCaptured:it,serverPrefetch:it,components:zn,directives:zn,watch:fv,provide:$h,inject:hv};function $h(t,e){return e?t?function(){return ft(Z(t)?t.call(this,this):t,Z(e)?e.call(this,this):e)}:e:t}function hv(t,e){return zn(Qc(t),Qc(e))}function Qc(t){if(X(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function it(t,e){return t?[...new Set([].concat(t,e))]:e}function zn(t,e){return t?ft(ft(Object.create(null),t),e):e}function fv(t,e){if(!t)return e;if(!e)return t;const n=ft(Object.create(null),t);for(const s in e)n[s]=it(t[s],e[s]);return n}function dv(t,e,n,s=!1){const r={},i={};Lo(i,ba,1),t.propsDefaults=Object.create(null),Bg(t,e,r,i);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=s?r:TA(r):t.type.props?t.props=r:t.props=i,t.attrs=i}function gv(t,e,n,s){const{props:r,attrs:i,vnode:{patchFlag:o}}=t,a=he(r),[c]=t.propsOptions;let u=!1;if((s||o>0)&&!(o&16)){if(o&8){const l=t.vnode.dynamicProps;for(let h=0;h<l.length;h++){let f=l[h];if(va(t.emitsOptions,f))continue;const g=e[f];if(c)if(ce(i,f))g!==i[f]&&(i[f]=g,u=!0);else{const m=zt(f);r[m]=Hc(c,a,m,g,t,!1)}else g!==i[f]&&(i[f]=g,u=!0)}}}else{Bg(t,e,r,i)&&(u=!0);let l;for(const h in a)(!e||!ce(e,h)&&((l=Er(h))===h||!ce(e,l)))&&(c?n&&(n[h]!==void 0||n[l]!==void 0)&&(r[h]=Hc(c,a,h,void 0,t,!0)):delete r[h]);if(i!==a)for(const h in i)(!e||!ce(e,h))&&(delete i[h],u=!0)}u&&nn(t,"set","$attrs")}function Bg(t,e,n,s){const[r,i]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(Co(c))continue;const u=e[c];let l;r&&ce(r,l=zt(c))?!i||!i.includes(l)?n[l]=u:(a||(a={}))[l]=u:va(t.emitsOptions,c)||(!(c in s)||u!==s[c])&&(s[c]=u,o=!0)}if(i){const c=he(n),u=a||Ie;for(let l=0;l<i.length;l++){const h=i[l];n[h]=Hc(r,c,h,u[h],t,!ce(u,h))}}return o}function Hc(t,e,n,s,r,i){const o=t[n];if(o!=null){const a=ce(o,"default");if(a&&s===void 0){const c=o.default;if(o.type!==Function&&Z(c)){const{propsDefaults:u}=r;n in u?s=u[n]:(sr(r),s=u[n]=c.call(null,e),ls())}else s=c}o[0]&&(i&&!a?s=!1:o[1]&&(s===""||s===Er(n))&&(s=!0))}return s}function Pg(t,e,n=!1){const s=e.propsCache,r=s.get(t);if(r)return r;const i=t.props,o={},a=[];let c=!1;if(!Z(t)){const l=h=>{c=!0;const[f,g]=Pg(h,e,!0);ft(o,f),g&&a.push(...g)};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}if(!i&&!c)return Ce(t)&&s.set(t,Ks),Ks;if(X(i))for(let l=0;l<i.length;l++){const h=zt(i[l]);Uh(h)&&(o[h]=Ie)}else if(i)for(const l in i){const h=zt(l);if(Uh(h)){const f=i[l],g=o[h]=X(f)||Z(f)?{type:f}:Object.assign({},f);if(g){const m=Qh(Boolean,g.type),v=Qh(String,g.type);g[0]=m>-1,g[1]=v<0||m<v,(m>-1||ce(g,"default"))&&a.push(h)}}}const u=[o,a];return Ce(t)&&s.set(t,u),u}function Uh(t){return t[0]!=="$"}function qh(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function jh(t,e){return qh(t)===qh(e)}function Qh(t,e){return X(e)?e.findIndex(n=>jh(n,t)):Z(e)&&jh(e,t)?0:-1}const Lg=t=>t[0]==="_"||t==="$stable",Yu=t=>X(t)?t.map(Ut):[Ut(t)],pv=(t,e,n)=>{if(e._n)return e;const s=Gr((...r)=>Yu(e(...r)),n);return s._c=!1,s},Fg=(t,e,n)=>{const s=t._ctx;for(const r in t){if(Lg(r))continue;const i=t[r];if(Z(i))e[r]=pv(r,i,s);else if(i!=null){const o=Yu(i);e[r]=()=>o}}},Vg=(t,e)=>{const n=Yu(e);t.slots.default=()=>n},mv=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=he(e),Lo(e,"_",n)):Fg(e,t.slots={})}else t.slots={},e&&Vg(t,e);Lo(t.slots,ba,1)},yv=(t,e,n)=>{const{vnode:s,slots:r}=t;let i=!0,o=Ie;if(s.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:(ft(r,e),!n&&a===1&&delete r._):(i=!e.$stable,Fg(e,r)),o=e}else e&&(Vg(t,e),o={default:1});if(i)for(const a in r)!Lg(a)&&!(a in o)&&delete r[a]};function $g(){return{app:null,config:{isNativeTag:Hw,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let wv=0;function Av(t,e){return function(s,r=null){Z(s)||(s=Object.assign({},s)),r!=null&&!Ce(r)&&(r=null);const i=$g(),o=new Set;let a=!1;const c=i.app={_uid:wv++,_component:s,_props:r,_container:null,_context:i,_instance:null,version:Uv,get config(){return i.config},set config(u){},use(u,...l){return o.has(u)||(u&&Z(u.install)?(o.add(u),u.install(c,...l)):Z(u)&&(o.add(u),u(c,...l))),c},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),c},component(u,l){return l?(i.components[u]=l,c):i.components[u]},directive(u,l){return l?(i.directives[u]=l,c):i.directives[u]},mount(u,l,h){if(!a){const f=je(s,r);return f.appContext=i,l&&e?e(f,u):t(f,u,h),a=!0,c._container=u,u.__vue_app__=c,Xu(f.component)||f.component.proxy}},unmount(){a&&(t(null,c._container),delete c._container.__vue_app__)},provide(u,l){return i.provides[u]=l,c}};return c}}function Kc(t,e,n,s,r=!1){if(X(t)){t.forEach((f,g)=>Kc(f,e&&(X(e)?e[g]:e),n,s,r));return}if(Xr(s)&&!r)return;const i=s.shapeFlag&4?Xu(s.component)||s.component.proxy:s.el,o=r?null:i,{i:a,r:c}=t,u=e&&e.r,l=a.refs===Ie?a.refs={}:a.refs,h=a.setupState;if(u!=null&&u!==c&&(Ve(u)?(l[u]=null,ce(h,u)&&(h[u]=null)):tt(u)&&(u.value=null)),Z(c))In(c,a,12,[o,l]);else{const f=Ve(c),g=tt(c);if(f||g){const m=()=>{if(t.f){const v=f?ce(h,c)?h[c]:l[c]:c.value;r?X(v)&&Lu(v,i):X(v)?v.includes(i)||v.push(i):f?(l[c]=[i],ce(h,c)&&(h[c]=l[c])):(c.value=[i],t.k&&(l[t.k]=c.value))}else f?(l[c]=o,ce(h,c)&&(h[c]=o)):g&&(c.value=o,t.k&&(l[t.k]=o))};o?(m.id=-1,gt(m,n)):m()}}}const gt=jA;function vv(t){return Ev(t)}function Ev(t,e){const n=Jw();n.__VUE__=!0;const{insert:s,remove:r,patchProp:i,createElement:o,createText:a,createComment:c,setText:u,setElementText:l,parentNode:h,nextSibling:f,setScopeId:g=Rt,insertStaticContent:m}=t,v=(d,p,A,E=null,_=null,D=null,P=!1,x=null,O=!!p.dynamicChildren)=>{if(d===p)return;d&&!Lr(d,p)&&(E=B(d),dt(d,_,D,!0),d=null),p.patchFlag===-2&&(O=!1,p.dynamicChildren=null);const{type:C,ref:H,shapeFlag:$}=p;switch(C){case Ia:S(d,p,A,E);break;case er:N(d,p,A,E);break;case Do:d==null&&V(p,A,E,P);break;case ct:Lt(d,p,A,E,_,D,P,x,O);break;default:$&1?te(d,p,A,E,_,D,P,x,O):$&6?Rs(d,p,A,E,_,D,P,x,O):($&64||$&128)&&C.process(d,p,A,E,_,D,P,x,O,ae)}H!=null&&_&&Kc(H,d&&d.ref,D,p||d,!p)},S=(d,p,A,E)=>{if(d==null)s(p.el=a(p.children),A,E);else{const _=p.el=d.el;p.children!==d.children&&u(_,p.children)}},N=(d,p,A,E)=>{d==null?s(p.el=c(p.children||""),A,E):p.el=d.el},V=(d,p,A,E)=>{[d.el,d.anchor]=m(d.children,p,A,E,d.el,d.anchor)},M=({el:d,anchor:p},A,E)=>{let _;for(;d&&d!==p;)_=f(d),s(d,A,E),d=_;s(p,A,E)},G=({el:d,anchor:p})=>{let A;for(;d&&d!==p;)A=f(d),r(d),d=A;r(p)},te=(d,p,A,E,_,D,P,x,O)=>{P=P||p.type==="svg",d==null?re(p,A,E,_,D,P,x,O):Os(d,p,_,D,P,x,O)},re=(d,p,A,E,_,D,P,x)=>{let O,C;const{type:H,props:$,shapeFlag:K,transition:W,dirs:ne}=d;if(O=d.el=o(d.type,D,$&&$.is,$),K&8?l(O,d.children):K&16&&rt(d.children,O,null,E,_,D&&H!=="foreignObject",P,x),ne&&Hn(d,null,E,"created"),$){for(const pe in $)pe!=="value"&&!Co(pe)&&i(O,pe,null,$[pe],D,d.children,E,_,F);"value"in $&&i(O,"value",null,$.value),(C=$.onVnodeBeforeMount)&&Vt(C,E,d)}Ae(O,d,d.scopeId,P,E),ne&&Hn(d,null,E,"beforeMount");const we=(!_||_&&!_.pendingBranch)&&W&&!W.persisted;we&&W.beforeEnter(O),s(O,p,A),((C=$&&$.onVnodeMounted)||we||ne)&&gt(()=>{C&&Vt(C,E,d),we&&W.enter(O),ne&&Hn(d,null,E,"mounted")},_)},Ae=(d,p,A,E,_)=>{if(A&&g(d,A),E)for(let D=0;D<E.length;D++)g(d,E[D]);if(_){let D=_.subTree;if(p===D){const P=_.vnode;Ae(d,P,P.scopeId,P.slotScopeIds,_.parent)}}},rt=(d,p,A,E,_,D,P,x,O=0)=>{for(let C=O;C<d.length;C++){const H=d[C]=x?mn(d[C]):Ut(d[C]);v(null,H,p,A,E,_,D,P,x)}},Os=(d,p,A,E,_,D,P)=>{const x=p.el=d.el;let{patchFlag:O,dynamicChildren:C,dirs:H}=p;O|=d.patchFlag&16;const $=d.props||Ie,K=p.props||Ie;let W;A&&Kn(A,!1),(W=K.onVnodeBeforeUpdate)&&Vt(W,A,p,d),H&&Hn(p,d,A,"beforeUpdate"),A&&Kn(A,!0);const ne=_&&p.type!=="foreignObject";if(C?Pt(d.dynamicChildren,C,x,A,E,ne,D):P||ge(d,p,x,null,A,E,ne,D,!1),O>0){if(O&16)ln(x,p,$,K,A,E,_);else if(O&2&&$.class!==K.class&&i(x,"class",null,K.class,_),O&4&&i(x,"style",$.style,K.style,_),O&8){const we=p.dynamicProps;for(let pe=0;pe<we.length;pe++){const Pe=we[pe],Dt=$[Pe],Bs=K[Pe];(Bs!==Dt||Pe==="value")&&i(x,Pe,Dt,Bs,_,d.children,A,E,F)}}O&1&&d.children!==p.children&&l(x,p.children)}else!P&&C==null&&ln(x,p,$,K,A,E,_);((W=K.onVnodeUpdated)||H)&&gt(()=>{W&&Vt(W,A,p,d),H&&Hn(p,d,A,"updated")},E)},Pt=(d,p,A,E,_,D,P)=>{for(let x=0;x<p.length;x++){const O=d[x],C=p[x],H=O.el&&(O.type===ct||!Lr(O,C)||O.shapeFlag&70)?h(O.el):A;v(O,C,H,null,E,_,D,P,!0)}},ln=(d,p,A,E,_,D,P)=>{if(A!==E){if(A!==Ie)for(const x in A)!Co(x)&&!(x in E)&&i(d,x,A[x],null,P,p.children,_,D,F);for(const x in E){if(Co(x))continue;const O=E[x],C=A[x];O!==C&&x!=="value"&&i(d,x,C,O,P,p.children,_,D,F)}"value"in E&&i(d,"value",A.value,E.value)}},Lt=(d,p,A,E,_,D,P,x,O)=>{const C=p.el=d?d.el:a(""),H=p.anchor=d?d.anchor:a("");let{patchFlag:$,dynamicChildren:K,slotScopeIds:W}=p;W&&(x=x?x.concat(W):W),d==null?(s(C,A,E),s(H,A,E),rt(p.children,A,H,_,D,P,x,O)):$>0&&$&64&&K&&d.dynamicChildren?(Pt(d.dynamicChildren,K,A,_,D,P,x),(p.key!=null||_&&p===_.subTree)&&Ug(d,p,!0)):ge(d,p,A,H,_,D,P,x,O)},Rs=(d,p,A,E,_,D,P,x,O)=>{p.slotScopeIds=x,d==null?p.shapeFlag&512?_.ctx.activate(p,A,E,P,O):jn(p,A,E,_,D,P,O):Br(d,p,O)},jn=(d,p,A,E,_,D,P)=>{const x=d.component=Ov(d,E,_);if(Dg(d)&&(x.ctx.renderer=ae),Rv(x),x.asyncDep){if(_&&_.registerDep(x,Be),!d.el){const O=x.subTree=je(er);N(null,O,p,A)}return}Be(x,d,p,A,_,D,P)},Br=(d,p,A)=>{const E=p.component=d.component;if($A(d,p,A))if(E.asyncDep&&!E.asyncResolved){ye(E,p,A);return}else E.next=p,MA(E.update),E.update();else p.el=d.el,E.vnode=p},Be=(d,p,A,E,_,D,P)=>{const x=()=>{if(d.isMounted){let{next:H,bu:$,u:K,parent:W,vnode:ne}=d,we=H,pe;Kn(d,!1),H?(H.el=ne.el,ye(d,H,P)):H=ne,$&&fc($),(pe=H.props&&H.props.onVnodeBeforeUpdate)&&Vt(pe,W,H,ne),Kn(d,!0);const Pe=dc(d),Dt=d.subTree;d.subTree=Pe,v(Dt,Pe,h(Dt.el),B(Dt),d,_,D),H.el=Pe.el,we===null&&UA(d,Pe.el),K&&gt(K,_),(pe=H.props&&H.props.onVnodeUpdated)&&gt(()=>Vt(pe,W,H,ne),_)}else{let H;const{el:$,props:K}=p,{bm:W,m:ne,parent:we}=d,pe=Xr(p);if(Kn(d,!1),W&&fc(W),!pe&&(H=K&&K.onVnodeBeforeMount)&&Vt(H,we,p),Kn(d,!0),$&&ee){const Pe=()=>{d.subTree=dc(d),ee($,d.subTree,d,_,null)};pe?p.type.__asyncLoader().then(()=>!d.isUnmounted&&Pe()):Pe()}else{const Pe=d.subTree=dc(d);v(null,Pe,A,E,d,_,D),p.el=Pe.el}if(ne&&gt(ne,_),!pe&&(H=K&&K.onVnodeMounted)){const Pe=p;gt(()=>Vt(H,we,Pe),_)}(p.shapeFlag&256||we&&Xr(we.vnode)&&we.vnode.shapeFlag&256)&&d.a&&gt(d.a,_),d.isMounted=!0,p=A=E=null}},O=d.effect=new Uu(x,()=>zu(C),d.scope),C=d.update=()=>O.run();C.id=d.uid,Kn(d,!0),C()},ye=(d,p,A)=>{p.component=d;const E=d.vnode.props;d.vnode=p,d.next=null,gv(d,p.props,E,A),yv(d,p.children,A),Ir(),Ph(),br()},ge=(d,p,A,E,_,D,P,x,O=!1)=>{const C=d&&d.children,H=d?d.shapeFlag:0,$=p.children,{patchFlag:K,shapeFlag:W}=p;if(K>0){if(K&128){Qn(C,$,A,E,_,D,P,x,O);return}else if(K&256){xt(C,$,A,E,_,D,P,x,O);return}}W&8?(H&16&&F(C,_,D),$!==C&&l(A,$)):H&16?W&16?Qn(C,$,A,E,_,D,P,x,O):F(C,_,D,!0):(H&8&&l(A,""),W&16&&rt($,A,E,_,D,P,x,O))},xt=(d,p,A,E,_,D,P,x,O)=>{d=d||Ks,p=p||Ks;const C=d.length,H=p.length,$=Math.min(C,H);let K;for(K=0;K<$;K++){const W=p[K]=O?mn(p[K]):Ut(p[K]);v(d[K],W,A,null,_,D,P,x,O)}C>H?F(d,_,D,!0,!1,$):rt(p,A,E,_,D,P,x,O,$)},Qn=(d,p,A,E,_,D,P,x,O)=>{let C=0;const H=p.length;let $=d.length-1,K=H-1;for(;C<=$&&C<=K;){const W=d[C],ne=p[C]=O?mn(p[C]):Ut(p[C]);if(Lr(W,ne))v(W,ne,A,null,_,D,P,x,O);else break;C++}for(;C<=$&&C<=K;){const W=d[$],ne=p[K]=O?mn(p[K]):Ut(p[K]);if(Lr(W,ne))v(W,ne,A,null,_,D,P,x,O);else break;$--,K--}if(C>$){if(C<=K){const W=K+1,ne=W<H?p[W].el:E;for(;C<=K;)v(null,p[C]=O?mn(p[C]):Ut(p[C]),A,ne,_,D,P,x,O),C++}}else if(C>K)for(;C<=$;)dt(d[C],_,D,!0),C++;else{const W=C,ne=C,we=new Map;for(C=ne;C<=K;C++){const At=p[C]=O?mn(p[C]):Ut(p[C]);At.key!=null&&we.set(At.key,C)}let pe,Pe=0;const Dt=K-ne+1;let Bs=!1,Th=0;const Pr=new Array(Dt);for(C=0;C<Dt;C++)Pr[C]=0;for(C=W;C<=$;C++){const At=d[C];if(Pe>=Dt){dt(At,_,D,!0);continue}let Ft;if(At.key!=null)Ft=we.get(At.key);else for(pe=ne;pe<=K;pe++)if(Pr[pe-ne]===0&&Lr(At,p[pe])){Ft=pe;break}Ft===void 0?dt(At,_,D,!0):(Pr[Ft-ne]=C+1,Ft>=Th?Th=Ft:Bs=!0,v(At,p[Ft],A,null,_,D,P,x,O),Pe++)}const Ch=Bs?Iv(Pr):Ks;for(pe=Ch.length-1,C=Dt-1;C>=0;C--){const At=ne+C,Ft=p[At],xh=At+1<H?p[At+1].el:E;Pr[C]===0?v(null,Ft,A,xh,_,D,P,x,O):Bs&&(pe<0||C!==Ch[pe]?St(Ft,A,xh,2):pe--)}}},St=(d,p,A,E,_=null)=>{const{el:D,type:P,transition:x,children:O,shapeFlag:C}=d;if(C&6){St(d.component.subTree,p,A,E);return}if(C&128){d.suspense.move(p,A,E);return}if(C&64){P.move(d,p,A,ae);return}if(P===ct){s(D,p,A);for(let $=0;$<O.length;$++)St(O[$],p,A,E);s(d.anchor,p,A);return}if(P===Do){M(d,p,A);return}if(E!==2&&C&1&&x)if(E===0)x.beforeEnter(D),s(D,p,A),gt(()=>x.enter(D),_);else{const{leave:$,delayLeave:K,afterLeave:W}=x,ne=()=>s(D,p,A),we=()=>{$(D,()=>{ne(),W&&W()})};K?K(D,ne,we):we()}else s(D,p,A)},dt=(d,p,A,E=!1,_=!1)=>{const{type:D,props:P,ref:x,children:O,dynamicChildren:C,shapeFlag:H,patchFlag:$,dirs:K}=d;if(x!=null&&Kc(x,null,A,d,!0),H&256){p.ctx.deactivate(d);return}const W=H&1&&K,ne=!Xr(d);let we;if(ne&&(we=P&&P.onVnodeBeforeUnmount)&&Vt(we,p,d),H&6)I(d.component,A,E);else{if(H&128){d.suspense.unmount(A,E);return}W&&Hn(d,null,p,"beforeUnmount"),H&64?d.type.remove(d,p,A,_,ae,E):C&&(D!==ct||$>0&&$&64)?F(C,p,A,!1,!0):(D===ct&&$&384||!_&&H&16)&&F(O,p,A),E&&Ms(d)}(ne&&(we=P&&P.onVnodeUnmounted)||W)&&gt(()=>{we&&Vt(we,p,d),W&&Hn(d,null,p,"unmounted")},A)},Ms=d=>{const{type:p,el:A,anchor:E,transition:_}=d;if(p===ct){io(A,E);return}if(p===Do){G(d);return}const D=()=>{r(A),_&&!_.persisted&&_.afterLeave&&_.afterLeave()};if(d.shapeFlag&1&&_&&!_.persisted){const{leave:P,delayLeave:x}=_,O=()=>P(A,D);x?x(d.el,D,O):O()}else D()},io=(d,p)=>{let A;for(;d!==p;)A=f(d),r(d),d=A;r(p)},I=(d,p,A)=>{const{bum:E,scope:_,update:D,subTree:P,um:x}=d;E&&fc(E),_.stop(),D&&(D.active=!1,dt(P,d,p,A)),x&&gt(x,p),gt(()=>{d.isUnmounted=!0},p),p&&p.pendingBranch&&!p.isUnmounted&&d.asyncDep&&!d.asyncResolved&&d.suspenseId===p.pendingId&&(p.deps--,p.deps===0&&p.resolve())},F=(d,p,A,E=!1,_=!1,D=0)=>{for(let P=D;P<d.length;P++)dt(d[P],p,A,E,_)},B=d=>d.shapeFlag&6?B(d.component.subTree):d.shapeFlag&128?d.suspense.next():f(d.anchor||d.el),Q=(d,p,A)=>{d==null?p._vnode&&dt(p._vnode,null,null,!0):v(p._vnode||null,d,p,null,null,null,A),Ph(),bg(),p._vnode=d},ae={p:v,um:dt,m:St,r:Ms,mt:jn,mc:rt,pc:ge,pbc:Pt,n:B,o:t};let xe,ee;return e&&([xe,ee]=e(ae)),{render:Q,hydrate:xe,createApp:Av(Q,xe)}}function Kn({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function Ug(t,e,n=!1){const s=t.children,r=e.children;if(X(s)&&X(r))for(let i=0;i<s.length;i++){const o=s[i];let a=r[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[i]=mn(r[i]),a.el=o.el),n||Ug(o,a)),a.type===Ia&&(a.el=o.el)}}function Iv(t){const e=t.slice(),n=[0];let s,r,i,o,a;const c=t.length;for(s=0;s<c;s++){const u=t[s];if(u!==0){if(r=n[n.length-1],t[r]<u){e[s]=r,n.push(s);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<u?i=a+1:o=a;u<t[n[i]]&&(i>0&&(e[s]=n[i-1]),n[i]=s)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}const bv=t=>t.__isTeleport,ct=Symbol(void 0),Ia=Symbol(void 0),er=Symbol(void 0),Do=Symbol(void 0),ei=[];let kt=null;function vt(t=!1){ei.push(kt=t?null:[])}function _v(){ei.pop(),kt=ei[ei.length-1]||null}let gi=1;function Hh(t){gi+=t}function qg(t){return t.dynamicChildren=gi>0?kt||Ks:null,_v(),gi>0&&kt&&kt.push(t),t}function Xn(t,e,n,s,r,i){return qg(tr(t,e,n,s,r,i,!0))}function Qs(t,e,n,s,r){return qg(je(t,e,n,s,r,!0))}function Uo(t){return t?t.__v_isVNode===!0:!1}function Lr(t,e){return t.type===e.type&&t.key===e.key}const ba="__vInternal",jg=({key:t})=>t??null,No=({ref:t,ref_key:e,ref_for:n})=>t!=null?Ve(t)||tt(t)||Z(t)?{i:ut,r:t,k:e,f:!!n}:t:null;function tr(t,e=null,n=null,s=0,r=null,i=t===ct?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&jg(e),ref:e&&No(e),scopeId:Cg,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:ut};return a?(Ju(c,n),i&128&&t.normalize(c)):n&&(c.shapeFlag|=Ve(n)?8:16),gi>0&&!o&&kt&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&kt.push(c),c}const je=Tv;function Tv(t,e=null,n=null,s=0,r=null,i=!1){if((!t||t===rv)&&(t=er),Uo(t)){const a=nr(t,e,!0);return n&&Ju(a,n),gi>0&&!i&&kt&&(a.shapeFlag&6?kt[kt.indexOf(t)]=a:kt.push(a)),a.patchFlag|=-2,a}if(Fv(t)&&(t=t.__vccOpts),e){e=Cv(e);let{class:a,style:c}=e;a&&!Ve(a)&&(e.class=da(a)),Ce(c)&&(dg(c)&&!X(c)&&(c=ft({},c)),e.style=Bu(c))}const o=Ve(t)?1:qA(t)?128:bv(t)?64:Ce(t)?4:Z(t)?2:0;return tr(t,e,n,s,r,o,i,!0)}function Cv(t){return t?dg(t)||ba in t?ft({},t):t:null}function nr(t,e,n=!1){const{props:s,ref:r,patchFlag:i,children:o}=t,a=e?Dv(s||{},e):s;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&jg(a),ref:e&&e.ref?n&&r?X(r)?r.concat(No(e)):[r,No(e)]:No(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==ct?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&nr(t.ssContent),ssFallback:t.ssFallback&&nr(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx}}function xv(t=" ",e=0){return je(Ia,null,t,e)}function Sv(t,e){const n=je(Do,null,t);return n.staticCount=e,n}function Ut(t){return t==null||typeof t=="boolean"?je(er):X(t)?je(ct,null,t.slice()):typeof t=="object"?mn(t):je(Ia,null,String(t))}function mn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:nr(t)}function Ju(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(X(e))n=16;else if(typeof e=="object")if(s&65){const r=e.default;r&&(r._c&&(r._d=!1),Ju(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!(ba in e)?e._ctx=ut:r===3&&ut&&(ut.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Z(e)?(e={default:e,_ctx:ut},n=32):(e=String(e),s&64?(n=16,e=[xv(e)]):n=8);t.children=e,t.shapeFlag|=n}function Dv(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const r in s)if(r==="class")e.class!==s.class&&(e.class=da([e.class,s.class]));else if(r==="style")e.style=Bu([e.style,s.style]);else if(ga(r)){const i=e[r],o=s[r];o&&i!==o&&!(X(i)&&i.includes(o))&&(e[r]=i?[].concat(i,o):o)}else r!==""&&(e[r]=s[r])}return e}function Vt(t,e,n,s=null){Mt(t,e,7,[n,s])}const Nv=$g();let kv=0;function Ov(t,e,n){const s=t.type,r=(e?e.appContext:t.appContext)||Nv,i={uid:kv++,vnode:t,type:s,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new Xw(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Pg(s,r),emitsOptions:Tg(s,r),emit:null,emitted:null,propsDefaults:Ie,inheritAttrs:s.inheritAttrs,ctx:Ie,data:Ie,props:Ie,attrs:Ie,slots:Ie,refs:Ie,setupState:Ie,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=LA.bind(null,i),t.ce&&t.ce(i),i}let We=null;const sr=t=>{We=t,t.scope.on()},ls=()=>{We&&We.scope.off(),We=null};function Qg(t){return t.vnode.shapeFlag&4}let pi=!1;function Rv(t,e=!1){pi=e;const{props:n,children:s}=t.vnode,r=Qg(t);dv(t,n,r,e),mv(t,s);const i=r?Mv(t,e):void 0;return pi=!1,i}function Mv(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=gg(new Proxy(t.ctx,av));const{setup:s}=n;if(s){const r=t.setupContext=s.length>1?Pv(t):null;sr(t),Ir();const i=In(s,t,0,[t.props,r]);if(br(),ls(),Xd(i)){if(i.then(ls,ls),e)return i.then(o=>{Kh(t,o,e)}).catch(o=>{Aa(o,t,0)});t.asyncDep=i}else Kh(t,i,e)}else Hg(t,e)}function Kh(t,e,n){Z(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Ce(e)&&(t.setupState=wg(e)),Hg(t,n)}let Gh;function Hg(t,e,n){const s=t.type;if(!t.render){if(!e&&Gh&&!s.render){const r=s.template||Wu(t).template;if(r){const{isCustomElement:i,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:c}=s,u=ft(ft({isCustomElement:i,delimiters:a},o),c);s.render=Gh(r,u)}}t.render=s.render||Rt}sr(t),Ir(),cv(t),br(),ls()}function Bv(t){return new Proxy(t.attrs,{get(e,n){return It(t,"get","$attrs"),e[n]}})}function Pv(t){const e=s=>{t.exposed=s||{}};let n;return{get attrs(){return n||(n=Bv(t))},slots:t.slots,emit:t.emit,expose:e}}function Xu(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(wg(gg(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Zr)return Zr[n](t)},has(e,n){return n in e||n in Zr}}))}function Lv(t,e=!0){return Z(t)?t.displayName||t.name:t.name||e&&t.__name}function Fv(t){return Z(t)&&"__vccOpts"in t}const Tt=(t,e)=>kA(t,e,pi);function Kg(t,e,n){const s=arguments.length;return s===2?Ce(e)&&!X(e)?Uo(e)?je(t,null,[e]):je(t,e):je(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&Uo(n)&&(n=[n]),je(t,e,n))}const Vv=Symbol(""),$v=()=>en(Vv),Uv="3.2.45",qv="http://www.w3.org/2000/svg",Zn=typeof document<"u"?document:null,zh=Zn&&Zn.createElement("template"),jv={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const r=e?Zn.createElementNS(qv,t):Zn.createElement(t,n?{is:n}:void 0);return t==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:t=>Zn.createTextNode(t),createComment:t=>Zn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Zn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,s,r,i){const o=n?n.previousSibling:e.lastChild;if(r&&(r===i||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===i||!(r=r.nextSibling)););else{zh.innerHTML=s?`<svg>${t}</svg>`:t;const a=zh.content;if(s){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function Qv(t,e,n){const s=t._vtc;s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function Hv(t,e,n){const s=t.style,r=Ve(n);if(n&&!r){for(const i in n)Gc(s,i,n[i]);if(e&&!Ve(e))for(const i in e)n[i]==null&&Gc(s,i,"")}else{const i=s.display;r?e!==n&&(s.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(s.display=i)}}const Wh=/\s*!important$/;function Gc(t,e,n){if(X(n))n.forEach(s=>Gc(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=Kv(t,e);Wh.test(n)?t.setProperty(Er(s),n.replace(Wh,""),"important"):t[s]=n}}const Yh=["Webkit","Moz","ms"],pc={};function Kv(t,e){const n=pc[e];if(n)return n;let s=zt(e);if(s!=="filter"&&s in t)return pc[e]=s;s=ya(s);for(let r=0;r<Yh.length;r++){const i=Yh[r]+s;if(i in t)return pc[e]=i}return e}const Jh="http://www.w3.org/1999/xlink";function Gv(t,e,n,s,r){if(s&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(Jh,e.slice(6,e.length)):t.setAttributeNS(Jh,e,n);else{const i=jw(e);n==null||i&&!Wd(n)?t.removeAttribute(e):t.setAttribute(e,i?"":n)}}function zv(t,e,n,s,r,i,o){if(e==="innerHTML"||e==="textContent"){s&&o(s,r,i),t[e]=n??"";return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const c=n??"";(t.value!==c||t.tagName==="OPTION")&&(t.value=c),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const c=typeof t[e];c==="boolean"?n=Wd(n):n==null&&c==="string"?(n="",a=!0):c==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}function Wv(t,e,n,s){t.addEventListener(e,n,s)}function Yv(t,e,n,s){t.removeEventListener(e,n,s)}function Jv(t,e,n,s,r=null){const i=t._vei||(t._vei={}),o=i[e];if(s&&o)o.value=s;else{const[a,c]=Xv(e);if(s){const u=i[e]=tE(s,r);Wv(t,a,u,c)}else o&&(Yv(t,a,o,c),i[e]=void 0)}}const Xh=/(?:Once|Passive|Capture)$/;function Xv(t){let e;if(Xh.test(t)){e={};let s;for(;s=t.match(Xh);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Er(t.slice(2)),e]}let mc=0;const Zv=Promise.resolve(),eE=()=>mc||(Zv.then(()=>mc=0),mc=Date.now());function tE(t,e){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;Mt(nE(s,n.value),e,5,[s])};return n.value=t,n.attached=eE(),n}function nE(t,e){if(X(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>r=>!r._stopped&&s&&s(r))}else return e}const Zh=/^on[a-z]/,sE=(t,e,n,s,r=!1,i,o,a,c)=>{e==="class"?Qv(t,s,r):e==="style"?Hv(t,n,s):ga(e)?Pu(e)||Jv(t,e,n,s,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):rE(t,e,s,r))?zv(t,e,s,i,o,a,c):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),Gv(t,e,s,r))};function rE(t,e,n,s){return s?!!(e==="innerHTML"||e==="textContent"||e in t&&Zh.test(e)&&Z(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||Zh.test(e)&&Ve(n)?!1:e in t}const iE=ft({patchProp:sE},jv);let ef;function oE(){return ef||(ef=vv(iE))}const aE=(...t)=>{const e=oE().createApp(...t),{mount:n}=e;return e.mount=s=>{const r=cE(s);if(!r)return;const i=e._component;!Z(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.innerHTML="";const o=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function cE(t){return Ve(t)?document.querySelector(t):t}const _a=(t,e)=>{const n=t.__vccOpts||t;for(const[s,r]of e)n[s]=r;return n},uE={};function lE(t,e){const n=sv("RouterView");return vt(),Qs(n)}const hE=_a(uE,[["render",lE]]),fE="modulepreload",dE=function(t){return"/rock-portal/"+t},tf={},gE=function(e,n,s){if(!n||n.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=dE(i),i in tf)return;tf[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!s)for(let l=r.length-1;l>=0;l--){const h=r[l];if(h.href===i&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":fE,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((l,h)=>{u.addEventListener("load",l),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e())};/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Vs=typeof window<"u";function pE(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const fe=Object.assign;function yc(t,e){const n={};for(const s in e){const r=e[s];n[s]=Bt(r)?r.map(t):t(r)}return n}const ti=()=>{},Bt=Array.isArray,mE=/\/$/,yE=t=>t.replace(mE,"");function wc(t,e,n="/"){let s,r={},i="",o="";const a=e.indexOf("#");let c=e.indexOf("?");return a<c&&a>=0&&(c=-1),c>-1&&(s=e.slice(0,c),i=e.slice(c+1,a>-1?a:e.length),r=t(i)),a>-1&&(s=s||e.slice(0,a),o=e.slice(a,e.length)),s=EE(s??e,n),{fullPath:s+(i&&"?")+i+o,path:s,query:r,hash:o}}function wE(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function nf(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function AE(t,e,n){const s=e.matched.length-1,r=n.matched.length-1;return s>-1&&s===r&&rr(e.matched[s],n.matched[r])&&Gg(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function rr(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function Gg(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!vE(t[n],e[n]))return!1;return!0}function vE(t,e){return Bt(t)?sf(t,e):Bt(e)?sf(e,t):t===e}function sf(t,e){return Bt(e)?t.length===e.length&&t.every((n,s)=>n===e[s]):t.length===1&&t[0]===e}function EE(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),s=t.split("/");let r=n.length-1,i,o;for(i=0;i<s.length;i++)if(o=s[i],o!==".")if(o==="..")r>1&&r--;else break;return n.slice(0,r).join("/")+"/"+s.slice(i-(i===s.length?1:0)).join("/")}var mi;(function(t){t.pop="pop",t.push="push"})(mi||(mi={}));var ni;(function(t){t.back="back",t.forward="forward",t.unknown=""})(ni||(ni={}));function IE(t){if(!t)if(Vs){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),yE(t)}const bE=/^[^#]+#/;function _E(t,e){return t.replace(bE,"#")+e}function TE(t,e){const n=document.documentElement.getBoundingClientRect(),s=t.getBoundingClientRect();return{behavior:e.behavior,left:s.left-n.left-(e.left||0),top:s.top-n.top-(e.top||0)}}const Ta=()=>({left:window.pageXOffset,top:window.pageYOffset});function CE(t){let e;if("el"in t){const n=t.el,s=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;e=TE(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function rf(t,e){return(history.state?history.state.position-e:-1)+t}const zc=new Map;function xE(t,e){zc.set(t,e)}function SE(t){const e=zc.get(t);return zc.delete(t),e}let DE=()=>location.protocol+"//"+location.host;function zg(t,e){const{pathname:n,search:s,hash:r}=e,i=t.indexOf("#");if(i>-1){let a=r.includes(t.slice(i))?t.slice(i).length:1,c=r.slice(a);return c[0]!=="/"&&(c="/"+c),nf(c,"")}return nf(n,t)+s+r}function NE(t,e,n,s){let r=[],i=[],o=null;const a=({state:f})=>{const g=zg(t,location),m=n.value,v=e.value;let S=0;if(f){if(n.value=g,e.value=f,o&&o===m){o=null;return}S=v?f.position-v.position:0}else s(g);r.forEach(N=>{N(n.value,m,{delta:S,type:mi.pop,direction:S?S>0?ni.forward:ni.back:ni.unknown})})};function c(){o=n.value}function u(f){r.push(f);const g=()=>{const m=r.indexOf(f);m>-1&&r.splice(m,1)};return i.push(g),g}function l(){const{history:f}=window;f.state&&f.replaceState(fe({},f.state,{scroll:Ta()}),"")}function h(){for(const f of i)f();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",l)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",l),{pauseListeners:c,listen:u,destroy:h}}function of(t,e,n,s=!1,r=!1){return{back:t,current:e,forward:n,replaced:s,position:window.history.length,scroll:r?Ta():null}}function kE(t){const{history:e,location:n}=window,s={value:zg(t,n)},r={value:e.state};r.value||i(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,u,l){const h=t.indexOf("#"),f=h>-1?(n.host&&document.querySelector("base")?t:t.slice(h))+c:DE()+t+c;try{e[l?"replaceState":"pushState"](u,"",f),r.value=u}catch(g){console.error(g),n[l?"replace":"assign"](f)}}function o(c,u){const l=fe({},e.state,of(r.value.back,c,r.value.forward,!0),u,{position:r.value.position});i(c,l,!0),s.value=c}function a(c,u){const l=fe({},r.value,e.state,{forward:c,scroll:Ta()});i(l.current,l,!0);const h=fe({},of(s.value,c,null),{position:l.position+1},u);i(c,h,!1),s.value=c}return{location:s,state:r,push:a,replace:o}}function OE(t){t=IE(t);const e=kE(t),n=NE(t,e.state,e.location,e.replace);function s(i,o=!0){o||n.pauseListeners(),history.go(i)}const r=fe({location:"",base:t,go:s,createHref:_E.bind(null,t)},e,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function RE(t){return typeof t=="string"||t&&typeof t=="object"}function Wg(t){return typeof t=="string"||typeof t=="symbol"}const fn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Yg=Symbol("");var af;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(af||(af={}));function ir(t,e){return fe(new Error,{type:t,[Yg]:!0},e)}function Jt(t,e){return t instanceof Error&&Yg in t&&(e==null||!!(t.type&e))}const cf="[^/]+?",ME={sensitive:!1,strict:!1,start:!0,end:!0},BE=/[.+*?^${}()[\]/\\]/g;function PE(t,e){const n=fe({},ME,e),s=[];let r=n.start?"^":"";const i=[];for(const u of t){const l=u.length?[]:[90];n.strict&&!u.length&&(r+="/");for(let h=0;h<u.length;h++){const f=u[h];let g=40+(n.sensitive?.25:0);if(f.type===0)h||(r+="/"),r+=f.value.replace(BE,"\\$&"),g+=40;else if(f.type===1){const{value:m,repeatable:v,optional:S,regexp:N}=f;i.push({name:m,repeatable:v,optional:S});const V=N||cf;if(V!==cf){g+=10;try{new RegExp(`(${V})`)}catch(G){throw new Error(`Invalid custom RegExp for param "${m}" (${V}): `+G.message)}}let M=v?`((?:${V})(?:/(?:${V}))*)`:`(${V})`;h||(M=S&&u.length<2?`(?:/${M})`:"/"+M),S&&(M+="?"),r+=M,g+=20,S&&(g+=-8),v&&(g+=-20),V===".*"&&(g+=-50)}l.push(g)}s.push(l)}if(n.strict&&n.end){const u=s.length-1;s[u][s[u].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&(r+="(?:/|$)");const o=new RegExp(r,n.sensitive?"":"i");function a(u){const l=u.match(o),h={};if(!l)return null;for(let f=1;f<l.length;f++){const g=l[f]||"",m=i[f-1];h[m.name]=g&&m.repeatable?g.split("/"):g}return h}function c(u){let l="",h=!1;for(const f of t){(!h||!l.endsWith("/"))&&(l+="/"),h=!1;for(const g of f)if(g.type===0)l+=g.value;else if(g.type===1){const{value:m,repeatable:v,optional:S}=g,N=m in u?u[m]:"";if(Bt(N)&&!v)throw new Error(`Provided param "${m}" is an array but it is not repeatable (* or + modifiers)`);const V=Bt(N)?N.join("/"):N;if(!V)if(S)f.length<2&&(l.endsWith("/")?l=l.slice(0,-1):h=!0);else throw new Error(`Missing required param "${m}"`);l+=V}}return l||"/"}return{re:o,score:s,keys:i,parse:a,stringify:c}}function LE(t,e){let n=0;for(;n<t.length&&n<e.length;){const s=e[n]-t[n];if(s)return s;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function FE(t,e){let n=0;const s=t.score,r=e.score;for(;n<s.length&&n<r.length;){const i=LE(s[n],r[n]);if(i)return i;n++}if(Math.abs(r.length-s.length)===1){if(uf(s))return 1;if(uf(r))return-1}return r.length-s.length}function uf(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const VE={type:0,value:""},$E=/[a-zA-Z0-9_]/;function UE(t){if(!t)return[[]];if(t==="/")return[[VE]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(g){throw new Error(`ERR (${n})/"${u}": ${g}`)}let n=0,s=n;const r=[];let i;function o(){i&&r.push(i),i=[]}let a=0,c,u="",l="";function h(){u&&(n===0?i.push({type:0,value:u}):n===1||n===2||n===3?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:u,regexp:l,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),u="")}function f(){u+=c}for(;a<t.length;){if(c=t[a++],c==="\\"&&n!==2){s=n,n=4;continue}switch(n){case 0:c==="/"?(u&&h(),o()):c===":"?(h(),n=1):f();break;case 4:f(),n=s;break;case 1:c==="("?n=2:$E.test(c)?f():(h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?l[l.length-1]=="\\"?l=l.slice(0,-1)+c:n=3:l+=c;break;case 3:h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,l="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${u}"`),h(),o(),r}function qE(t,e,n){const s=PE(UE(t.path),n),r=fe(s,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function jE(t,e){const n=[],s=new Map;e=ff({strict:!1,end:!0,sensitive:!1},e);function r(l){return s.get(l)}function i(l,h,f){const g=!f,m=QE(l);m.aliasOf=f&&f.record;const v=ff(e,l),S=[m];if("alias"in l){const M=typeof l.alias=="string"?[l.alias]:l.alias;for(const G of M)S.push(fe({},m,{components:f?f.record.components:m.components,path:G,aliasOf:f?f.record:m}))}let N,V;for(const M of S){const{path:G}=M;if(h&&G[0]!=="/"){const te=h.record.path,re=te[te.length-1]==="/"?"":"/";M.path=h.record.path+(G&&re+G)}if(N=qE(M,h,v),f?f.alias.push(N):(V=V||N,V!==N&&V.alias.push(N),g&&l.name&&!hf(N)&&o(l.name)),m.children){const te=m.children;for(let re=0;re<te.length;re++)i(te[re],N,f&&f.children[re])}f=f||N,(N.record.components&&Object.keys(N.record.components).length||N.record.name||N.record.redirect)&&c(N)}return V?()=>{o(V)}:ti}function o(l){if(Wg(l)){const h=s.get(l);h&&(s.delete(l),n.splice(n.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=n.indexOf(l);h>-1&&(n.splice(h,1),l.record.name&&s.delete(l.record.name),l.children.forEach(o),l.alias.forEach(o))}}function a(){return n}function c(l){let h=0;for(;h<n.length&&FE(l,n[h])>=0&&(l.record.path!==n[h].record.path||!Jg(l,n[h]));)h++;n.splice(h,0,l),l.record.name&&!hf(l)&&s.set(l.record.name,l)}function u(l,h){let f,g={},m,v;if("name"in l&&l.name){if(f=s.get(l.name),!f)throw ir(1,{location:l});v=f.record.name,g=fe(lf(h.params,f.keys.filter(V=>!V.optional).map(V=>V.name)),l.params&&lf(l.params,f.keys.map(V=>V.name))),m=f.stringify(g)}else if("path"in l)m=l.path,f=n.find(V=>V.re.test(m)),f&&(g=f.parse(m),v=f.record.name);else{if(f=h.name?s.get(h.name):n.find(V=>V.re.test(h.path)),!f)throw ir(1,{location:l,currentLocation:h});v=f.record.name,g=fe({},h.params,l.params),m=f.stringify(g)}const S=[];let N=f;for(;N;)S.unshift(N.record),N=N.parent;return{name:v,path:m,params:g,matched:S,meta:KE(S)}}return t.forEach(l=>i(l)),{addRoute:i,resolve:u,removeRoute:o,getRoutes:a,getRecordMatcher:r}}function lf(t,e){const n={};for(const s of e)s in t&&(n[s]=t[s]);return n}function QE(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:HE(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function HE(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const s in t.components)e[s]=typeof n=="boolean"?n:n[s];return e}function hf(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function KE(t){return t.reduce((e,n)=>fe(e,n.meta),{})}function ff(t,e){const n={};for(const s in t)n[s]=s in e?e[s]:t[s];return n}function Jg(t,e){return e.children.some(n=>n===t||Jg(t,n))}const Xg=/#/g,GE=/&/g,zE=/\//g,WE=/=/g,YE=/\?/g,Zg=/\+/g,JE=/%5B/g,XE=/%5D/g,ep=/%5E/g,ZE=/%60/g,tp=/%7B/g,eI=/%7C/g,np=/%7D/g,tI=/%20/g;function Zu(t){return encodeURI(""+t).replace(eI,"|").replace(JE,"[").replace(XE,"]")}function nI(t){return Zu(t).replace(tp,"{").replace(np,"}").replace(ep,"^")}function Wc(t){return Zu(t).replace(Zg,"%2B").replace(tI,"+").replace(Xg,"%23").replace(GE,"%26").replace(ZE,"`").replace(tp,"{").replace(np,"}").replace(ep,"^")}function sI(t){return Wc(t).replace(WE,"%3D")}function rI(t){return Zu(t).replace(Xg,"%23").replace(YE,"%3F")}function iI(t){return t==null?"":rI(t).replace(zE,"%2F")}function qo(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function oI(t){const e={};if(t===""||t==="?")return e;const s=(t[0]==="?"?t.slice(1):t).split("&");for(let r=0;r<s.length;++r){const i=s[r].replace(Zg," "),o=i.indexOf("="),a=qo(o<0?i:i.slice(0,o)),c=o<0?null:qo(i.slice(o+1));if(a in e){let u=e[a];Bt(u)||(u=e[a]=[u]),u.push(c)}else e[a]=c}return e}function df(t){let e="";for(let n in t){const s=t[n];if(n=sI(n),s==null){s!==void 0&&(e+=(e.length?"&":"")+n);continue}(Bt(s)?s.map(i=>i&&Wc(i)):[s&&Wc(s)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function aI(t){const e={};for(const n in t){const s=t[n];s!==void 0&&(e[n]=Bt(s)?s.map(r=>r==null?null:""+r):s==null?s:""+s)}return e}const cI=Symbol(""),gf=Symbol(""),el=Symbol(""),sp=Symbol(""),Yc=Symbol("");function Fr(){let t=[];function e(s){return t.push(s),()=>{const r=t.indexOf(s);r>-1&&t.splice(r,1)}}function n(){t=[]}return{add:e,list:()=>t,reset:n}}function yn(t,e,n,s,r){const i=s&&(s.enterCallbacks[r]=s.enterCallbacks[r]||[]);return()=>new Promise((o,a)=>{const c=h=>{h===!1?a(ir(4,{from:n,to:e})):h instanceof Error?a(h):RE(h)?a(ir(2,{from:e,to:h})):(i&&s.enterCallbacks[r]===i&&typeof h=="function"&&i.push(h),o())},u=t.call(s&&s.instances[r],e,n,c);let l=Promise.resolve(u);t.length<3&&(l=l.then(c)),l.catch(h=>a(h))})}function Ac(t,e,n,s){const r=[];for(const i of t)for(const o in i.components){let a=i.components[o];if(!(e!=="beforeRouteEnter"&&!i.instances[o]))if(uI(a)){const u=(a.__vccOpts||a)[e];u&&r.push(yn(u,n,s,i,o))}else{let c=a();r.push(()=>c.then(u=>{if(!u)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${i.path}"`));const l=pE(u)?u.default:u;i.components[o]=l;const f=(l.__vccOpts||l)[e];return f&&yn(f,n,s,i,o)()}))}}return r}function uI(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function pf(t){const e=en(el),n=en(sp),s=Tt(()=>e.resolve(Ws(t.to))),r=Tt(()=>{const{matched:c}=s.value,{length:u}=c,l=c[u-1],h=n.matched;if(!l||!h.length)return-1;const f=h.findIndex(rr.bind(null,l));if(f>-1)return f;const g=mf(c[u-2]);return u>1&&mf(l)===g&&h[h.length-1].path!==g?h.findIndex(rr.bind(null,c[u-2])):f}),i=Tt(()=>r.value>-1&&dI(n.params,s.value.params)),o=Tt(()=>r.value>-1&&r.value===n.matched.length-1&&Gg(n.params,s.value.params));function a(c={}){return fI(c)?e[Ws(t.replace)?"replace":"push"](Ws(t.to)).catch(ti):Promise.resolve()}return{route:s,href:Tt(()=>s.value.href),isActive:i,isExactActive:o,navigate:a}}const lI=Li({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:pf,setup(t,{slots:e}){const n=_r(pf(t)),{options:s}=en(el),r=Tt(()=>({[yf(t.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[yf(t.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&e.default(n);return t.custom?i:Kg("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},i)}}}),hI=lI;function fI(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function dI(t,e){for(const n in e){const s=e[n],r=t[n];if(typeof s=="string"){if(s!==r)return!1}else if(!Bt(r)||r.length!==s.length||s.some((i,o)=>i!==r[o]))return!1}return!0}function mf(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const yf=(t,e,n)=>t??e??n,gI=Li({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const s=en(Yc),r=Tt(()=>t.route||s.value),i=en(gf,0),o=Tt(()=>{let u=Ws(i);const{matched:l}=r.value;let h;for(;(h=l[u])&&!h.components;)u++;return u}),a=Tt(()=>r.value.matched[o.value]);xo(gf,Tt(()=>o.value+1)),xo(cI,a),xo(Yc,r);const c=CA();return So(()=>[c.value,a.value,t.name],([u,l,h],[f,g,m])=>{l&&(l.instances[h]=u,g&&g!==l&&u&&u===f&&(l.leaveGuards.size||(l.leaveGuards=g.leaveGuards),l.updateGuards.size||(l.updateGuards=g.updateGuards))),u&&l&&(!g||!rr(l,g)||!f)&&(l.enterCallbacks[h]||[]).forEach(v=>v(u))},{flush:"post"}),()=>{const u=r.value,l=t.name,h=a.value,f=h&&h.components[l];if(!f)return wf(n.default,{Component:f,route:u});const g=h.props[l],m=g?g===!0?u.params:typeof g=="function"?g(u):g:null,S=Kg(f,fe({},m,e,{onVnodeUnmounted:N=>{N.component.isUnmounted&&(h.instances[l]=null)},ref:c}));return wf(n.default,{Component:S,route:u})||S}}});function wf(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const pI=gI;function mI(t){const e=jE(t.routes,t),n=t.parseQuery||oI,s=t.stringifyQuery||df,r=t.history,i=Fr(),o=Fr(),a=Fr(),c=xA(fn);let u=fn;Vs&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const l=yc.bind(null,I=>""+I),h=yc.bind(null,iI),f=yc.bind(null,qo);function g(I,F){let B,Q;return Wg(I)?(B=e.getRecordMatcher(I),Q=F):Q=I,e.addRoute(Q,B)}function m(I){const F=e.getRecordMatcher(I);F&&e.removeRoute(F)}function v(){return e.getRoutes().map(I=>I.record)}function S(I){return!!e.getRecordMatcher(I)}function N(I,F){if(F=fe({},F||c.value),typeof I=="string"){const d=wc(n,I,F.path),p=e.resolve({path:d.path},F),A=r.createHref(d.fullPath);return fe(d,p,{params:f(p.params),hash:qo(d.hash),redirectedFrom:void 0,href:A})}let B;if("path"in I)B=fe({},I,{path:wc(n,I.path,F.path).path});else{const d=fe({},I.params);for(const p in d)d[p]==null&&delete d[p];B=fe({},I,{params:h(I.params)}),F.params=h(F.params)}const Q=e.resolve(B,F),ae=I.hash||"";Q.params=l(f(Q.params));const xe=wE(s,fe({},I,{hash:nI(ae),path:Q.path})),ee=r.createHref(xe);return fe({fullPath:xe,hash:ae,query:s===df?aI(I.query):I.query||{}},Q,{redirectedFrom:void 0,href:ee})}function V(I){return typeof I=="string"?wc(n,I,c.value.path):fe({},I)}function M(I,F){if(u!==I)return ir(8,{from:F,to:I})}function G(I){return Ae(I)}function te(I){return G(fe(V(I),{replace:!0}))}function re(I){const F=I.matched[I.matched.length-1];if(F&&F.redirect){const{redirect:B}=F;let Q=typeof B=="function"?B(I):B;return typeof Q=="string"&&(Q=Q.includes("?")||Q.includes("#")?Q=V(Q):{path:Q},Q.params={}),fe({query:I.query,hash:I.hash,params:"path"in Q?{}:I.params},Q)}}function Ae(I,F){const B=u=N(I),Q=c.value,ae=I.state,xe=I.force,ee=I.replace===!0,d=re(B);if(d)return Ae(fe(V(d),{state:typeof d=="object"?fe({},ae,d.state):ae,force:xe,replace:ee}),F||B);const p=B;p.redirectedFrom=F;let A;return!xe&&AE(s,Q,B)&&(A=ir(16,{to:p,from:Q}),Qn(Q,Q,!0,!1)),(A?Promise.resolve(A):Os(p,Q)).catch(E=>Jt(E)?Jt(E,2)?E:xt(E):ye(E,p,Q)).then(E=>{if(E){if(Jt(E,2))return Ae(fe({replace:ee},V(E.to),{state:typeof E.to=="object"?fe({},ae,E.to.state):ae,force:xe}),F||p)}else E=ln(p,Q,!0,ee,ae);return Pt(p,Q,E),E})}function rt(I,F){const B=M(I,F);return B?Promise.reject(B):Promise.resolve()}function Os(I,F){let B;const[Q,ae,xe]=yI(I,F);B=Ac(Q.reverse(),"beforeRouteLeave",I,F);for(const d of Q)d.leaveGuards.forEach(p=>{B.push(yn(p,I,F))});const ee=rt.bind(null,I,F);return B.push(ee),Ps(B).then(()=>{B=[];for(const d of i.list())B.push(yn(d,I,F));return B.push(ee),Ps(B)}).then(()=>{B=Ac(ae,"beforeRouteUpdate",I,F);for(const d of ae)d.updateGuards.forEach(p=>{B.push(yn(p,I,F))});return B.push(ee),Ps(B)}).then(()=>{B=[];for(const d of I.matched)if(d.beforeEnter&&!F.matched.includes(d))if(Bt(d.beforeEnter))for(const p of d.beforeEnter)B.push(yn(p,I,F));else B.push(yn(d.beforeEnter,I,F));return B.push(ee),Ps(B)}).then(()=>(I.matched.forEach(d=>d.enterCallbacks={}),B=Ac(xe,"beforeRouteEnter",I,F),B.push(ee),Ps(B))).then(()=>{B=[];for(const d of o.list())B.push(yn(d,I,F));return B.push(ee),Ps(B)}).catch(d=>Jt(d,8)?d:Promise.reject(d))}function Pt(I,F,B){for(const Q of a.list())Q(I,F,B)}function ln(I,F,B,Q,ae){const xe=M(I,F);if(xe)return xe;const ee=F===fn,d=Vs?history.state:{};B&&(Q||ee?r.replace(I.fullPath,fe({scroll:ee&&d&&d.scroll},ae)):r.push(I.fullPath,ae)),c.value=I,Qn(I,F,B,ee),xt()}let Lt;function Rs(){Lt||(Lt=r.listen((I,F,B)=>{if(!io.listening)return;const Q=N(I),ae=re(Q);if(ae){Ae(fe(ae,{replace:!0}),Q).catch(ti);return}u=Q;const xe=c.value;Vs&&xE(rf(xe.fullPath,B.delta),Ta()),Os(Q,xe).catch(ee=>Jt(ee,12)?ee:Jt(ee,2)?(Ae(ee.to,Q).then(d=>{Jt(d,20)&&!B.delta&&B.type===mi.pop&&r.go(-1,!1)}).catch(ti),Promise.reject()):(B.delta&&r.go(-B.delta,!1),ye(ee,Q,xe))).then(ee=>{ee=ee||ln(Q,xe,!1),ee&&(B.delta&&!Jt(ee,8)?r.go(-B.delta,!1):B.type===mi.pop&&Jt(ee,20)&&r.go(-1,!1)),Pt(Q,xe,ee)}).catch(ti)}))}let jn=Fr(),Br=Fr(),Be;function ye(I,F,B){xt(I);const Q=Br.list();return Q.length?Q.forEach(ae=>ae(I,F,B)):console.error(I),Promise.reject(I)}function ge(){return Be&&c.value!==fn?Promise.resolve():new Promise((I,F)=>{jn.add([I,F])})}function xt(I){return Be||(Be=!I,Rs(),jn.list().forEach(([F,B])=>I?B(I):F()),jn.reset()),I}function Qn(I,F,B,Q){const{scrollBehavior:ae}=t;if(!Vs||!ae)return Promise.resolve();const xe=!B&&SE(rf(I.fullPath,0))||(Q||!B)&&history.state&&history.state.scroll||null;return Eg().then(()=>ae(I,F,xe)).then(ee=>ee&&CE(ee)).catch(ee=>ye(ee,I,F))}const St=I=>r.go(I);let dt;const Ms=new Set,io={currentRoute:c,listening:!0,addRoute:g,removeRoute:m,hasRoute:S,getRoutes:v,resolve:N,options:t,push:G,replace:te,go:St,back:()=>St(-1),forward:()=>St(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:Br.add,isReady:ge,install(I){const F=this;I.component("RouterLink",hI),I.component("RouterView",pI),I.config.globalProperties.$router=F,Object.defineProperty(I.config.globalProperties,"$route",{enumerable:!0,get:()=>Ws(c)}),Vs&&!dt&&c.value===fn&&(dt=!0,G(r.location).catch(ae=>{}));const B={};for(const ae in fn)B[ae]=Tt(()=>c.value[ae]);I.provide(el,F),I.provide(sp,_r(B)),I.provide(Yc,c);const Q=I.unmount;Ms.add(I),I.unmount=function(){Ms.delete(I),Ms.size<1&&(u=fn,Lt&&Lt(),Lt=null,c.value=fn,dt=!1,Be=!1),Q()}}};return io}function Ps(t){return t.reduce((e,n)=>e.then(()=>n()),Promise.resolve())}function yI(t,e){const n=[],s=[],r=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(u=>rr(u,a))?s.push(a):n.push(a));const c=t.matched[o];c&&(e.matched.find(u=>rr(u,c))||r.push(c))}return[n,s,r]}const wI="/rock-portal/assets/C3tyan-cf1e1f3c.png",AI="/rock-portal/assets/ToyBox-80f65ab5.png",vI="/rock-portal/assets/c__-5f0eef80.png",EI="/rock-portal/assets/c3-logo-f9e17538.png",II="/rock-portal/assets/cork-board-b8c3c6c2.png",bI="/rock-portal/assets/github-367d5cb2.png",_I="/rock-portal/assets/google-fot-c81ae00a.png",TI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAnwAAAJ8CAYAAABk7XxWAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAvxSURBVHgB7dmxSUQBEEXRURbUTARb0MgKTO3ANrSHDaxAsAPLMN3UxEgw2VwwFDHQwALMFv7lnB4GLm/2bu+efgYAgKz9AQAgTfABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDErQbYqYvz0zk6WNbpvby+z+fX9wCwTIIPduz66mxOjg9nSdbbjeADWDAvXQCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiVgPwj/XN5cCS3D8+z9v2Y4A/Fj4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgbjXATq0fNgMAu2ThAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIE7wAQDECT4AgDjBBwAQJ/gAAOIEHwBAnOADAIgTfAAAcYIPACBO8AEAxAk+AIA4wQcAECf4AADiBB8AQJzgAwCIE3wAAHGCDwAgTvABAMQJPgCAOMEHABAn+AAA4gQfAECc4AMAiBN8AABxgg8AIO4XBSIbVZUZlt0AAAAASUVORK5CYII=",CI="/rock-portal/assets/niconico-d77be101.webp",xI="data:application/json;base64,ewogICJ2aWRlb1NoYXJpbmdTZXJ2aWNlcyI6IFsKICAgIHsKICAgICAgImljb25UeXBlIjogImV4dGVybmFsIiwKICAgICAgImljb24iOiAiaHR0cHM6Ly9jZG4taWNvbnMtcG5nLmZsYXRpY29uLmNvbS81MTIvMTM4NC8xMzg0MDYwLnBuZyIsCiAgICAgICJuYW1lIjogIllvdXR1YmUiLAogICAgICAidXJsIjogImh0dHBzOi8vd3d3LnlvdXR1YmUuY29tLyIKICAgIH0sCiAgICB7CiAgICAgICJpY29uVHlwZSI6ICJpbnRlcm5hbCIsCiAgICAgICJpY29uIjogImxpbmtJY29ucy9uaWNvbmljby53ZWJwIiwKICAgICAgIm5hbWUiOiAi44OL44Kz44OL44Kz5YuV55S7IiwKICAgICAgInVybCI6ICJodHRwOi8vd3d3Lm5pY292aWRlby5qcC8iCiAgICB9CiAgXQp9Cg==",SI="/rock-portal/assets/logo-da9b9095.svg",DI="data:text/css;base64,QHRhaWx3aW5kIGJhc2U7CkB0YWlsd2luZCBjb21wb25lbnRzOwpAdGFpbHdpbmQgdXRpbGl0aWVzOw==",NI="/rock-portal/assets/mastodon-ad0ccbd0.png",kI="/rock-portal/assets/wall-a4b91660.jpg",OI="/rock-portal/assets/cork-board-b8c3c6c2.png",RI="/rock-portal/assets/github-367d5cb2.png",MI="/rock-portal/assets/c__-5f0eef80.png",BI="/rock-portal/assets/C3tyan-cf1e1f3c.png",PI="/rock-portal/assets/c3-logo-f9e17538.png",LI="/rock-portal/assets/mastodon-ad0ccbd0.png",FI="/rock-portal/assets/ToyBox-80f65ab5.png",VI={class:"absolute border-solid border-b-[5px] border-l-2 border-r-2 border-gray-700 border-opacity-40 overflow-hidden z-50 paper-wrapper"},$I={class:"bg-[#f6f2e5] w-full h-full z-10 min-h-[100px] relative pb-5 paper"},UI=Li({__name:"Paper",props:{pinColor:{type:String,required:!0}},setup(t){return(e,n)=>(vt(),Xn("div",VI,[tr("div",$I,[tr("div",{class:da(["w-[1.5vw] h-[1.5vw] min-w-[13px] min-h-[13px] max-w-[18.6px] max-h-[18.6px] rounded-full absolute top-[1vw] left-[50%] -translate-x-1/2 pin",{yellow:t.pinColor==="yellow",blue:t.pinColor==="blue",green:t.pinColor==="green",red:t.pinColor==="red"}])},null,2),ov(e.$slots,"default",{},void 0,!0)])]))}});const go=_a(UI,[["__scopeId","data-v-a97fd855"]]),qI=["href","title"],jI=["src","alt"],QI={class:"link-name"},HI=Li({__name:"Links",props:{linkIcon:{type:String,required:!0},linkName:{type:String,required:!0},linkUrl:{type:String,required:!0}},setup(t){return(e,n)=>(vt(),Xn("a",{href:t.linkUrl,title:t.linkName,target:"_blank",class:"h-[3vw] min-h-[24.5px] max-h-[35.3px] flex items-center link-m"},[tr("img",{src:t.linkIcon,alt:`${t.linkName} Name`,class:"h-full w-auto rounded-lg dropshadow link-icon mr-[1.5vw]"},null,8,jI),tr("div",QI,Qw(t.linkName),1)],8,qI))}});const po=_a(HI,[["__scopeId","data-v-94ef4db7"]]);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rp=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},KI=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],a=t[n++],c=((r&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},ip={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,a=o?t[r+1]:0,c=r+2<t.length,u=c?t[r+2]:0,l=i>>2,h=(i&3)<<4|a>>4;let f=(a&15)<<2|u>>6,g=u&63;c||(g=64,o||(f=64)),s.push(n[l],n[h],n[f],n[g])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(rp(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):KI(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;const u=r<t.length?n[t.charAt(r)]:64;++r;const h=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||a==null||u==null||h==null)throw Error();const f=i<<2|a>>4;if(s.push(f),u!==64){const g=a<<4&240|u>>2;if(s.push(g),h!==64){const m=u<<6&192|h;s.push(m)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},GI=function(t){const e=rp(t);return ip.encodeByteArray(e,!0)},jo=function(t){return GI(t).replace(/\./g,"")},zI=function(t){try{return ip.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Qo(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!WI(n)||(t[n]=Qo(t[n],e[n]));return t}function WI(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jc(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function YI(){try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function JI(){return typeof self=="object"&&self.self===self}function XI(){return!YI()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function op(){try{return typeof indexedDB=="object"}catch{return!1}}function ZI(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var i;e(((i=r.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function eb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tb=()=>eb().__FIREBASE_DEFAULTS__,nb=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},sb=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&zI(t[1]);return e&&JSON.parse(e)},rb=()=>{try{return tb()||nb()||sb()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},ib=()=>{var t;return(t=rb())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ab(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[jo(JSON.stringify(n)),jo(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb="FirebaseError";class Ts extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=cb,Object.setPrototypeOf(this,Ts.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ca.prototype.create)}}class Ca{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?ub(i,s):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Ts(r,a,s)}}function ub(t,e){return t.replace(lb,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const lb=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Af(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Xc(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(vf(i)&&vf(o)){if(!Xc(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function vf(t){return t!==null&&typeof t=="object"}function hb(t,e){const n=new fb(t,e);return n.subscribe.bind(n)}class fb{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");db(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=vc),r.error===void 0&&(r.error=vc),r.complete===void 0&&(r.complete=vc);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function db(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function vc(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fe(t){return t&&t._delegate?t._delegate:t}class ds{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new ob;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(mb(e))try{this.getOrInitializeService({instanceIdentifier:Wn})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=Wn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Wn){return this.instances.has(e)}getOptions(e=Wn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);s===a&&o.resolve(r)}return r}onInit(e,n){var s;const r=this.normalizeInstanceIdentifier(n),i=(s=this.onInitCallbacks.get(r))!==null&&s!==void 0?s:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:pb(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Wn){return this.component?this.component.multipleInstances?e:Wn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function pb(t){return t===Wn?void 0:t}function mb(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new gb(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tl=[];var le;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(le||(le={}));const ap={debug:le.DEBUG,verbose:le.VERBOSE,info:le.INFO,warn:le.WARN,error:le.ERROR,silent:le.SILENT},wb=le.INFO,Ab={[le.DEBUG]:"log",[le.VERBOSE]:"log",[le.INFO]:"info",[le.WARN]:"warn",[le.ERROR]:"error"},vb=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=Ab[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class nl{constructor(e){this.name=e,this._logLevel=wb,this._logHandler=vb,this._userLogHandler=null,tl.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ap[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,le.DEBUG,...e),this._logHandler(this,le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,le.VERBOSE,...e),this._logHandler(this,le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,le.INFO,...e),this._logHandler(this,le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,le.WARN,...e),this._logHandler(this,le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,le.ERROR,...e),this._logHandler(this,le.ERROR,...e)}}function Eb(t){tl.forEach(e=>{e.setLogLevel(t)})}function Ib(t,e){for(const n of tl){let s=null;e&&e.level&&(s=ap[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(r,i,...o)=>{const a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");i>=(s??r.logLevel)&&t({level:le[i].toLowerCase(),message:a,args:o,type:r.name})}}}const bb=(t,e)=>e.some(n=>t instanceof n);let Ef,If;function _b(){return Ef||(Ef=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Tb(){return If||(If=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cp=new WeakMap,Zc=new WeakMap,up=new WeakMap,Ec=new WeakMap,sl=new WeakMap;function Cb(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(bn(t.result)),r()},o=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&cp.set(n,t)}).catch(()=>{}),sl.set(e,t),e}function xb(t){if(Zc.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),r()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Zc.set(t,e)}let eu={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Zc.get(t);if(e==="objectStoreNames")return t.objectStoreNames||up.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return bn(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Sb(t){eu=t(eu)}function Db(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(Ic(this),e,...n);return up.set(s,e.sort?e.sort():[e]),bn(s)}:Tb().includes(t)?function(...e){return t.apply(Ic(this),e),bn(cp.get(this))}:function(...e){return bn(t.apply(Ic(this),e))}}function Nb(t){return typeof t=="function"?Db(t):(t instanceof IDBTransaction&&xb(t),bb(t,_b())?new Proxy(t,eu):t)}function bn(t){if(t instanceof IDBRequest)return Cb(t);if(Ec.has(t))return Ec.get(t);const e=Nb(t);return e!==t&&(Ec.set(t,e),sl.set(e,t)),e}const Ic=t=>sl.get(t);function kb(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(t,e),a=bn(o);return s&&o.addEventListener("upgradeneeded",c=>{s(bn(o.result),c.oldVersion,c.newVersion,bn(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(c=>{i&&c.addEventListener("close",()=>i()),r&&c.addEventListener("versionchange",()=>r())}).catch(()=>{}),a}const Ob=["get","getKey","getAll","getAllKeys","count"],Rb=["put","add","delete","clear"],bc=new Map;function bf(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(bc.get(e))return bc.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=Rb.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||Ob.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let u=c.store;return s&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),r&&c.done]))[0]};return bc.set(e,i),i}Sb(t=>({...t,get:(e,n,s)=>bf(e,n)||t.get(e,n,s),has:(e,n)=>!!bf(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Bb(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function Bb(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const tu="@firebase/app",_f="0.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gs=new nl("@firebase/app"),Pb="@firebase/app-compat",Lb="@firebase/analytics-compat",Fb="@firebase/analytics",Vb="@firebase/app-check-compat",$b="@firebase/app-check",Ub="@firebase/auth",qb="@firebase/auth-compat",jb="@firebase/database",Qb="@firebase/database-compat",Hb="@firebase/functions",Kb="@firebase/functions-compat",Gb="@firebase/installations",zb="@firebase/installations-compat",Wb="@firebase/messaging",Yb="@firebase/messaging-compat",Jb="@firebase/performance",Xb="@firebase/performance-compat",Zb="@firebase/remote-config",e0="@firebase/remote-config-compat",t0="@firebase/storage",n0="@firebase/storage-compat",s0="@firebase/firestore",r0="@firebase/firestore-compat",i0="firebase",o0="9.15.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xn="[DEFAULT]",a0={[tu]:"fire-core",[Pb]:"fire-core-compat",[Fb]:"fire-analytics",[Lb]:"fire-analytics-compat",[$b]:"fire-app-check",[Vb]:"fire-app-check-compat",[Ub]:"fire-auth",[qb]:"fire-auth-compat",[jb]:"fire-rtdb",[Qb]:"fire-rtdb-compat",[Hb]:"fire-fn",[Kb]:"fire-fn-compat",[Gb]:"fire-iid",[zb]:"fire-iid-compat",[Wb]:"fire-fcm",[Yb]:"fire-fcm-compat",[Jb]:"fire-perf",[Xb]:"fire-perf-compat",[Zb]:"fire-rc",[e0]:"fire-rc-compat",[t0]:"fire-gcs",[n0]:"fire-gcs-compat",[s0]:"fire-fst",[r0]:"fire-fst-compat","fire-js":"fire-js",[i0]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sn=new Map,yi=new Map;function Ho(t,e){try{t.container.addComponent(e)}catch(n){gs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function lp(t,e){t.container.addOrOverwriteComponent(e)}function or(t){const e=t.name;if(yi.has(e))return gs.debug(`There were multiple attempts to register component ${e}.`),!1;yi.set(e,t);for(const n of Sn.values())Ho(n,t);return!0}function hp(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function c0(t,e,n=xn){hp(t,e).clearInstance(n)}function u0(){yi.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l0={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},tn=new Ca("app","Firebase",l0);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let h0=class{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new ds("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw tn.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rl=o0;function il(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:xn,automaticDataCollectionEnabled:!1},e),r=s.name;if(typeof r!="string"||!r)throw tn.create("bad-app-name",{appName:String(r)});if(n||(n=ib()),!n)throw tn.create("no-options");const i=Sn.get(r);if(i){if(Xc(n,i.options)&&Xc(s,i.config))return i;throw tn.create("duplicate-app",{appName:r})}const o=new yb(r);for(const c of yi.values())o.addComponent(c);const a=new h0(n,s,o);return Sn.set(r,a),a}function f0(t=xn){const e=Sn.get(t);if(!e&&t===xn)return il();if(!e)throw tn.create("no-app",{appName:t});return e}function d0(){return Array.from(Sn.values())}async function fp(t){const e=t.name;Sn.has(e)&&(Sn.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function _n(t,e,n){var s;let r=(s=a0[t])!==null&&s!==void 0?s:t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),gs.warn(a.join(" "));return}or(new ds(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function dp(t,e){if(t!==null&&typeof t!="function")throw tn.create("invalid-log-argument");Ib(t,e)}function gp(t){Eb(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0="firebase-heartbeat-database",p0=1,wi="firebase-heartbeat-store";let _c=null;function pp(){return _c||(_c=kb(g0,p0,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(wi)}}}).catch(t=>{throw tn.create("idb-open",{originalErrorMessage:t.message})})),_c}async function m0(t){try{return(await pp()).transaction(wi).objectStore(wi).get(mp(t))}catch(e){if(e instanceof Ts)gs.warn(e.message);else{const n=tn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});gs.warn(n.message)}}}async function Tf(t,e){try{const s=(await pp()).transaction(wi,"readwrite");return await s.objectStore(wi).put(e,mp(t)),s.done}catch(n){if(n instanceof Ts)gs.warn(n.message);else{const s=tn.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});gs.warn(s.message)}}}function mp(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y0=1024,w0=30*24*60*60*1e3;class A0{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new E0(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Cf();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(r=>r.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(r=>{const i=new Date(r.date).valueOf();return Date.now()-i<=w0}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Cf(),{heartbeatsToSend:n,unsentEntries:s}=v0(this._heartbeatsCache.heartbeats),r=jo(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function Cf(){return new Date().toISOString().substring(0,10)}function v0(t,e=y0){const n=[];let s=t.slice();for(const r of t){const i=n.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),xf(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),xf(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class E0{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return op()?ZI().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await m0(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return Tf(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return Tf(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function xf(t){return jo(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I0(t){or(new ds("platform-logger",e=>new Mb(e),"PRIVATE")),or(new ds("heartbeat",e=>new A0(e),"PRIVATE")),_n(tu,_f,t),_n(tu,_f,"esm2017"),_n("fire-js","")}I0("");const b0=Object.freeze(Object.defineProperty({__proto__:null,SDK_VERSION:rl,_DEFAULT_ENTRY_NAME:xn,_addComponent:Ho,_addOrOverwriteComponent:lp,_apps:Sn,_clearComponents:u0,_components:yi,_getProvider:hp,_registerComponent:or,_removeServiceInstance:c0,deleteApp:fp,getApp:f0,getApps:d0,initializeApp:il,onLog:dp,registerVersion:_n,setLogLevel:gp,FirebaseError:Ts},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{constructor(e,n){this._delegate=e,this.firebase=n,Ho(e,new ds("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),fp(this._delegate)))}_getService(e,n=xn){var s;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((s=r.getComponent())===null||s===void 0?void 0:s.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:n})}_removeServiceInstance(e,n=xn){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){Ho(this._delegate,e)}_addOrOverwriteComponent(e){lp(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T0={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},Sf=new Ca("app-compat","Firebase",T0);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C0(t){const e={},n={__esModule:!0,initializeApp:i,app:r,registerVersion:_n,setLogLevel:gp,onLog:dp,apps:null,SDK_VERSION:rl,INTERNAL:{registerComponent:a,removeApp:s,useAsService:c,modularAPIs:b0}};n.default=n,Object.defineProperty(n,"apps",{get:o});function s(u){delete e[u]}function r(u){if(u=u||xn,!Af(e,u))throw Sf.create("no-app",{appName:u});return e[u]}r.App=t;function i(u,l={}){const h=il(u,l);if(Af(e,h.name))return e[h.name];const f=new t(h,n);return e[h.name]=f,f}function o(){return Object.keys(e).map(u=>e[u])}function a(u){const l=u.name,h=l.replace("-compat","");if(or(u)&&u.type==="PUBLIC"){const f=(g=r())=>{if(typeof g[h]!="function")throw Sf.create("invalid-app-argument",{appName:l});return g[h]()};u.serviceProps!==void 0&&Qo(f,u.serviceProps),n[h]=f,t.prototype[h]=function(...g){return this._getService.bind(this,l).apply(this,u.multipleInstances?g:[])}}return u.type==="PUBLIC"?n[h]:null}function c(u,l){return l==="serverAuth"?null:l}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yp(){const t=C0(_0);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:yp,extendNamespace:e,createSubscribe:hb,ErrorFactory:Ca,deepExtend:Qo});function e(n){Qo(t,n)}return t}const x0=yp();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Df=new nl("@firebase/app-compat"),S0="@firebase/app-compat",D0="0.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(t){_n(S0,D0,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(JI()&&self.firebase!==void 0){Df.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&Df.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const xa=x0;N0();var k0="firebase",O0="9.15.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xa.registerVersion(k0,O0,"app-compat");var R0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},U,ol=ol||{},z=R0||self;function Ko(){}function Sa(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Fi(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function M0(t){return Object.prototype.hasOwnProperty.call(t,Tc)&&t[Tc]||(t[Tc]=++B0)}var Tc="closure_uid_"+(1e9*Math.random()>>>0),B0=0;function P0(t,e,n){return t.call.apply(t.bind,arguments)}function L0(t,e,n){if(!t)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,s),t.apply(e,r)}}return function(){return t.apply(e,arguments)}}function nt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?nt=P0:nt=L0,nt.apply(null,arguments)}function mo(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var s=n.slice();return s.push.apply(s,arguments),t.apply(this,s)}}function Ze(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Wb=function(s,r,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(s,o)}}function Ln(){this.s=this.s,this.o=this.o}var F0=0;Ln.prototype.s=!1;Ln.prototype.na=function(){!this.s&&(this.s=!0,this.M(),F0!=0)&&M0(this)};Ln.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const wp=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function al(t){const e=t.length;if(0<e){const n=Array(e);for(let s=0;s<e;s++)n[s]=t[s];return n}return[]}function Nf(t,e){for(let n=1;n<arguments.length;n++){const s=arguments[n];if(Sa(s)){const r=t.length||0,i=s.length||0;t.length=r+i;for(let o=0;o<i;o++)t[r+o]=s[o]}else t.push(s)}}function st(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}st.prototype.h=function(){this.defaultPrevented=!0};var V0=function(){if(!z.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{z.addEventListener("test",Ko,e),z.removeEventListener("test",Ko,e)}catch{}return t}();function Go(t){return/^[\s\xa0]*$/.test(t)}var kf=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Cc(t,e){return t<e?-1:t>e?1:0}function Da(){var t=z.navigator;return t&&(t=t.userAgent)?t:""}function jt(t){return Da().indexOf(t)!=-1}function cl(t){return cl[" "](t),t}cl[" "]=Ko;function $0(t){var e=j0;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var U0=jt("Opera"),ar=jt("Trident")||jt("MSIE"),Ap=jt("Edge"),nu=Ap||ar,vp=jt("Gecko")&&!(Da().toLowerCase().indexOf("webkit")!=-1&&!jt("Edge"))&&!(jt("Trident")||jt("MSIE"))&&!jt("Edge"),q0=Da().toLowerCase().indexOf("webkit")!=-1&&!jt("Edge");function Ep(){var t=z.document;return t?t.documentMode:void 0}var zo;e:{var xc="",Sc=function(){var t=Da();if(vp)return/rv:([^\);]+)(\)|;)/.exec(t);if(Ap)return/Edge\/([\d\.]+)/.exec(t);if(ar)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(q0)return/WebKit\/(\S+)/.exec(t);if(U0)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(Sc&&(xc=Sc?Sc[1]:""),ar){var Dc=Ep();if(Dc!=null&&Dc>parseFloat(xc)){zo=String(Dc);break e}}zo=xc}var j0={};function Q0(){return $0(function(){let t=0;const e=kf(String(zo)).split("."),n=kf("9").split("."),s=Math.max(e.length,n.length);for(let o=0;t==0&&o<s;o++){var r=e[o]||"",i=n[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],r[0].length==0&&i[0].length==0)break;t=Cc(r[1].length==0?0:parseInt(r[1],10),i[1].length==0?0:parseInt(i[1],10))||Cc(r[2].length==0,i[2].length==0)||Cc(r[2],i[2]),r=r[3],i=i[3]}while(t==0)}return 0<=t})}var su;if(z.document&&ar){var Of=Ep();su=Of||parseInt(zo,10)||void 0}else su=void 0;var H0=su;function Ai(t,e){if(st.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,s=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(vp){e:{try{cl(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,s?(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:K0[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ai.X.h.call(this)}}Ze(Ai,st);var K0={2:"touch",3:"pen",4:"mouse"};Ai.prototype.h=function(){Ai.X.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Vi="closure_listenable_"+(1e6*Math.random()|0),G0=0;function z0(t,e,n,s,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!s,this.ha=r,this.key=++G0,this.ba=this.ea=!1}function Na(t){t.ba=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function ul(t,e,n){for(const s in t)e.call(n,t[s],s,t)}function Ip(t){const e={};for(const n in t)e[n]=t[n];return e}const Rf="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function bp(t,e){let n,s;for(let r=1;r<arguments.length;r++){s=arguments[r];for(n in s)t[n]=s[n];for(let i=0;i<Rf.length;i++)n=Rf[i],Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}}function ka(t){this.src=t,this.g={},this.h=0}ka.prototype.add=function(t,e,n,s,r){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=iu(t,e,s,r);return-1<o?(e=t[o],n||(e.ea=!1)):(e=new z0(e,this.src,i,!!s,r),e.ea=n,t.push(e)),e};function ru(t,e){var n=e.type;if(n in t.g){var s=t.g[n],r=wp(s,e),i;(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(Na(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function iu(t,e,n,s){for(var r=0;r<t.length;++r){var i=t[r];if(!i.ba&&i.listener==e&&i.capture==!!n&&i.ha==s)return r}return-1}var ll="closure_lm_"+(1e6*Math.random()|0),Nc={};function _p(t,e,n,s,r){if(s&&s.once)return Cp(t,e,n,s,r);if(Array.isArray(e)){for(var i=0;i<e.length;i++)_p(t,e[i],n,s,r);return null}return n=dl(n),t&&t[Vi]?t.N(e,n,Fi(s)?!!s.capture:!!s,r):Tp(t,e,n,!1,s,r)}function Tp(t,e,n,s,r,i){if(!e)throw Error("Invalid event type");var o=Fi(r)?!!r.capture:!!r,a=fl(t);if(a||(t[ll]=a=new ka(t)),n=a.add(e,n,s,o,i),n.proxy)return n;if(s=W0(),n.proxy=s,s.src=t,s.listener=n,t.addEventListener)V0||(r=o),r===void 0&&(r=!1),t.addEventListener(e.toString(),s,r);else if(t.attachEvent)t.attachEvent(Sp(e.toString()),s);else if(t.addListener&&t.removeListener)t.addListener(s);else throw Error("addEventListener and attachEvent are unavailable.");return n}function W0(){function t(n){return e.call(t.src,t.listener,n)}const e=Y0;return t}function Cp(t,e,n,s,r){if(Array.isArray(e)){for(var i=0;i<e.length;i++)Cp(t,e[i],n,s,r);return null}return n=dl(n),t&&t[Vi]?t.O(e,n,Fi(s)?!!s.capture:!!s,r):Tp(t,e,n,!0,s,r)}function xp(t,e,n,s,r){if(Array.isArray(e))for(var i=0;i<e.length;i++)xp(t,e[i],n,s,r);else s=Fi(s)?!!s.capture:!!s,n=dl(n),t&&t[Vi]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=iu(i,n,s,r),-1<n&&(Na(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=fl(t))&&(e=t.g[e.toString()],t=-1,e&&(t=iu(e,n,s,r)),(n=-1<t?e[t]:null)&&hl(n))}function hl(t){if(typeof t!="number"&&t&&!t.ba){var e=t.src;if(e&&e[Vi])ru(e.i,t);else{var n=t.type,s=t.proxy;e.removeEventListener?e.removeEventListener(n,s,t.capture):e.detachEvent?e.detachEvent(Sp(n),s):e.addListener&&e.removeListener&&e.removeListener(s),(n=fl(e))?(ru(n,t),n.h==0&&(n.src=null,e[ll]=null)):Na(t)}}}function Sp(t){return t in Nc?Nc[t]:Nc[t]="on"+t}function Y0(t,e){if(t.ba)t=!0;else{e=new Ai(e,this);var n=t.listener,s=t.ha||t.src;t.ea&&hl(t),t=n.call(s,e)}return t}function fl(t){return t=t[ll],t instanceof ka?t:null}var kc="__closure_events_fn_"+(1e9*Math.random()>>>0);function dl(t){return typeof t=="function"?t:(t[kc]||(t[kc]=function(e){return t.handleEvent(e)}),t[kc])}function He(){Ln.call(this),this.i=new ka(this),this.P=this,this.I=null}Ze(He,Ln);He.prototype[Vi]=!0;He.prototype.removeEventListener=function(t,e,n,s){xp(this,t,e,n,s)};function Je(t,e){var n,s=t.I;if(s)for(n=[];s;s=s.I)n.push(s);if(t=t.P,s=e.type||e,typeof e=="string")e=new st(e,t);else if(e instanceof st)e.target=e.target||t;else{var r=e;e=new st(s,t),bp(e,r)}if(r=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];r=yo(o,s,!0,e)&&r}if(o=e.g=t,r=yo(o,s,!0,e)&&r,r=yo(o,s,!1,e)&&r,n)for(i=0;i<n.length;i++)o=e.g=n[i],r=yo(o,s,!1,e)&&r}He.prototype.M=function(){if(He.X.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],s=0;s<n.length;s++)Na(n[s]);delete t.g[e],t.h--}}this.I=null};He.prototype.N=function(t,e,n,s){return this.i.add(String(t),e,!1,n,s)};He.prototype.O=function(t,e,n,s){return this.i.add(String(t),e,!0,n,s)};function yo(t,e,n,s){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var r=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ba&&o.capture==n){var a=o.listener,c=o.ha||o.src;o.ea&&ru(t.i,o),r=a.call(c,s)!==!1&&r}}return r&&!s.defaultPrevented}var gl=z.JSON.stringify;function J0(){var t=kp;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class X0{constructor(){this.h=this.g=null}add(e,n){const s=Dp.get();s.set(e,n),this.h?this.h.next=s:this.g=s,this.h=s}}var Dp=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new Z0,t=>t.reset());class Z0{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function e_(t){z.setTimeout(()=>{throw t},0)}function Np(t,e){ou||t_(),au||(ou(),au=!0),kp.add(t,e)}var ou;function t_(){var t=z.Promise.resolve(void 0);ou=function(){t.then(n_)}}var au=!1,kp=new X0;function n_(){for(var t;t=J0();){try{t.h.call(t.g)}catch(n){e_(n)}var e=Dp;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}au=!1}function Oa(t,e){He.call(this),this.h=t||1,this.g=e||z,this.j=nt(this.lb,this),this.l=Date.now()}Ze(Oa,He);U=Oa.prototype;U.ca=!1;U.R=null;U.lb=function(){if(this.ca){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-t):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Je(this,"tick"),this.ca&&(pl(this),this.start()))}};U.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function pl(t){t.ca=!1,t.R&&(t.g.clearTimeout(t.R),t.R=null)}U.M=function(){Oa.X.M.call(this),pl(this),delete this.g};function ml(t,e,n){if(typeof t=="function")n&&(t=nt(t,n));else if(t&&typeof t.handleEvent=="function")t=nt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:z.setTimeout(t,e||0)}function Op(t){t.g=ml(()=>{t.g=null,t.i&&(t.i=!1,Op(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class s_ extends Ln{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Op(this)}M(){super.M(),this.g&&(z.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vi(t){Ln.call(this),this.h=t,this.g={}}Ze(vi,Ln);var Mf=[];function Rp(t,e,n,s){Array.isArray(n)||(n&&(Mf[0]=n.toString()),n=Mf);for(var r=0;r<n.length;r++){var i=_p(e,n[r],s||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function Mp(t){ul(t.g,function(e,n){this.g.hasOwnProperty(n)&&hl(e)},t),t.g={}}vi.prototype.M=function(){vi.X.M.call(this),Mp(this)};vi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Ra(){this.g=!0}Ra.prototype.Aa=function(){this.g=!1};function r_(t,e,n,s,r,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&h[1]=="type"?o+(l+"="+u+"&"):o+(l+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+s+") [attempt "+r+"]: "+e+`
`+n+`
`+o})}function i_(t,e,n,s,r,i,o){t.info(function(){return"XMLHTTP RESP ("+s+") [ attempt "+r+"]: "+e+`
`+n+`
`+i+" "+o})}function Hs(t,e,n,s){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+a_(t,n)+(s?" "+s:"")})}function o_(t,e){t.info(function(){return"TIMEOUT: "+e})}Ra.prototype.info=function(){};function a_(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var s=n[t];if(!(2>s.length)){var r=s[1];if(Array.isArray(r)&&!(1>r.length)){var i=r[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<r.length;o++)r[o]=""}}}}return gl(n)}catch{return e}}var Cs={},Bf=null;function Ma(){return Bf=Bf||new He}Cs.Pa="serverreachability";function Bp(t){st.call(this,Cs.Pa,t)}Ze(Bp,st);function Ei(t){const e=Ma();Je(e,new Bp(e))}Cs.STAT_EVENT="statevent";function Pp(t,e){st.call(this,Cs.STAT_EVENT,t),this.stat=e}Ze(Pp,st);function lt(t){const e=Ma();Je(e,new Pp(e,t))}Cs.Qa="timingevent";function Lp(t,e){st.call(this,Cs.Qa,t),this.size=e}Ze(Lp,st);function $i(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return z.setTimeout(function(){t()},e)}var Ba={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},Fp={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function yl(){}yl.prototype.h=null;function Pf(t){return t.h||(t.h=t.i())}function Vp(){}var Ui={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function wl(){st.call(this,"d")}Ze(wl,st);function Al(){st.call(this,"c")}Ze(Al,st);var cu;function Pa(){}Ze(Pa,yl);Pa.prototype.g=function(){return new XMLHttpRequest};Pa.prototype.i=function(){return{}};cu=new Pa;function qi(t,e,n,s){this.l=t,this.j=e,this.m=n,this.U=s||1,this.S=new vi(this),this.O=c_,t=nu?125:void 0,this.T=new Oa(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new $p}function $p(){this.i=null,this.g="",this.h=!1}var c_=45e3,uu={},Wo={};U=qi.prototype;U.setTimeout=function(t){this.O=t};function lu(t,e,n){t.K=1,t.v=Fa(sn(e)),t.s=n,t.P=!0,Up(t,null)}function Up(t,e){t.F=Date.now(),ji(t),t.A=sn(t.v);var n=t.A,s=t.U;Array.isArray(s)||(s=[String(s)]),Wp(n.i,"t",s),t.C=0,n=t.l.H,t.h=new $p,t.g=mm(t.l,n?e:null,!t.s),0<t.N&&(t.L=new s_(nt(t.La,t,t.g),t.N)),Rp(t.S,t.g,"readystatechange",t.ib),e=t.H?Ip(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.da(t.A,t.u,t.s,e)):(t.u="GET",t.g.da(t.A,t.u,null,e)),Ei(),r_(t.j,t.u,t.A,t.m,t.U,t.s)}U.ib=function(t){t=t.target;const e=this.L;e&&Zt(t)==3?e.l():this.La(t)};U.La=function(t){try{if(t==this.g)e:{const l=Zt(this.g);var e=this.g.Ea();const h=this.g.aa();if(!(3>l)&&(l!=3||nu||this.g&&(this.h.h||this.g.fa()||$f(this.g)))){this.I||l!=4||e==7||(e==8||0>=h?Ei(3):Ei(2)),La(this);var n=this.g.aa();this.Y=n;t:if(qp(this)){var s=$f(this.g);t="";var r=s.length,i=Zt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){is(this),si(this);var o="";break t}this.h.i=new z.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(s[e],{stream:i&&e==r-1});s.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=n==200,i_(this.j,this.u,this.A,this.m,this.U,l,n),this.i){if(this.Z&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Go(a)){var u=a;break t}}u=null}if(n=u)Hs(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,hu(this,n);else{this.i=!1,this.o=3,lt(12),is(this),si(this);break e}}this.P?(jp(this,l,o),nu&&this.i&&l==3&&(Rp(this.S,this.T,"tick",this.hb),this.T.start())):(Hs(this.j,this.m,o,null),hu(this,o)),l==4&&is(this),this.i&&!this.I&&(l==4?fm(this.l,this):(this.i=!1,ji(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,lt(12)):(this.o=0,lt(13)),is(this),si(this)}}}catch{}finally{}};function qp(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Da:!1}function jp(t,e,n){let s=!0,r;for(;!t.I&&t.C<n.length;)if(r=u_(t,n),r==Wo){e==4&&(t.o=4,lt(14),s=!1),Hs(t.j,t.m,null,"[Incomplete Response]");break}else if(r==uu){t.o=4,lt(15),Hs(t.j,t.m,n,"[Invalid Chunk]"),s=!1;break}else Hs(t.j,t.m,r,null),hu(t,r);qp(t)&&r!=Wo&&r!=uu&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,lt(16),s=!1),t.i=t.i&&s,s?0<n.length&&!t.$&&(t.$=!0,e=t.l,e.g==t&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Cl(e),e.K=!0,lt(11))):(Hs(t.j,t.m,n,"[Invalid Chunked Response]"),is(t),si(t))}U.hb=function(){if(this.g){var t=Zt(this.g),e=this.g.fa();this.C<e.length&&(La(this),jp(this,t,e),this.i&&t!=4&&ji(this))}};function u_(t,e){var n=t.C,s=e.indexOf(`
`,n);return s==-1?Wo:(n=Number(e.substring(n,s)),isNaN(n)?uu:(s+=1,s+n>e.length?Wo:(e=e.substr(s,n),t.C=s+n,e)))}U.cancel=function(){this.I=!0,is(this)};function ji(t){t.V=Date.now()+t.O,Qp(t,t.O)}function Qp(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=$i(nt(t.gb,t),e)}function La(t){t.B&&(z.clearTimeout(t.B),t.B=null)}U.gb=function(){this.B=null;const t=Date.now();0<=t-this.V?(o_(this.j,this.A),this.K!=2&&(Ei(),lt(17)),is(this),this.o=2,si(this)):Qp(this,this.V-t)};function si(t){t.l.G==0||t.I||fm(t.l,t)}function is(t){La(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,pl(t.T),Mp(t.S),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function hu(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||fu(n.h,t))){if(!t.J&&fu(n.h,t)&&n.G==3){try{var s=n.Fa.g.parse(e)}catch{s=null}if(Array.isArray(s)&&s.length==3){var r=s;if(r[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)Xo(n),Ua(n);else break e;Tl(n),lt(18)}}else n.Ba=r[1],0<n.Ba-n.T&&37500>r[2]&&n.L&&n.A==0&&!n.v&&(n.v=$i(nt(n.cb,n),6e3));if(1>=Xp(n.h)&&n.ja){try{n.ja()}catch{}n.ja=void 0}}else os(n,11)}else if((t.J||n.g==t)&&Xo(n),!Go(e))for(r=n.Fa.g.parse(e),e=0;e<r.length;e++){let u=r[e];if(n.T=u[0],u=u[1],n.G==2)if(u[0]=="c"){n.I=u[1],n.ka=u[2];const l=u[3];l!=null&&(n.ma=l,n.j.info("VER="+n.ma));const h=u[4];h!=null&&(n.Ca=h,n.j.info("SVER="+n.Ca));const f=u[5];f!=null&&typeof f=="number"&&0<f&&(s=1.5*f,n.J=s,n.j.info("backChannelRequestTimeoutMs_="+s)),s=n;const g=t.g;if(g){const m=g.g?g.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(m){var i=s.h;i.g||m.indexOf("spdy")==-1&&m.indexOf("quic")==-1&&m.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(vl(i,i.h),i.h=null))}if(s.D){const v=g.g?g.g.getResponseHeader("X-HTTP-Session-Id"):null;v&&(s.za=v,be(s.F,s.D,v))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-t.F,n.j.info("Handshake RTT: "+n.P+"ms")),s=n;var o=t;if(s.sa=pm(s,s.H?s.ka:null,s.V),o.J){Zp(s.h,o);var a=o,c=s.J;c&&a.setTimeout(c),a.B&&(La(a),ji(a)),s.g=o}else lm(s);0<n.i.length&&qa(n)}else u[0]!="stop"&&u[0]!="close"||os(n,7);else n.G==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?os(n,7):_l(n):u[0]!="noop"&&n.l&&n.l.wa(u),n.A=0)}}Ei(4)}catch{}}function l_(t){if(t.W&&typeof t.W=="function")return t.W();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Sa(t)){for(var e=[],n=t.length,s=0;s<n;s++)e.push(t[s]);return e}e=[],n=0;for(s in t)e[n++]=t[s];return e}function h_(t){if(t.oa&&typeof t.oa=="function")return t.oa();if(!t.W||typeof t.W!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Sa(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const s in t)e[n++]=s;return e}}}function Hp(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Sa(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=h_(t),s=l_(t),r=s.length,i=0;i<r;i++)e.call(void 0,s[i],n&&n[i],t)}var Kp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function f_(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var s=t[n].indexOf("="),r=null;if(0<=s){var i=t[n].substring(0,s);r=t[n].substring(s+1)}else i=t[n];e(i,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function hs(t,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof hs){this.h=e!==void 0?e:t.h,Yo(this,t.j),this.s=t.s,this.g=t.g,Jo(this,t.m),this.l=t.l,e=t.i;var n=new Ii;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Lf(this,n),this.o=t.o}else t&&(n=String(t).match(Kp))?(this.h=!!e,Yo(this,n[1]||"",!0),this.s=zr(n[2]||""),this.g=zr(n[3]||"",!0),Jo(this,n[4]),this.l=zr(n[5]||"",!0),Lf(this,n[6]||"",!0),this.o=zr(n[7]||"")):(this.h=!!e,this.i=new Ii(null,this.h))}hs.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Wr(e,Ff,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Wr(e,Ff,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Wr(n,n.charAt(0)=="/"?p_:g_,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Wr(n,y_)),t.join("")};function sn(t){return new hs(t)}function Yo(t,e,n){t.j=n?zr(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Jo(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Lf(t,e,n){e instanceof Ii?(t.i=e,w_(t.i,t.h)):(n||(e=Wr(e,m_)),t.i=new Ii(e,t.h))}function be(t,e,n){t.i.set(e,n)}function Fa(t){return be(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function zr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Wr(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,d_),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function d_(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Ff=/[#\/\?@]/g,g_=/[#\?:]/g,p_=/[#\?]/g,m_=/[#\?@]/g,y_=/#/g;function Ii(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Fn(t){t.g||(t.g=new Map,t.h=0,t.i&&f_(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}U=Ii.prototype;U.add=function(t,e){Fn(this),this.i=null,t=Tr(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function Gp(t,e){Fn(t),e=Tr(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function zp(t,e){return Fn(t),e=Tr(t,e),t.g.has(e)}U.forEach=function(t,e){Fn(this),this.g.forEach(function(n,s){n.forEach(function(r){t.call(e,r,s,this)},this)},this)};U.oa=function(){Fn(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let s=0;s<e.length;s++){const r=t[s];for(let i=0;i<r.length;i++)n.push(e[s])}return n};U.W=function(t){Fn(this);let e=[];if(typeof t=="string")zp(this,t)&&(e=e.concat(this.g.get(Tr(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};U.set=function(t,e){return Fn(this),this.i=null,t=Tr(this,t),zp(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};U.get=function(t,e){return t?(t=this.W(t),0<t.length?String(t[0]):e):e};function Wp(t,e,n){Gp(t,e),0<n.length&&(t.i=null,t.g.set(Tr(t,e),al(n)),t.h+=n.length)}U.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var s=e[n];const i=encodeURIComponent(String(s)),o=this.W(s);for(s=0;s<o.length;s++){var r=i;o[s]!==""&&(r+="="+encodeURIComponent(String(o[s]))),t.push(r)}}return this.i=t.join("&")};function Tr(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function w_(t,e){e&&!t.j&&(Fn(t),t.i=null,t.g.forEach(function(n,s){var r=s.toLowerCase();s!=r&&(Gp(this,s),Wp(this,r,n))},t)),t.j=e}var A_=class{constructor(e,n){this.h=e,this.g=n}};function Yp(t){this.l=t||v_,z.PerformanceNavigationTiming?(t=z.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(z.g&&z.g.Ga&&z.g.Ga()&&z.g.Ga().$b),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var v_=10;function Jp(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function Xp(t){return t.h?1:t.g?t.g.size:0}function fu(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function vl(t,e){t.g?t.g.add(e):t.h=e}function Zp(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}Yp.prototype.cancel=function(){if(this.i=em(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function em(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return al(t.i)}function El(){}El.prototype.stringify=function(t){return z.JSON.stringify(t,void 0)};El.prototype.parse=function(t){return z.JSON.parse(t,void 0)};function E_(){this.g=new El}function I_(t,e,n){const s=n||"";try{Hp(t,function(r,i){let o=r;Fi(r)&&(o=gl(r)),e.push(s+i+"="+encodeURIComponent(o))})}catch(r){throw e.push(s+"type="+encodeURIComponent("_badmap")),r}}function b_(t,e){const n=new Ra;if(z.Image){const s=new Image;s.onload=mo(wo,n,s,"TestLoadImage: loaded",!0,e),s.onerror=mo(wo,n,s,"TestLoadImage: error",!1,e),s.onabort=mo(wo,n,s,"TestLoadImage: abort",!1,e),s.ontimeout=mo(wo,n,s,"TestLoadImage: timeout",!1,e),z.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=t}else e(!1)}function wo(t,e,n,s,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(s)}catch{}}function Qi(t){this.l=t.ac||null,this.j=t.jb||!1}Ze(Qi,yl);Qi.prototype.g=function(){return new Va(this.l,this.j)};Qi.prototype.i=function(t){return function(){return t}}({});function Va(t,e){He.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Il,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ze(Va,He);var Il=0;U=Va.prototype;U.open=function(t,e){if(this.readyState!=Il)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,bi(this)};U.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||z).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))};U.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Hi(this)),this.readyState=Il};U.Wa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,bi(this)),this.g&&(this.readyState=3,bi(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof z.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;tm(this)}else t.text().then(this.Va.bind(this),this.ga.bind(this))};function tm(t){t.j.read().then(t.Ta.bind(t)).catch(t.ga.bind(t))}U.Ta=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Hi(this):bi(this),this.readyState==3&&tm(this)}};U.Va=function(t){this.g&&(this.response=this.responseText=t,Hi(this))};U.Ua=function(t){this.g&&(this.response=t,Hi(this))};U.ga=function(){this.g&&Hi(this)};function Hi(t){t.readyState=4,t.l=null,t.j=null,t.A=null,bi(t)}U.setRequestHeader=function(t,e){this.v.append(t,e)};U.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};U.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function bi(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Va.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var __=z.JSON.parse;function De(t){He.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=nm,this.K=this.L=!1}Ze(De,He);var nm="",T_=/^https?$/i,C_=["POST","PUT"];U=De.prototype;U.Ka=function(t){this.L=t};U.da=function(t,e,n,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():cu.g(),this.C=this.u?Pf(this.u):Pf(cu),this.g.onreadystatechange=nt(this.Ha,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(i){Vf(this,i);return}if(t=n||"",n=new Map(this.headers),s)if(Object.getPrototypeOf(s)===Object.prototype)for(var r in s)n.set(r,s[r]);else if(typeof s.keys=="function"&&typeof s.get=="function")for(const i of s.keys())n.set(i,s.get(i));else throw Error("Unknown input type for opt_headers: "+String(s));s=Array.from(n.keys()).find(i=>i.toLowerCase()=="content-type"),r=z.FormData&&t instanceof z.FormData,!(0<=wp(C_,e))||s||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{im(this),0<this.B&&((this.K=x_(this.g))?(this.g.timeout=this.B,this.g.ontimeout=nt(this.qa,this)):this.A=ml(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){Vf(this,i)}};function x_(t){return ar&&Q0()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}U.qa=function(){typeof ol<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Je(this,"timeout"),this.abort(8))};function Vf(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,sm(t),$a(t)}function sm(t){t.D||(t.D=!0,Je(t,"complete"),Je(t,"error"))}U.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Je(this,"complete"),Je(this,"abort"),$a(this))};U.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),$a(this,!0)),De.X.M.call(this)};U.Ha=function(){this.s||(this.F||this.v||this.l?rm(this):this.fb())};U.fb=function(){rm(this)};function rm(t){if(t.h&&typeof ol<"u"&&(!t.C[1]||Zt(t)!=4||t.aa()!=2)){if(t.v&&Zt(t)==4)ml(t.Ha,0,t);else if(Je(t,"readystatechange"),Zt(t)==4){t.h=!1;try{const a=t.aa();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var s;if(s=a===0){var r=String(t.H).match(Kp)[1]||null;if(!r&&z.self&&z.self.location){var i=z.self.location.protocol;r=i.substr(0,i.length-1)}s=!T_.test(r?r.toLowerCase():"")}n=s}if(n)Je(t,"complete"),Je(t,"success");else{t.m=6;try{var o=2<Zt(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.aa()+"]",sm(t)}}finally{$a(t)}}}}function $a(t,e){if(t.g){im(t);const n=t.g,s=t.C[0]?Ko:null;t.g=null,t.C=null,e||Je(t,"ready");try{n.onreadystatechange=s}catch{}}}function im(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(z.clearTimeout(t.A),t.A=null)}function Zt(t){return t.g?t.g.readyState:0}U.aa=function(){try{return 2<Zt(this)?this.g.status:-1}catch{return-1}};U.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}};U.Sa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),__(e)}};function $f(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case nm:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}U.Ea=function(){return this.m};U.Oa=function(){return typeof this.j=="string"?this.j:String(this.j)};function om(t){let e="";return ul(t,function(n,s){e+=s,e+=":",e+=n,e+=`\r
`}),e}function bl(t,e,n){e:{for(s in n){var s=!1;break e}s=!0}s||(n=om(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):be(t,e,n))}function Vr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function am(t){this.Ca=0,this.i=[],this.j=new Ra,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=Vr("failFast",!1,t),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=Vr("baseRetryDelayMs",5e3,t),this.bb=Vr("retryDelaySeedMs",1e4,t),this.$a=Vr("forwardChannelMaxRetries",2,t),this.ta=Vr("forwardChannelRequestTimeoutMs",2e4,t),this.ra=t&&t.xmlHttpFactory||void 0,this.Da=t&&t.Zb||!1,this.J=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.I="",this.h=new Yp(t&&t.concurrentRequestLimit),this.Fa=new E_,this.O=t&&t.fastHandshake||!1,this.N=t&&t.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=t&&t.Xb||!1,t&&t.Aa&&this.j.Aa(),t&&t.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&t&&t.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}U=am.prototype;U.ma=8;U.G=1;function _l(t){if(cm(t),t.G==3){var e=t.U++,n=sn(t.F);be(n,"SID",t.I),be(n,"RID",e),be(n,"TYPE","terminate"),Ki(t,n),e=new qi(t,t.j,e,void 0),e.K=2,e.v=Fa(sn(n)),n=!1,z.navigator&&z.navigator.sendBeacon&&(n=z.navigator.sendBeacon(e.v.toString(),"")),!n&&z.Image&&(new Image().src=e.v,n=!0),n||(e.g=mm(e.l,null),e.g.da(e.v)),e.F=Date.now(),ji(e)}gm(t)}function Ua(t){t.g&&(Cl(t),t.g.cancel(),t.g=null)}function cm(t){Ua(t),t.u&&(z.clearTimeout(t.u),t.u=null),Xo(t),t.h.cancel(),t.m&&(typeof t.m=="number"&&z.clearTimeout(t.m),t.m=null)}function qa(t){Jp(t.h)||t.m||(t.m=!0,Np(t.Ja,t),t.C=0)}function S_(t,e){return Xp(t.h)>=t.h.j-(t.m?1:0)?!1:t.m?(t.i=e.D.concat(t.i),!0):t.G==1||t.G==2||t.C>=(t.Za?0:t.$a)?!1:(t.m=$i(nt(t.Ja,t,e),dm(t,t.C)),t.C++,!0)}U.Ja=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const r=new qi(this,this.j,t,void 0);let i=this.s;if(this.S&&(i?(i=Ip(i),bp(i,this.S)):i=this.S),this.o!==null||this.N||(r.H=i,i=null),this.O)e:{for(var e=0,n=0;n<this.i.length;n++){t:{var s=this.i[n];if("__data__"in s.g&&(s=s.g.__data__,typeof s=="string")){s=s.length;break t}s=void 0}if(s===void 0)break;if(e+=s,4096<e){e=n;break e}if(e===4096||n===this.i.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=um(this,r,e),n=sn(this.F),be(n,"RID",t),be(n,"CVER",22),this.D&&be(n,"X-HTTP-Session-Id",this.D),Ki(this,n),i&&(this.N?e="headers="+encodeURIComponent(String(om(i)))+"&"+e:this.o&&bl(n,this.o,i)),vl(this.h,r),this.Ya&&be(n,"TYPE","init"),this.O?(be(n,"$req",e),be(n,"SID","null"),r.Z=!0,lu(r,n,null)):lu(r,n,e),this.G=2}}else this.G==3&&(t?Uf(this,t):this.i.length==0||Jp(this.h)||Uf(this))};function Uf(t,e){var n;e?n=e.m:n=t.U++;const s=sn(t.F);be(s,"SID",t.I),be(s,"RID",n),be(s,"AID",t.T),Ki(t,s),t.o&&t.s&&bl(s,t.o,t.s),n=new qi(t,t.j,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.i=e.D.concat(t.i)),e=um(t,n,1e3),n.setTimeout(Math.round(.5*t.ta)+Math.round(.5*t.ta*Math.random())),vl(t.h,n),lu(n,s,e)}function Ki(t,e){t.ia&&ul(t.ia,function(n,s){be(e,s,n)}),t.l&&Hp({},function(n,s){be(e,s,n)})}function um(t,e,n){n=Math.min(t.i.length,n);var s=t.l?nt(t.l.Ra,t.l,t):null;e:{var r=t.i;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=r[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<n;c++){let u=r[c].h;const l=r[c].g;if(u-=i,0>u)i=Math.max(0,r[c].h-100),a=!1;else try{I_(l,o,"req"+u+"_")}catch{s&&s(l)}}if(a){s=o.join("&");break e}}}return t=t.i.splice(0,n),e.D=t,s}function lm(t){t.g||t.u||(t.Z=1,Np(t.Ia,t),t.A=0)}function Tl(t){return t.g||t.u||3<=t.A?!1:(t.Z++,t.u=$i(nt(t.Ia,t),dm(t,t.A)),t.A++,!0)}U.Ia=function(){if(this.u=null,hm(this),this.$&&!(this.K||this.g==null||0>=this.P)){var t=2*this.P;this.j.info("BP detection timer enabled: "+t),this.B=$i(nt(this.eb,this),t)}};U.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,lt(10),Ua(this),hm(this))};function Cl(t){t.B!=null&&(z.clearTimeout(t.B),t.B=null)}function hm(t){t.g=new qi(t,t.j,"rpc",t.Z),t.o===null&&(t.g.H=t.s),t.g.N=0;var e=sn(t.sa);be(e,"RID","rpc"),be(e,"SID",t.I),be(e,"CI",t.L?"0":"1"),be(e,"AID",t.T),be(e,"TYPE","xmlhttp"),Ki(t,e),t.o&&t.s&&bl(e,t.o,t.s),t.J&&t.g.setTimeout(t.J);var n=t.g;t=t.ka,n.K=1,n.v=Fa(sn(e)),n.s=null,n.P=!0,Up(n,t)}U.cb=function(){this.v!=null&&(this.v=null,Ua(this),Tl(this),lt(19))};function Xo(t){t.v!=null&&(z.clearTimeout(t.v),t.v=null)}function fm(t,e){var n=null;if(t.g==e){Xo(t),Cl(t),t.g=null;var s=2}else if(fu(t.h,e))n=e.D,Zp(t.h,e),s=1;else return;if(t.G!=0){if(t.pa=e.Y,e.i)if(s==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var r=t.C;s=Ma(),Je(s,new Lp(s,n)),qa(t)}else lm(t);else if(r=e.o,r==3||r==0&&0<t.pa||!(s==1&&S_(t,e)||s==2&&Tl(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),r){case 1:os(t,5);break;case 4:os(t,10);break;case 3:os(t,6);break;default:os(t,2)}}}function dm(t,e){let n=t.Xa+Math.floor(Math.random()*t.bb);return t.l||(n*=2),n*e}function os(t,e){if(t.j.info("Error code "+e),e==2){var n=null;t.l&&(n=null);var s=nt(t.kb,t);n||(n=new hs("//www.google.com/images/cleardot.gif"),z.location&&z.location.protocol=="http"||Yo(n,"https"),Fa(n)),b_(n.toString(),s)}else lt(2);t.G=0,t.l&&t.l.va(e),gm(t),cm(t)}U.kb=function(t){t?(this.j.info("Successfully pinged google.com"),lt(2)):(this.j.info("Failed to ping google.com"),lt(1))};function gm(t){if(t.G=0,t.la=[],t.l){const e=em(t.h);(e.length!=0||t.i.length!=0)&&(Nf(t.la,e),Nf(t.la,t.i),t.h.i.length=0,al(t.i),t.i.length=0),t.l.ua()}}function pm(t,e,n){var s=n instanceof hs?sn(n):new hs(n,void 0);if(s.g!="")e&&(s.g=e+"."+s.g),Jo(s,s.m);else{var r=z.location;s=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var i=new hs(null,void 0);s&&Yo(i,s),e&&(i.g=e),r&&Jo(i,r),n&&(i.l=n),s=i}return n=t.D,e=t.za,n&&e&&be(s,n,e),be(s,"VER",t.ma),Ki(t,s),s}function mm(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Da&&!t.ra?new De(new Qi({jb:!0})):new De(t.ra),e.Ka(t.H),e}function ym(){}U=ym.prototype;U.xa=function(){};U.wa=function(){};U.va=function(){};U.ua=function(){};U.Ra=function(){};function Zo(){if(ar&&!(10<=Number(H0)))throw Error("Environmental error: no available transport.")}Zo.prototype.g=function(t,e){return new bt(t,e)};function bt(t,e){He.call(this),this.g=new am(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.S=t,(t=e&&e.Yb)&&!Go(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Go(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Cr(this)}Ze(bt,He);bt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;lt(0),t.V=e,t.ia=n||{},t.L=t.Y,t.F=pm(t,null,t.V),qa(t)};bt.prototype.close=function(){_l(this.g)};bt.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=gl(t),t=n);e.i.push(new A_(e.ab++,t)),e.G==3&&qa(e)};bt.prototype.M=function(){this.g.l=null,delete this.j,_l(this.g),delete this.g,bt.X.M.call(this)};function wm(t){wl.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Ze(wm,wl);function Am(){Al.call(this),this.status=1}Ze(Am,Al);function Cr(t){this.g=t}Ze(Cr,ym);Cr.prototype.xa=function(){Je(this.g,"a")};Cr.prototype.wa=function(t){Je(this.g,new wm(t))};Cr.prototype.va=function(t){Je(this.g,new Am)};Cr.prototype.ua=function(){Je(this.g,"b")};Zo.prototype.createWebChannel=Zo.prototype.g;bt.prototype.send=bt.prototype.u;bt.prototype.open=bt.prototype.m;bt.prototype.close=bt.prototype.close;Ba.NO_ERROR=0;Ba.TIMEOUT=8;Ba.HTTP_ERROR=6;Fp.COMPLETE="complete";Vp.EventType=Ui;Ui.OPEN="a";Ui.CLOSE="b";Ui.ERROR="c";Ui.MESSAGE="d";He.prototype.listen=He.prototype.N;De.prototype.listenOnce=De.prototype.O;De.prototype.getLastError=De.prototype.Oa;De.prototype.getLastErrorCode=De.prototype.Ea;De.prototype.getStatus=De.prototype.aa;De.prototype.getResponseJson=De.prototype.Sa;De.prototype.getResponseText=De.prototype.fa;De.prototype.send=De.prototype.da;De.prototype.setWithCredentials=De.prototype.Ka;var D_=function(){return new Zo},N_=function(){return Ma()},Oc=Ba,k_=Fp,O_=Cs,qf={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},R_=Qi,Ao=Vp,M_=De;const jf="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}qe.UNAUTHENTICATED=new qe(null),qe.GOOGLE_CREDENTIALS=new qe("google-credentials-uid"),qe.FIRST_PARTY=new qe("first-party-uid"),qe.MOCK_USER=new qe("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xr="9.15.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dn=new nl("@firebase/firestore");function du(){return Dn.logLevel}function B_(t){Dn.setLogLevel(t)}function T(t,...e){if(Dn.logLevel<=le.DEBUG){const n=e.map(xl);Dn.debug(`Firestore (${xr}): ${t}`,...n)}}function Oe(t,...e){if(Dn.logLevel<=le.ERROR){const n=e.map(xl);Dn.error(`Firestore (${xr}): ${t}`,...n)}}function cr(t,...e){if(Dn.logLevel<=le.WARN){const n=e.map(xl);Dn.warn(`Firestore (${xr}): ${t}`,...n)}}function xl(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L(t="Unexpected state"){const e=`FIRESTORE (${xr}) INTERNAL ASSERTION FAILED: `+t;throw Oe(e),new Error(e)}function q(t,e){t||L()}function P_(t,e){t||L()}function R(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class b extends Ts{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class L_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(qe.UNAUTHENTICATED))}shutdown(){}}class F_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class V_{constructor(e){this.t=e,this.currentUser=qe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let s=this.i;const r=c=>this.i!==s?(s=this.i,n(c)):Promise.resolve();let i=new Qe;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Qe,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await r(this.currentUser)})},a=c=>{T("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(T("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Qe)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(T("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(q(typeof s.accessToken=="string"),new vm(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return q(e===null||typeof e=="string"),new qe(e)}}class $_{constructor(e,n,s,r){this.h=e,this.l=n,this.m=s,this.g=r,this.type="FirstParty",this.user=qe.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(q(!(typeof this.h!="object"||this.h===null||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class U_{constructor(e,n,s,r){this.h=e,this.l=n,this.m=s,this.g=r}getToken(){return Promise.resolve(new $_(this.h,this.l,this.m,this.g))}start(e,n){e.enqueueRetryable(()=>n(qe.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class q_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class j_{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,n){const s=i=>{i.error!=null&&T("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.A;return this.A=i.token,T("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{T("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.T.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.T.getImmediate({optional:!0});i?r(i):T("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(q(typeof n.token=="string"),this.A=n.token,new q_(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q_(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const r=Q_(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%e.length))}return s}}function Y(t,e){return t<e?-1:t>e?1:0}function ur(t,e,n){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}function Im(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new b(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new b(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new b(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new b(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Te.fromMillis(Date.now())}static fromDate(e){return Te.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*n));return new Te(n,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j{constructor(e){this.timestamp=e}static fromTimestamp(e){return new j(e)}static min(){return new j(new Te(0,0))}static max(){return new j(new Te(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e,n,s){n===void 0?n=0:n>e.length&&L(),s===void 0?s=e.length-n:s>e.length-n&&L(),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return _i.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof _i?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const i=e.get(r),o=n.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class oe extends _i{construct(e,n,s){return new oe(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new b(w.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(r=>r.length>0))}return new oe(n)}static emptyPath(){return new oe([])}}const H_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Re extends _i{construct(e,n,s){return new Re(e,n,s)}static isValidIdentifier(e){return H_.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Re.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Re(["__name__"])}static fromServerFormat(e){const n=[];let s="",r=0;const i=()=>{if(s.length===0)throw new b(w.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new b(w.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new b(w.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(s+=a,r++):(i(),r++)}if(i(),o)throw new b(w.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Re(n)}static emptyPath(){return new Re([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k{constructor(e){this.path=e}static fromPath(e){return new k(oe.fromString(e))}static fromName(e){return new k(oe.fromString(e).popFirst(5))}static empty(){return new k(oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return oe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new k(new oe(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(e,n,s,r){this.indexId=e,this.collectionGroup=n,this.fields=s,this.indexState=r}}function gu(t){return t.fields.find(e=>e.kind===2)}function Yn(t){return t.fields.filter(e=>e.kind!==2)}bm.UNKNOWN_ID=-1;class K_{constructor(e,n){this.fieldPath=e,this.kind=n}}class ea{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new ea(0,_t.min())}}function _m(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=j.fromTimestamp(s===1e9?new Te(n+1,0):new Te(n,s));return new _t(r,k.empty(),e)}function Tm(t){return new _t(t.readTime,t.key,-1)}class _t{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new _t(j.min(),k.empty(),-1)}static max(){return new _t(j.max(),k.empty(),-1)}}function Sl(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=k.comparator(t.documentKey,e.documentKey),n!==0?n:Y(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cm="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xm{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vn(t){if(t.code!==w.FAILED_PRECONDITION||t.message!==Cm)throw t;T("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&L(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new y((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(n,i).next(s,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof y?n:y.resolve(n)}catch(n){return y.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):y.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):y.reject(n)}static resolve(e){return new y((n,s)=>{n(e)})}static reject(e){return new y((n,s)=>{s(e)})}static waitFor(e){return new y((n,s)=>{let r=0,i=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++i,o&&i===r&&n()},c=>s(c))}),o=!0,i===r&&n()})}static or(e){let n=y.resolve(!1);for(const s of e)n=n.next(r=>r?y.resolve(r):s());return n}static forEach(e,n){const s=[];return e.forEach((r,i)=>{s.push(n.call(this,r,i))}),this.waitFor(s)}static mapArray(e,n){return new y((s,r)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(l=>{o[u]=l,++a,a===i&&s(o)},l=>r(l))}})}static doWhile(e,n){return new y((s,r)=>{const i=()=>{e()===!0?n().next(()=>{i()},r):s()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.P=new Qe,this.transaction.oncomplete=()=>{this.P.resolve()},this.transaction.onabort=()=>{n.error?this.P.reject(new ri(e,n.error)):this.P.resolve()},this.transaction.onerror=s=>{const r=Dl(s.target.error);this.P.reject(new ri(e,r))}}static open(e,n,s,r){try{return new ja(n,e.transaction(r,s))}catch(i){throw new ri(n,i)}}get v(){return this.P.promise}abort(e){e&&this.P.reject(e),this.aborted||(T("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new z_(n)}}class Ot{constructor(e,n,s){this.name=e,this.version=n,this.S=s,Ot.D(Jc())===12.2&&Oe("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return T("SimpleDb","Removing database:",e),es(window.indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!op())return!1;if(Ot.N())return!0;const e=Jc(),n=Ot.D(e),s=0<n&&n<10,r=Ot.k(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||i)}static N(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.O)==="YES"}static M(e,n){return e.store(n)}static D(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(s)}static k(e){const n=e.match(/Android ([\d.]+)/i),s=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(s)}async F(e){return this.db||(T("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,s)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=i=>{const o=i.target.result;n(o)},r.onblocked=()=>{s(new ri(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=i=>{const o=i.target.error;o.name==="VersionError"?s(new b(w.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?s(new b(w.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):s(new ri(e,o))},r.onupgradeneeded=i=>{T("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.S.$(o,r.transaction,i.oldVersion,this.version).next(()=>{T("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,s,r){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.F(e);const a=ja.open(this.db,e,i?"readonly":"readwrite",s),c=r(a).next(u=>(a.V(),u)).catch(u=>(a.abort(u),y.reject(u))).toPromise();return c.catch(()=>{}),await a.v,c}catch(a){const c=a,u=c.name!=="FirebaseError"&&o<3;if(T("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}class G_{constructor(e){this.q=e,this.U=!1,this.K=null}get isDone(){return this.U}get G(){return this.K}set cursor(e){this.q=e}done(){this.U=!0}j(e){this.K=e}delete(){return es(this.q.delete())}}class ri extends b{constructor(e,n){super(w.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function $n(t){return t.name==="IndexedDbTransactionError"}class z_{constructor(e){this.store=e}put(e,n){let s;return n!==void 0?(T("SimpleDb","PUT",this.store.name,e,n),s=this.store.put(n,e)):(T("SimpleDb","PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),es(s)}add(e){return T("SimpleDb","ADD",this.store.name,e,e),es(this.store.add(e))}get(e){return es(this.store.get(e)).next(n=>(n===void 0&&(n=null),T("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return T("SimpleDb","DELETE",this.store.name,e),es(this.store.delete(e))}count(){return T("SimpleDb","COUNT",this.store.name),es(this.store.count())}W(e,n){const s=this.options(e,n);if(s.index||typeof this.store.getAll!="function"){const r=this.cursor(s),i=[];return this.H(r,(o,a)=>{i.push(a)}).next(()=>i)}{const r=this.store.getAll(s.range);return new y((i,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}}J(e,n){const s=this.store.getAll(e,n===null?void 0:n);return new y((r,i)=>{s.onerror=o=>{i(o.target.error)},s.onsuccess=o=>{r(o.target.result)}})}Y(e,n){T("SimpleDb","DELETE ALL",this.store.name);const s=this.options(e,n);s.X=!1;const r=this.cursor(s);return this.H(r,(i,o,a)=>a.delete())}Z(e,n){let s;n?s=e:(s={},n=e);const r=this.cursor(s);return this.H(r,n)}tt(e){const n=this.cursor({});return new y((s,r)=>{n.onerror=i=>{const o=Dl(i.target.error);r(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():s()}):s()}})}H(e,n){const s=[];return new y((r,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const c=new G_(a),u=n(a.primaryKey,a.value,c);if(u instanceof y){const l=u.catch(h=>(c.done(),y.reject(h)));s.push(l)}c.isDone?r():c.G===null?a.continue():a.continue(c.G)}}).next(()=>y.waitFor(s))}options(e,n){let s;return e!==void 0&&(typeof e=="string"?s=e:n=e),{index:s,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const s=this.store.index(e.index);return e.X?s.openKeyCursor(e.range,n):s.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function es(t){return new y((e,n)=>{t.onsuccess=s=>{const r=s.target.result;e(r)},t.onerror=s=>{const r=Dl(s.target.error);n(r)}})}let Qf=!1;function Dl(t){const e=Ot.D(Jc());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const s=new b("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Qf||(Qf=!0,setTimeout(()=>{throw s},0)),s}}return t}class W_{constructor(e,n){this.asyncQueue=e,this.et=n,this.task=null}start(){this.nt(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}nt(e){T("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{T("IndexBackiller",`Documents written: ${await this.et.st()}`)}catch(n){$n(n)?T("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await Vn(n)}await this.nt(6e4)})}}class Y_{constructor(e,n){this.localStore=e,this.persistence=n}async st(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.it(n,e))}it(e,n){const s=new Set;let r=n,i=!0;return y.doWhile(()=>i===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!s.has(o))return T("IndexBackiller",`Processing collection: ${o}`),this.rt(e,o,r).next(a=>{r-=a,s.add(o)});i=!1})).next(()=>n-r)}rt(e,n,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(r=>this.localStore.localDocuments.getNextDocuments(e,n,r,s).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ot(r,i)).next(a=>(T("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ot(e,n){let s=e;return n.changes.forEach((r,i)=>{const o=Tm(i);Sl(o,s)>0&&(s=o)}),new _t(s.readTime,s.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ut(s),this.ct=s=>n.writeSequenceNumber(s))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}mt.at=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_{constructor(e,n,s,r,i,o,a,c){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=c}}class Nn{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Nn("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Nn&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hf(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function xs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Sm(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gi(t){return t==null}function Ti(t){return t===0&&1/t==-1/0}function Dm(t){return typeof t=="number"&&Number.isInteger(t)&&!Ti(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X_(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new $e(n)}static fromUint8Array(e){const n=function(s){let r="";for(let i=0;i<s.length;++i)r+=String.fromCharCode(s[i]);return r}(e);return new $e(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Y(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}$e.EMPTY_BYTE_STRING=new $e("");const Z_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function kn(t){if(q(!!t),typeof t=="string"){let e=0;const n=Z_.exec(t);if(q(!!n),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Se(t.seconds),nanos:Se(t.nanos)}}function Se(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ps(t){return typeof t=="string"?$e.fromBase64String(t):$e.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nl(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Nm(t){const e=t.mapValue.fields.__previous_value__;return Nl(e)?Nm(e):e}function Ci(t){const e=kn(t.mapValue.fields.__local_write_time__.timestampValue);return new Te(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ko={nullValue:"NULL_VALUE"};function ms(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Nl(t)?4:km(t)?9007199254740991:10:L()}function Wt(t,e){if(t===e)return!0;const n=ms(t);if(n!==ms(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ci(t).isEqual(Ci(e));case 3:return function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const i=kn(s.timestampValue),o=kn(r.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,r){return ps(s.bytesValue).isEqual(ps(r.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,r){return Se(s.geoPointValue.latitude)===Se(r.geoPointValue.latitude)&&Se(s.geoPointValue.longitude)===Se(r.geoPointValue.longitude)}(t,e);case 2:return function(s,r){if("integerValue"in s&&"integerValue"in r)return Se(s.integerValue)===Se(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const i=Se(s.doubleValue),o=Se(r.doubleValue);return i===o?Ti(i)===Ti(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return ur(t.arrayValue.values||[],e.arrayValue.values||[],Wt);case 10:return function(s,r){const i=s.mapValue.fields||{},o=r.mapValue.fields||{};if(Hf(i)!==Hf(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!Wt(i[a],o[a])))return!1;return!0}(t,e);default:return L()}}function xi(t,e){return(t.values||[]).find(n=>Wt(n,e))!==void 0}function On(t,e){if(t===e)return 0;const n=ms(t),s=ms(e);if(n!==s)return Y(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return Y(t.booleanValue,e.booleanValue);case 2:return function(r,i){const o=Se(r.integerValue||r.doubleValue),a=Se(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return Kf(t.timestampValue,e.timestampValue);case 4:return Kf(Ci(t),Ci(e));case 5:return Y(t.stringValue,e.stringValue);case 6:return function(r,i){const o=ps(r),a=ps(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(r,i){const o=r.split("/"),a=i.split("/");for(let c=0;c<o.length&&c<a.length;c++){const u=Y(o[c],a[c]);if(u!==0)return u}return Y(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(r,i){const o=Y(Se(r.latitude),Se(i.latitude));return o!==0?o:Y(Se(r.longitude),Se(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(r,i){const o=r.values||[],a=i.values||[];for(let c=0;c<o.length&&c<a.length;++c){const u=On(o[c],a[c]);if(u)return u}return Y(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(r,i){if(r===vn.mapValue&&i===vn.mapValue)return 0;if(r===vn.mapValue)return 1;if(i===vn.mapValue)return-1;const o=r.fields||{},a=Object.keys(o),c=i.fields||{},u=Object.keys(c);a.sort(),u.sort();for(let l=0;l<a.length&&l<u.length;++l){const h=Y(a[l],u[l]);if(h!==0)return h;const f=On(o[a[l]],c[u[l]]);if(f!==0)return f}return Y(a.length,u.length)}(t.mapValue,e.mapValue);default:throw L()}}function Kf(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Y(t,e);const n=kn(t),s=kn(e),r=Y(n.seconds,s.seconds);return r!==0?r:Y(n.nanos,s.nanos)}function lr(t){return pu(t)}function pu(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(s){const r=kn(s);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?ps(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,k.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(s){let r="[",i=!0;for(const o of s.values||[])i?i=!1:r+=",",r+=pu(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(s){const r=Object.keys(s.fields||{}).sort();let i="{",o=!0;for(const a of r)o?o=!1:i+=",",i+=`${a}:${pu(s.fields[a])}`;return i+"}"}(t.mapValue):L();var e,n}function ys(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function mu(t){return!!t&&"integerValue"in t}function Si(t){return!!t&&"arrayValue"in t}function Gf(t){return!!t&&"nullValue"in t}function zf(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Oo(t){return!!t&&"mapValue"in t}function ii(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return xs(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=ii(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ii(t.arrayValue.values[n]);return e}return Object.assign({},t)}function km(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function eT(t){return"nullValue"in t?ko:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ys(Nn.empty(),k.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:L()}function tT(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ys(Nn.empty(),k.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?vn:L()}function Wf(t,e){const n=On(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function Yf(t,e){const n=On(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e,n){this.position=e,this.inclusive=n}}function Jf(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],o=t.position[r];if(i.field.isKeyField()?s=k.comparator(k.fromName(o.referenceValue),n.key):s=On(o,n.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function Xf(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Wt(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{}class se extends Om{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new nT(e,n,s):n==="array-contains"?new iT(e,s):n==="in"?new $m(e,s):n==="not-in"?new oT(e,s):n==="array-contains-any"?new aT(e,s):new se(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new sT(e,s):new rT(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(On(n,this.value)):n!==null&&ms(this.value)===ms(n)&&this.matchesComparison(On(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return L()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class de extends Om{constructor(e,n){super(),this.filters=e,this.op=n,this.ht=null}static create(e,n){return new de(e,n)}matches(e){return hr(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ht!==null||(this.ht=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.lt(n=>n.isInequality());return e!==null?e.field:null}lt(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function hr(t){return t.op==="and"}function yu(t){return t.op==="or"}function Rm(t){return Mm(t)&&hr(t)}function Mm(t){for(const e of t.filters)if(e instanceof de)return!1;return!0}function Bm(t){if(t instanceof se)return t.field.canonicalString()+t.op.toString()+lr(t.value);{const e=t.filters.map(n=>Bm(n)).join(",");return`${t.op}(${e})`}}function Pm(t,e){return t instanceof se?function(n,s){return s instanceof se&&n.op===s.op&&n.field.isEqual(s.field)&&Wt(n.value,s.value)}(t,e):t instanceof de?function(n,s){return s instanceof de&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((r,i,o)=>r&&Pm(i,s.filters[o]),!0):!1}(t,e):void L()}function Lm(t,e){const n=t.filters.concat(e);return de.create(n,t.op)}function Fm(t){return t instanceof se?function(e){return`${e.field.canonicalString()} ${e.op} ${lr(e.value)}`}(t):t instanceof de?function(e){return e.op.toString()+" {"+e.getFilters().map(Fm).join(" ,")+"}"}(t):"Filter"}class nT extends se{constructor(e,n,s){super(e,n,s),this.key=k.fromName(s.referenceValue)}matches(e){const n=k.comparator(e.key,this.key);return this.matchesComparison(n)}}class sT extends se{constructor(e,n){super(e,"in",n),this.keys=Vm("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class rT extends se{constructor(e,n){super(e,"not-in",n),this.keys=Vm("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Vm(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(s=>k.fromName(s.referenceValue))}class iT extends se{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Si(n)&&xi(n.arrayValue,this.value)}}class $m extends se{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&xi(this.value.arrayValue,n)}}class oT extends se{constructor(e,n){super(e,"not-in",n)}matches(e){if(xi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!xi(this.value.arrayValue,n)}}class aT extends se{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Si(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>xi(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e,n="asc"){this.field=e,this.dir=n}}function cT(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e,n){this.comparator=e,this.root=n||ze.EMPTY}insert(e,n){return new Ne(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ze.BLACK,null,null))}remove(e){return new Ne(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ze.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vo(this.root,e,this.comparator,!1)}getReverseIterator(){return new vo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vo(this.root,e,this.comparator,!0)}}class vo{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?s(e.key,n):1,n&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ze{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s??ze.RED,this.left=r??ze.EMPTY,this.right=i??ze.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,i){return new ze(e??this.key,n??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ze.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return ze.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ze.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ze.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw L();const e=this.left.check();if(e!==this.right.check())throw L();return e+(this.isRed()?0:1)}}ze.EMPTY=null,ze.RED=!0,ze.BLACK=!1;ze.EMPTY=new class{constructor(){this.size=0}get key(){throw L()}get value(){throw L()}get color(){throw L()}get left(){throw L()}get right(){throw L()}copy(t,e,n,s,r){return this}insert(t,e,n){return new ze(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e){this.comparator=e,this.data=new Ne(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Zf(this.data.getIterator())}getIteratorFrom(e){return new Zf(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof me)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new me(this.comparator);return n.data=e,n}}class Zf{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ls(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.fields=e,e.sort(Re.comparator)}static empty(){return new Et([])}unionWith(e){let n=new me(Re.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new Et(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ur(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.value=e}static empty(){return new Ye({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!Oo(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ii(n)}setAll(e){let n=Re.emptyPath(),s={},r=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,s,r),s={},r=[],n=a.popLast()}o?s[a.lastSegment()]=ii(o):r.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,s,r)}delete(e){const n=this.field(e.popLast());Oo(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Wt(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];Oo(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){xs(n,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new Ye(ii(this.value))}}function Um(t){const e=[];return xs(t.fields,(n,s)=>{const r=new Re([n]);if(Oo(s)){const i=Um(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new Et(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e,n,s,r,i,o,a){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new ve(e,0,j.min(),j.min(),j.min(),Ye.empty(),0)}static newFoundDocument(e,n,s,r){return new ve(e,1,n,j.min(),s,r,0)}static newNoDocument(e,n){return new ve(e,2,n,j.min(),j.min(),Ye.empty(),0)}static newUnknownDocument(e,n){return new ve(e,3,n,j.min(),j.min(),Ye.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(j.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ye.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ye.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=j.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ve&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ve(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{constructor(e,n=null,s=[],r=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.ft=null}}function wu(t,e=null,n=[],s=[],r=null,i=null,o=null){return new uT(t,e,n,s,r,i,o)}function ws(t){const e=R(t);if(e.ft===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>Bm(s)).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(r){return r.field.canonicalString()+r.dir}(s)).join(","),Gi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>lr(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>lr(s)).join(",")),e.ft=n}return e.ft}function zi(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!cT(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Pm(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Xf(t.startAt,e.startAt)&&Xf(t.endAt,e.endAt)}function ta(t){return k.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function na(t,e){return t.filters.filter(n=>n instanceof se&&n.field.isEqual(e))}function ed(t,e,n){let s=ko,r=!0;for(const i of na(t,e)){let o=ko,a=!0;switch(i.op){case"<":case"<=":o=eT(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=ko}Wf({value:s,inclusive:r},{value:o,inclusive:a})<0&&(s=o,r=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];Wf({value:s,inclusive:r},{value:o,inclusive:n.inclusive})<0&&(s=o,r=n.inclusive);break}}return{value:s,inclusive:r}}function td(t,e,n){let s=vn,r=!0;for(const i of na(t,e)){let o=vn,a=!0;switch(i.op){case">=":case">":o=tT(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=vn}Yf({value:s,inclusive:r},{value:o,inclusive:a})>0&&(s=o,r=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];Yf({value:s,inclusive:r},{value:o,inclusive:n.inclusive})>0&&(s=o,r=n.inclusive);break}}return{value:s,inclusive:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e,n=null,s=[],r=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.dt=null,this._t=null,this.startAt,this.endAt}}function qm(t,e,n,s,r,i,o,a){return new an(t,e,n,s,r,i,o,a)}function Sr(t){return new an(t)}function nd(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function kl(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Qa(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(n!==null)return n}return null}function Ol(t){return t.collectionGroup!==null}function fs(t){const e=R(t);if(e.dt===null){e.dt=[];const n=Qa(e),s=kl(e);if(n!==null&&s===null)n.isKeyField()||e.dt.push(new Js(n)),e.dt.push(new Js(Re.keyField(),"asc"));else{let r=!1;for(const i of e.explicitOrderBy)e.dt.push(i),i.field.isKeyField()&&(r=!0);if(!r){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.dt.push(new Js(Re.keyField(),i))}}}return e.dt}function wt(t){const e=R(t);if(!e._t)if(e.limitType==="F")e._t=wu(e.path,e.collectionGroup,fs(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of fs(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new Js(i.field,o))}const s=e.endAt?new Rn(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Rn(e.startAt.position,e.startAt.inclusive):null;e._t=wu(e.path,e.collectionGroup,n,e.filters,e.limit,s,r)}return e._t}function Au(t,e){e.getFirstInequalityField(),Qa(t);const n=t.filters.concat([e]);return new an(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function sa(t,e,n){return new an(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Wi(t,e){return zi(wt(t),wt(e))&&t.limitType===e.limitType}function jm(t){return`${ws(wt(t))}|lt:${t.limitType}`}function vu(t){return`Query(target=${function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map(s=>Fm(s)).join(", ")}]`),Gi(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map(s=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(s)).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>lr(s)).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>lr(s)).join(",")),`Target(${n})`}(wt(t))}; limitType=${t.limitType})`}function Rl(t,e){return e.isFoundDocument()&&function(n,s){const r=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(r):k.isDocumentKey(n.path)?n.path.isEqual(r):n.path.isImmediateParentOf(r)}(t,e)&&function(n,s){for(const r of fs(n))if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const r of n.filters)if(!r.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(r,i,o){const a=Jf(r,i,o);return r.inclusive?a<=0:a<0}(n.startAt,fs(n),s)||n.endAt&&!function(r,i,o){const a=Jf(r,i,o);return r.inclusive?a>=0:a>0}(n.endAt,fs(n),s))}(t,e)}function Qm(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Hm(t){return(e,n)=>{let s=!1;for(const r of fs(t)){const i=lT(r,e,n);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function lT(t,e,n){const s=t.field.isKeyField()?k.comparator(e.key,n.key):function(r,i,o){const a=i.data.field(r),c=o.data.field(r);return a!==null&&c!==null?On(a,c):L()}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return L()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Km(t,e){if(t.wt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ti(e)?"-0":e}}function Gm(t){return{integerValue:""+t}}function zm(t,e){return Dm(e)?Gm(e):Km(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(){this._=void 0}}function hT(t,e,n){return t instanceof fr?function(s,r){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&(i.fields.__previous_value__=r),{mapValue:i}}(n,e):t instanceof As?Ym(t,e):t instanceof vs?Jm(t,e):function(s,r){const i=Wm(s,r),o=sd(i)+sd(s.gt);return mu(i)&&mu(s.gt)?Gm(o):Km(s.yt,o)}(t,e)}function fT(t,e,n){return t instanceof As?Ym(t,e):t instanceof vs?Jm(t,e):n}function Wm(t,e){return t instanceof dr?mu(n=e)||function(s){return!!s&&"doubleValue"in s}(n)?e:{integerValue:0}:null;var n}class fr extends Ha{}class As extends Ha{constructor(e){super(),this.elements=e}}function Ym(t,e){const n=Xm(e);for(const s of t.elements)n.some(r=>Wt(r,s))||n.push(s);return{arrayValue:{values:n}}}class vs extends Ha{constructor(e){super(),this.elements=e}}function Jm(t,e){let n=Xm(e);for(const s of t.elements)n=n.filter(r=>!Wt(r,s));return{arrayValue:{values:n}}}class dr extends Ha{constructor(e,n){super(),this.yt=e,this.gt=n}}function sd(t){return Se(t.integerValue||t.doubleValue)}function Xm(t){return Si(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e,n){this.field=e,this.transform=n}}function dT(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof As&&s instanceof As||n instanceof vs&&s instanceof vs?ur(n.elements,s.elements,Wt):n instanceof dr&&s instanceof dr?Wt(n.gt,s.gt):n instanceof fr&&s instanceof fr}(t.transform,e.transform)}class gT{constructor(e,n){this.version=e,this.transformResults=n}}class _e{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new _e}static exists(e){return new _e(void 0,e)}static updateTime(e){return new _e(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ro(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ka{}function Zm(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Nr(t.key,_e.none()):new Dr(t.key,t.data,_e.none());{const n=t.data,s=Ye.empty();let r=new me(Re.comparator);for(let i of e.fields)if(!r.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new cn(t.key,s,new Et(r.toArray()),_e.none())}}function pT(t,e,n){t instanceof Dr?function(s,r,i){const o=s.value.clone(),a=id(s.fieldTransforms,r,i.transformResults);o.setAll(a),r.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof cn?function(s,r,i){if(!Ro(s.precondition,r))return void r.convertToUnknownDocument(i.version);const o=id(s.fieldTransforms,r,i.transformResults),a=r.data;a.setAll(ey(s)),a.setAll(o),r.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(s,r,i){r.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function oi(t,e,n,s){return t instanceof Dr?function(r,i,o,a){if(!Ro(r.precondition,i))return o;const c=r.value.clone(),u=od(r.fieldTransforms,a,i);return c.setAll(u),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(t,e,n,s):t instanceof cn?function(r,i,o,a){if(!Ro(r.precondition,i))return o;const c=od(r.fieldTransforms,a,i),u=i.data;return u.setAll(ey(r)),u.setAll(c),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),o===null?null:o.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(l=>l.field))}(t,e,n,s):function(r,i,o){return Ro(r.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function mT(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),i=Wm(s.transform,r||null);i!=null&&(n===null&&(n=Ye.empty()),n.set(s.field,i))}return n||null}function rd(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&ur(n,s,(r,i)=>dT(r,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Dr extends Ka{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class cn extends Ka{constructor(e,n,s,r,i=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function ey(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function id(t,e,n){const s=new Map;q(t.length===n.length);for(let r=0;r<n.length;r++){const i=t[r],o=i.transform,a=e.data.field(i.field);s.set(i.field,fT(o,a,n[r]))}return s}function od(t,e,n){const s=new Map;for(const r of t){const i=r.transform,o=n.data.field(r.field);s.set(r.field,hT(i,o,e))}return s}class Nr extends Ka{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ml extends Ka{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Le,ie;function ty(t){switch(t){default:return L();case w.CANCELLED:case w.UNKNOWN:case w.DEADLINE_EXCEEDED:case w.RESOURCE_EXHAUSTED:case w.INTERNAL:case w.UNAVAILABLE:case w.UNAUTHENTICATED:return!1;case w.INVALID_ARGUMENT:case w.NOT_FOUND:case w.ALREADY_EXISTS:case w.PERMISSION_DENIED:case w.FAILED_PRECONDITION:case w.ABORTED:case w.OUT_OF_RANGE:case w.UNIMPLEMENTED:case w.DATA_LOSS:return!0}}function ny(t){if(t===void 0)return Oe("GRPC error has no .code"),w.UNKNOWN;switch(t){case Le.OK:return w.OK;case Le.CANCELLED:return w.CANCELLED;case Le.UNKNOWN:return w.UNKNOWN;case Le.DEADLINE_EXCEEDED:return w.DEADLINE_EXCEEDED;case Le.RESOURCE_EXHAUSTED:return w.RESOURCE_EXHAUSTED;case Le.INTERNAL:return w.INTERNAL;case Le.UNAVAILABLE:return w.UNAVAILABLE;case Le.UNAUTHENTICATED:return w.UNAUTHENTICATED;case Le.INVALID_ARGUMENT:return w.INVALID_ARGUMENT;case Le.NOT_FOUND:return w.NOT_FOUND;case Le.ALREADY_EXISTS:return w.ALREADY_EXISTS;case Le.PERMISSION_DENIED:return w.PERMISSION_DENIED;case Le.FAILED_PRECONDITION:return w.FAILED_PRECONDITION;case Le.ABORTED:return w.ABORTED;case Le.OUT_OF_RANGE:return w.OUT_OF_RANGE;case Le.UNIMPLEMENTED:return w.UNIMPLEMENTED;case Le.DATA_LOSS:return w.DATA_LOSS;default:return L()}}(ie=Le||(Le={}))[ie.OK=0]="OK",ie[ie.CANCELLED=1]="CANCELLED",ie[ie.UNKNOWN=2]="UNKNOWN",ie[ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ie[ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ie[ie.NOT_FOUND=5]="NOT_FOUND",ie[ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",ie[ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",ie[ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",ie[ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ie[ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ie[ie.ABORTED=10]="ABORTED",ie[ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",ie[ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",ie[ie.INTERNAL=13]="INTERNAL",ie[ie.UNAVAILABLE=14]="UNAVAILABLE",ie[ie.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){xs(this.inner,(n,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return Sm(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wT=new Ne(k.comparator);function yt(){return wT}const sy=new Ne(k.comparator);function Yr(...t){let e=sy;for(const n of t)e=e.insert(n.key,n);return e}function ry(t){let e=sy;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function Qt(){return ai()}function iy(){return ai()}function ai(){return new Un(t=>t.toString(),(t,e)=>t.isEqual(e))}const AT=new Ne(k.comparator),vT=new me(k.comparator);function J(...t){let e=vT;for(const n of t)e=e.add(n);return e}const ET=new me(Y);function Ga(){return ET}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e,n,s,r,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const r=new Map;return r.set(e,Xi.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new Ji(j.min(),r,Ga(),yt(),J())}}class Xi{constructor(e,n,s,r,i){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new Xi(s,n,J(),J(),J())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e,n,s,r){this.It=e,this.removedTargetIds=n,this.key=s,this.Tt=r}}class oy{constructor(e,n){this.targetId=e,this.Et=n}}class ay{constructor(e,n,s=$e.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class ad{constructor(){this.At=0,this.Rt=ud(),this.bt=$e.EMPTY_BYTE_STRING,this.Pt=!1,this.vt=!0}get current(){return this.Pt}get resumeToken(){return this.bt}get Vt(){return this.At!==0}get St(){return this.vt}Dt(e){e.approximateByteSize()>0&&(this.vt=!0,this.bt=e)}Ct(){let e=J(),n=J(),s=J();return this.Rt.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:L()}}),new Xi(this.bt,this.Pt,e,n,s)}xt(){this.vt=!1,this.Rt=ud()}Nt(e,n){this.vt=!0,this.Rt=this.Rt.insert(e,n)}kt(e){this.vt=!0,this.Rt=this.Rt.remove(e)}Ot(){this.At+=1}Mt(){this.At-=1}Ft(){this.vt=!0,this.Pt=!0}}class IT{constructor(e){this.$t=e,this.Bt=new Map,this.Lt=yt(),this.qt=cd(),this.Ut=new me(Y)}Kt(e){for(const n of e.It)e.Tt&&e.Tt.isFoundDocument()?this.Gt(n,e.Tt):this.Qt(n,e.key,e.Tt);for(const n of e.removedTargetIds)this.Qt(n,e.key,e.Tt)}jt(e){this.forEachTarget(e,n=>{const s=this.Wt(n);switch(e.state){case 0:this.zt(n)&&s.Dt(e.resumeToken);break;case 1:s.Mt(),s.Vt||s.xt(),s.Dt(e.resumeToken);break;case 2:s.Mt(),s.Vt||this.removeTarget(n);break;case 3:this.zt(n)&&(s.Ft(),s.Dt(e.resumeToken));break;case 4:this.zt(n)&&(this.Ht(n),s.Dt(e.resumeToken));break;default:L()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Bt.forEach((s,r)=>{this.zt(r)&&n(r)})}Jt(e){const n=e.targetId,s=e.Et.count,r=this.Yt(n);if(r){const i=r.target;if(ta(i))if(s===0){const o=new k(i.path);this.Qt(n,o,ve.newNoDocument(o,j.min()))}else q(s===1);else this.Xt(n)!==s&&(this.Ht(n),this.Ut=this.Ut.add(n))}}Zt(e){const n=new Map;this.Bt.forEach((i,o)=>{const a=this.Yt(o);if(a){if(i.current&&ta(a.target)){const c=new k(a.target.path);this.Lt.get(c)!==null||this.te(o,c)||this.Qt(o,c,ve.newNoDocument(c,e))}i.St&&(n.set(o,i.Ct()),i.xt())}});let s=J();this.qt.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const u=this.Yt(c);return!u||u.purpose===2||(a=!1,!1)}),a&&(s=s.add(i))}),this.Lt.forEach((i,o)=>o.setReadTime(e));const r=new Ji(e,n,this.Ut,this.Lt,s);return this.Lt=yt(),this.qt=cd(),this.Ut=new me(Y),r}Gt(e,n){if(!this.zt(e))return;const s=this.te(e,n.key)?2:0;this.Wt(e).Nt(n.key,s),this.Lt=this.Lt.insert(n.key,n),this.qt=this.qt.insert(n.key,this.ee(n.key).add(e))}Qt(e,n,s){if(!this.zt(e))return;const r=this.Wt(e);this.te(e,n)?r.Nt(n,1):r.kt(n),this.qt=this.qt.insert(n,this.ee(n).delete(e)),s&&(this.Lt=this.Lt.insert(n,s))}removeTarget(e){this.Bt.delete(e)}Xt(e){const n=this.Wt(e).Ct();return this.$t.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ot(e){this.Wt(e).Ot()}Wt(e){let n=this.Bt.get(e);return n||(n=new ad,this.Bt.set(e,n)),n}ee(e){let n=this.qt.get(e);return n||(n=new me(Y),this.qt=this.qt.insert(e,n)),n}zt(e){const n=this.Yt(e)!==null;return n||T("WatchChangeAggregator","Detected inactive target",e),n}Yt(e){const n=this.Bt.get(e);return n&&n.Vt?null:this.$t.ne(e)}Ht(e){this.Bt.set(e,new ad),this.$t.getRemoteKeysForTarget(e).forEach(n=>{this.Qt(e,n,null)})}te(e,n){return this.$t.getRemoteKeysForTarget(e).has(n)}}function cd(){return new Ne(k.comparator)}function ud(){return new Ne(k.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),_T=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),TT=(()=>({and:"AND",or:"OR"}))();class CT{constructor(e,n){this.databaseId=e,this.wt=n}}function gr(t,e){return t.wt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function cy(t,e){return t.wt?e.toBase64():e.toUint8Array()}function xT(t,e){return gr(t,e.toTimestamp())}function Me(t){return q(!!t),j.fromTimestamp(function(e){const n=kn(e);return new Te(n.seconds,n.nanos)}(t))}function Bl(t,e){return function(n){return new oe(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function uy(t){const e=oe.fromString(t);return q(wy(e)),e}function Di(t,e){return Bl(t.databaseId,e.path)}function Kt(t,e){const n=uy(e);if(n.get(1)!==t.databaseId.projectId)throw new b(w.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new b(w.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new k(hy(n))}function Eu(t,e){return Bl(t.databaseId,e)}function ly(t){const e=uy(t);return e.length===4?oe.emptyPath():hy(e)}function Ni(t){return new oe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function hy(t){return q(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function ld(t,e,n){return{name:Di(t,e),fields:n.value.mapValue.fields}}function fy(t,e,n){const s=Kt(t,e.name),r=Me(e.updateTime),i=e.createTime?Me(e.createTime):j.min(),o=new Ye({mapValue:{fields:e.fields}}),a=ve.newFoundDocument(s,r,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function ST(t,e){return"found"in e?function(n,s){q(!!s.found),s.found.name,s.found.updateTime;const r=Kt(n,s.found.name),i=Me(s.found.updateTime),o=s.found.createTime?Me(s.found.createTime):j.min(),a=new Ye({mapValue:{fields:s.found.fields}});return ve.newFoundDocument(r,i,o,a)}(t,e):"missing"in e?function(n,s){q(!!s.missing),q(!!s.readTime);const r=Kt(n,s.missing),i=Me(s.readTime);return ve.newNoDocument(r,i)}(t,e):L()}function DT(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:L()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(c,u){return c.wt?(q(u===void 0||typeof u=="string"),$e.fromBase64String(u||"")):(q(u===void 0||u instanceof Uint8Array),$e.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const u=c.code===void 0?w.UNKNOWN:ny(c.code);return new b(u,c.message||"")}(o);n=new ay(s,r,i,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=Kt(t,s.document.name),i=Me(s.document.updateTime),o=s.document.createTime?Me(s.document.createTime):j.min(),a=new Ye({mapValue:{fields:s.document.fields}}),c=ve.newFoundDocument(r,i,o,a),u=s.targetIds||[],l=s.removedTargetIds||[];n=new Mo(u,l,c.key,c)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=Kt(t,s.document),i=s.readTime?Me(s.readTime):j.min(),o=ve.newNoDocument(r,i),a=s.removedTargetIds||[];n=new Mo([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=Kt(t,s.document),i=s.removedTargetIds||[];n=new Mo([],i,r,null)}else{if(!("filter"in e))return L();{e.filter;const s=e.filter;s.targetId;const r=s.count||0,i=new yT(r),o=s.targetId;n=new oy(o,i)}}return n}function ki(t,e){let n;if(e instanceof Dr)n={update:ld(t,e.key,e.value)};else if(e instanceof Nr)n={delete:Di(t,e.key)};else if(e instanceof cn)n={update:ld(t,e.key,e.data),updateMask:BT(e.fieldMask)};else{if(!(e instanceof Ml))return L();n={verify:Di(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(r,i){const o=i.transform;if(o instanceof fr)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof As)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof vs)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof dr)return{fieldPath:i.field.canonicalString(),increment:o.gt};throw L()}(0,s))),e.precondition.isNone||(n.currentDocument=function(s,r){return r.updateTime!==void 0?{updateTime:xT(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:L()}(t,e.precondition)),n}function Iu(t,e){const n=e.currentDocument?function(r){return r.updateTime!==void 0?_e.updateTime(Me(r.updateTime)):r.exists!==void 0?_e.exists(r.exists):_e.none()}(e.currentDocument):_e.none(),s=e.updateTransforms?e.updateTransforms.map(r=>function(i,o){let a=null;if("setToServerValue"in o)q(o.setToServerValue==="REQUEST_TIME"),a=new fr;else if("appendMissingElements"in o){const u=o.appendMissingElements.values||[];a=new As(u)}else if("removeAllFromArray"in o){const u=o.removeAllFromArray.values||[];a=new vs(u)}else"increment"in o?a=new dr(i,o.increment):L();const c=Re.fromServerFormat(o.fieldPath);return new Yi(c,a)}(t,r)):[];if(e.update){e.update.name;const r=Kt(t,e.update.name),i=new Ye({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(a){const c=a.fieldPaths||[];return new Et(c.map(u=>Re.fromServerFormat(u)))}(e.updateMask);return new cn(r,i,o,n,s)}return new Dr(r,i,n,s)}if(e.delete){const r=Kt(t,e.delete);return new Nr(r,n)}if(e.verify){const r=Kt(t,e.verify);return new Ml(r,n)}return L()}function NT(t,e){return t&&t.length>0?(q(e!==void 0),t.map(n=>function(s,r){let i=s.updateTime?Me(s.updateTime):Me(r);return i.isEqual(j.min())&&(i=Me(r)),new gT(i,s.transformResults||[])}(n,e))):[]}function dy(t,e){return{documents:[Eu(t,e.path)]}}function gy(t,e){const n={structuredQuery:{}},s=e.path;e.collectionGroup!==null?(n.parent=Eu(t,s),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Eu(t,s.popLast()),n.structuredQuery.from=[{collectionId:s.lastSegment()}]);const r=function(c){if(c.length!==0)return yy(de.create(c,"and"))}(e.filters);r&&(n.structuredQuery.where=r);const i=function(c){if(c.length!==0)return c.map(u=>function(l){return{field:$s(l.field),direction:OT(l.dir)}}(u))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(c,u){return c.wt||Gi(u)?u:{value:u}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function py(t){let e=ly(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){q(s===1);const l=n.from[0];l.allDescendants?r=l.collectionId:e=e.child(l.collectionId)}let i=[];n.where&&(i=function(l){const h=my(l);return h instanceof de&&Rm(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(l=>function(h){return new Js(Us(h.field),function(f){switch(f){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(l)));let a=null;n.limit&&(a=function(l){let h;return h=typeof l=="object"?l.value:l,Gi(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(l){const h=!!l.before,f=l.values||[];return new Rn(f,h)}(n.startAt));let u=null;return n.endAt&&(u=function(l){const h=!l.before,f=l.values||[];return new Rn(f,h)}(n.endAt)),qm(e,r,o,i,a,"F",c,u)}function kT(t,e){const n=function(s,r){switch(r){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return L()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function my(t){return t.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=Us(e.unaryFilter.field);return se.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Us(e.unaryFilter.field);return se.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Us(e.unaryFilter.field);return se.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Us(e.unaryFilter.field);return se.create(i,"!=",{nullValue:"NULL_VALUE"});default:return L()}}(t):t.fieldFilter!==void 0?function(e){return se.create(Us(e.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return L()}}(e.fieldFilter.op),e.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(e){return de.create(e.compositeFilter.filters.map(n=>my(n)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return L()}}(e.compositeFilter.op))}(t):L()}function OT(t){return bT[t]}function RT(t){return _T[t]}function MT(t){return TT[t]}function $s(t){return{fieldPath:t.canonicalString()}}function Us(t){return Re.fromServerFormat(t.fieldPath)}function yy(t){return t instanceof se?function(e){if(e.op==="=="){if(zf(e.value))return{unaryFilter:{field:$s(e.field),op:"IS_NAN"}};if(Gf(e.value))return{unaryFilter:{field:$s(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(zf(e.value))return{unaryFilter:{field:$s(e.field),op:"IS_NOT_NAN"}};if(Gf(e.value))return{unaryFilter:{field:$s(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$s(e.field),op:RT(e.op),value:e.value}}}(t):t instanceof de?function(e){const n=e.getFilters().map(s=>yy(s));return n.length===1?n[0]:{compositeFilter:{op:MT(e.op),filters:n}}}(t):L()}function BT(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function wy(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ht(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=hd(e)),e=PT(t.get(n),e);return hd(e)}function PT(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const i=t.charAt(r);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function hd(t){return t+""}function Ht(t){const e=t.length;if(q(e>=2),e===2)return q(t.charAt(0)===""&&t.charAt(1)===""),oe.emptyPath();const n=e-2,s=[];let r="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&L(),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;r.length===0?c=a:(r+=a,c=r,r=""),s.push(c);break;case"":r+=t.substring(i,o),r+="\0";break;case"":r+=t.substring(i,o+1);break;default:L()}i=o+2}return new oe(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fd=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bo(t,e){return[t,ht(e)]}function Ay(t,e,n){return[t,ht(e),n]}const LT={},FT=["prefixPath","collectionGroup","readTime","documentId"],VT=["prefixPath","collectionGroup","documentId"],$T=["collectionGroup","readTime","prefixPath","documentId"],UT=["canonicalId","targetId"],qT=["targetId","path"],jT=["path","targetId"],QT=["collectionId","parent"],HT=["indexId","uid"],KT=["uid","sequenceNumber"],GT=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],zT=["indexId","uid","orderedDocumentKey"],WT=["userId","collectionPath","documentId"],YT=["userId","collectionPath","largestBatchId"],JT=["userId","collectionGroup","largestBatchId"],vy=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],XT=[...vy,"documentOverlays"],Ey=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Iy=Ey,ZT=[...Iy,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu extends xm{constructor(e,n){super(),this.se=e,this.currentSequenceNumber=n}}function Ke(t,e){const n=R(t);return Ot.M(n.se,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&pT(i,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=oi(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=oi(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=iy();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(r.key)?null:a;const c=Zm(o,a);c!==null&&s.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(j.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),J())}isEqual(e){return this.batchId===e.batchId&&ur(this.mutations,e.mutations,(n,s)=>rd(n,s))&&ur(this.baseMutations,e.baseMutations,(n,s)=>rd(n,s))}}class Ll{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){q(e.mutations.length===s.length);let r=AT;const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new Ll(e,n,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e,n,s,r,i=j.min(),o=j.min(),a=$e.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new Tn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new Tn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Tn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class by{constructor(e){this.ie=e}}function eC(t,e){let n;if(e.document)n=fy(t.ie,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=k.fromSegments(e.noDocument.path),r=Is(e.noDocument.readTime);n=ve.newNoDocument(s,r),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return L();{const s=k.fromSegments(e.unknownDocument.path),r=Is(e.unknownDocument.version);n=ve.newUnknownDocument(s,r)}}return e.readTime&&n.setReadTime(function(s){const r=new Te(s[0],s[1]);return j.fromTimestamp(r)}(e.readTime)),n}function dd(t,e){const n=e.key,s={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ra(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=function(r,i){return{name:Di(r,i.key),fields:i.data.value.mapValue.fields,updateTime:gr(r,i.version.toTimestamp()),createTime:gr(r,i.createTime.toTimestamp())}}(t.ie,e);else if(e.isNoDocument())s.noDocument={path:n.path.toArray(),readTime:Es(e.version)};else{if(!e.isUnknownDocument())return L();s.unknownDocument={path:n.path.toArray(),version:Es(e.version)}}return s}function ra(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Es(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Is(t){const e=new Te(t.seconds,t.nanoseconds);return j.fromTimestamp(e)}function ts(t,e){const n=(e.baseMutations||[]).map(i=>Iu(t.ie,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const s=e.mutations.map(i=>Iu(t.ie,i)),r=Te.fromMillis(e.localWriteTimeMs);return new Pl(e.batchId,r,n,s)}function Jr(t){const e=Is(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Is(t.lastLimboFreeSnapshotVersion):j.min();let s;var r;return t.query.documents!==void 0?(q((r=t.query).documents.length===1),s=wt(Sr(ly(r.documents[0])))):s=function(i){return wt(py(i))}(t.query),new Tn(s,t.targetId,0,t.lastListenSequenceNumber,e,n,$e.fromBase64String(t.resumeToken))}function _y(t,e){const n=Es(e.snapshotVersion),s=Es(e.lastLimboFreeSnapshotVersion);let r;r=ta(e.target)?dy(t.ie,e.target):gy(t.ie,e.target);const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ws(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:r}}function Vl(t){const e=py({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?sa(e,e.limit,"L"):e}function Rc(t,e){return new Fl(e.largestBatchId,Iu(t.ie,e.overlayMutation))}function gd(t,e){const n=e.path.lastSegment();return[t,ht(e.path.popLast()),n]}function pd(t,e,n,s){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:Es(s.readTime),documentKey:ht(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{getBundleMetadata(e,n){return md(e).get(n).next(s=>{if(s)return{id:(r=s).bundleId,createTime:Is(r.createTime),version:r.version};var r})}saveBundleMetadata(e,n){return md(e).put({bundleId:(s=n).id,createTime:Es(Me(s.createTime)),version:s.version});var s}getNamedQuery(e,n){return yd(e).get(n).next(s=>{if(s)return{name:(r=s).name,query:Vl(r.bundledQuery),readTime:Is(r.readTime)};var r})}saveNamedQuery(e,n){return yd(e).put(function(s){return{name:s.name,readTime:Es(Me(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function md(t){return Ke(t,"bundles")}function yd(t){return Ke(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e,n){this.yt=e,this.userId=n}static re(e,n){const s=n.uid||"";return new za(e,s)}getOverlay(e,n){return $r(e).get(gd(this.userId,n)).next(s=>s?Rc(this.yt,s):null)}getOverlays(e,n){const s=Qt();return y.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){const r=[];return s.forEach((i,o)=>{const a=new Fl(n,o);r.push(this.oe(e,a))}),y.waitFor(r)}removeOverlaysForBatchId(e,n,s){const r=new Set;n.forEach(o=>r.add(ht(o.getCollectionPath())));const i=[];return r.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,s+1],!1,!0);i.push($r(e).Y("collectionPathOverlayIndex",a))}),y.waitFor(i)}getOverlaysForCollection(e,n,s){const r=Qt(),i=ht(n),o=IDBKeyRange.bound([this.userId,i,s],[this.userId,i,Number.POSITIVE_INFINITY],!0);return $r(e).W("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const u=Rc(this.yt,c);r.set(u.getKey(),u)}return r})}getOverlaysForCollectionGroup(e,n,s,r){const i=Qt();let o;const a=IDBKeyRange.bound([this.userId,n,s],[this.userId,n,Number.POSITIVE_INFINITY],!0);return $r(e).Z({index:"collectionGroupOverlayIndex",range:a},(c,u,l)=>{const h=Rc(this.yt,u);i.size()<r||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):l.done()}).next(()=>i)}oe(e,n){return $r(e).put(function(s,r,i){const[o,a,c]=gd(r,i.mutation.key);return{userId:r,collectionPath:a,documentId:c,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:ki(s.ie,i.mutation)}}(this.yt,this.userId,n))}}function $r(t){return Ke(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(){}ue(e,n){this.ce(e,n),n.ae()}ce(e,n){if("nullValue"in e)this.he(n,5);else if("booleanValue"in e)this.he(n,10),n.le(e.booleanValue?1:0);else if("integerValue"in e)this.he(n,15),n.le(Se(e.integerValue));else if("doubleValue"in e){const s=Se(e.doubleValue);isNaN(s)?this.he(n,13):(this.he(n,15),Ti(s)?n.le(0):n.le(s))}else if("timestampValue"in e){const s=e.timestampValue;this.he(n,20),typeof s=="string"?n.fe(s):(n.fe(`${s.seconds||""}`),n.le(s.nanos||0))}else if("stringValue"in e)this.de(e.stringValue,n),this._e(n);else if("bytesValue"in e)this.he(n,30),n.we(ps(e.bytesValue)),this._e(n);else if("referenceValue"in e)this.me(e.referenceValue,n);else if("geoPointValue"in e){const s=e.geoPointValue;this.he(n,45),n.le(s.latitude||0),n.le(s.longitude||0)}else"mapValue"in e?km(e)?this.he(n,Number.MAX_SAFE_INTEGER):(this.ge(e.mapValue,n),this._e(n)):"arrayValue"in e?(this.ye(e.arrayValue,n),this._e(n)):L()}de(e,n){this.he(n,25),this.pe(e,n)}pe(e,n){n.fe(e)}ge(e,n){const s=e.fields||{};this.he(n,55);for(const r of Object.keys(s))this.de(r,n),this.ce(s[r],n)}ye(e,n){const s=e.values||[];this.he(n,50);for(const r of s)this.ce(r,n)}me(e,n){this.he(n,37),k.fromName(e).path.forEach(s=>{this.he(n,60),this.pe(s,n)})}he(e,n){e.le(n)}_e(e){e.le(2)}}ns.Ie=new ns;function nC(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function wd(t){const e=64-function(n){let s=0;for(let r=0;r<8;++r){const i=nC(255&n[r]);if(s+=i,i!==8)break}return s}(t);return Math.ceil(e/8)}class sC{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Te(e){const n=e[Symbol.iterator]();let s=n.next();for(;!s.done;)this.Ee(s.value),s=n.next();this.Ae()}Re(e){const n=e[Symbol.iterator]();let s=n.next();for(;!s.done;)this.be(s.value),s=n.next();this.Pe()}ve(e){for(const n of e){const s=n.charCodeAt(0);if(s<128)this.Ee(s);else if(s<2048)this.Ee(960|s>>>6),this.Ee(128|63&s);else if(n<"\uD800"||"\uDBFF"<n)this.Ee(480|s>>>12),this.Ee(128|63&s>>>6),this.Ee(128|63&s);else{const r=n.codePointAt(0);this.Ee(240|r>>>18),this.Ee(128|63&r>>>12),this.Ee(128|63&r>>>6),this.Ee(128|63&r)}}this.Ae()}Ve(e){for(const n of e){const s=n.charCodeAt(0);if(s<128)this.be(s);else if(s<2048)this.be(960|s>>>6),this.be(128|63&s);else if(n<"\uD800"||"\uDBFF"<n)this.be(480|s>>>12),this.be(128|63&s>>>6),this.be(128|63&s);else{const r=n.codePointAt(0);this.be(240|r>>>18),this.be(128|63&r>>>12),this.be(128|63&r>>>6),this.be(128|63&r)}}this.Pe()}Se(e){const n=this.De(e),s=wd(n);this.Ce(1+s),this.buffer[this.position++]=255&s;for(let r=n.length-s;r<n.length;++r)this.buffer[this.position++]=255&n[r]}xe(e){const n=this.De(e),s=wd(n);this.Ce(1+s),this.buffer[this.position++]=~(255&s);for(let r=n.length-s;r<n.length;++r)this.buffer[this.position++]=~(255&n[r])}Ne(){this.ke(255),this.ke(255)}Oe(){this.Me(255),this.Me(255)}reset(){this.position=0}seed(e){this.Ce(e.length),this.buffer.set(e,this.position),this.position+=e.length}Fe(){return this.buffer.slice(0,this.position)}De(e){const n=function(r){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,r,!1),new Uint8Array(i.buffer)}(e),s=(128&n[0])!=0;n[0]^=s?255:128;for(let r=1;r<n.length;++r)n[r]^=s?255:0;return n}Ee(e){const n=255&e;n===0?(this.ke(0),this.ke(255)):n===255?(this.ke(255),this.ke(0)):this.ke(n)}be(e){const n=255&e;n===0?(this.Me(0),this.Me(255)):n===255?(this.Me(255),this.Me(0)):this.Me(e)}Ae(){this.ke(0),this.ke(1)}Pe(){this.Me(0),this.Me(1)}ke(e){this.Ce(1),this.buffer[this.position++]=e}Me(e){this.Ce(1),this.buffer[this.position++]=~e}Ce(e){const n=e+this.position;if(n<=this.buffer.length)return;let s=2*this.buffer.length;s<n&&(s=n);const r=new Uint8Array(s);r.set(this.buffer),this.buffer=r}}class rC{constructor(e){this.$e=e}we(e){this.$e.Te(e)}fe(e){this.$e.ve(e)}le(e){this.$e.Se(e)}ae(){this.$e.Ne()}}class iC{constructor(e){this.$e=e}we(e){this.$e.Re(e)}fe(e){this.$e.Ve(e)}le(e){this.$e.xe(e)}ae(){this.$e.Oe()}}class Ur{constructor(){this.$e=new sC,this.Be=new rC(this.$e),this.Le=new iC(this.$e)}seed(e){this.$e.seed(e)}qe(e){return e===0?this.Be:this.Le}Fe(){return this.$e.Fe()}reset(){this.$e.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e,n,s,r){this.indexId=e,this.documentKey=n,this.arrayValue=s,this.directionalValue=r}Ue(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,s=new Uint8Array(n);return s.set(this.directionalValue,0),n!==e?s.set([0],this.directionalValue.length):++s[s.length-1],new ss(this.indexId,this.documentKey,this.arrayValue,s)}}function dn(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=Ad(t.arrayValue,e.arrayValue),n!==0?n:(n=Ad(t.directionalValue,e.directionalValue),n!==0?n:k.comparator(t.documentKey,e.documentKey)))}function Ad(t,e){for(let n=0;n<t.length&&n<e.length;++n){const s=t[n]-e[n];if(s!==0)return s}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Ke=e.orderBy,this.Ge=[];for(const n of e.filters){const s=n;s.isInequality()?this.Qe=s:this.Ge.push(s)}}je(e){q(e.collectionGroup===this.collectionId);const n=gu(e);if(n!==void 0&&!this.We(n))return!1;const s=Yn(e);let r=0,i=0;for(;r<s.length&&this.We(s[r]);++r);if(r===s.length)return!0;if(this.Qe!==void 0){const o=s[r];if(!this.ze(this.Qe,o)||!this.He(this.Ke[i++],o))return!1;++r}for(;r<s.length;++r){const o=s[r];if(i>=this.Ke.length||!this.He(this.Ke[i++],o))return!1}return!0}We(e){for(const n of this.Ge)if(this.ze(n,e))return!0;return!1}ze(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===s}He(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ty(t){var e,n;if(q(t instanceof se||t instanceof de),t instanceof se){if(t instanceof $m){const r=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>se.create(t.field,"==",i)))||[];return de.create(r,"or")}return t}const s=t.filters.map(r=>Ty(r));return de.create(s,t.op)}function aC(t){if(t.getFilters().length===0)return[];const e=Cu(Ty(t));return q(Cy(e)),_u(e)||Tu(e)?[e]:e.getFilters()}function _u(t){return t instanceof se}function Tu(t){return t instanceof de&&Rm(t)}function Cy(t){return _u(t)||Tu(t)||function(e){if(e instanceof de&&yu(e)){for(const n of e.getFilters())if(!_u(n)&&!Tu(n))return!1;return!0}return!1}(t)}function Cu(t){if(q(t instanceof se||t instanceof de),t instanceof se)return t;if(t.filters.length===1)return Cu(t.filters[0]);const e=t.filters.map(s=>Cu(s));let n=de.create(e,t.op);return n=ia(n),Cy(n)?n:(q(n instanceof de),q(hr(n)),q(n.filters.length>1),n.filters.reduce((s,r)=>$l(s,r)))}function $l(t,e){let n;return q(t instanceof se||t instanceof de),q(e instanceof se||e instanceof de),n=t instanceof se?e instanceof se?function(s,r){return de.create([s,r],"and")}(t,e):vd(t,e):e instanceof se?vd(e,t):function(s,r){if(q(s.filters.length>0&&r.filters.length>0),hr(s)&&hr(r))return Lm(s,r.getFilters());const i=yu(s)?s:r,o=yu(s)?r:s,a=i.filters.map(c=>$l(c,o));return de.create(a,"or")}(t,e),ia(n)}function vd(t,e){if(hr(e))return Lm(e,t.getFilters());{const n=e.filters.map(s=>$l(t,s));return de.create(n,"or")}}function ia(t){if(q(t instanceof se||t instanceof de),t instanceof se)return t;const e=t.getFilters();if(e.length===1)return ia(e[0]);if(Mm(t))return t;const n=e.map(r=>ia(r)),s=[];return n.forEach(r=>{r instanceof se?s.push(r):r instanceof de&&(r.op===t.op?s.push(...r.filters):s.push(r))}),s.length===1?s[0]:de.create(s,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(){this.Je=new Ul}addToCollectionParentIndex(e,n){return this.Je.add(n),y.resolve()}getCollectionParents(e,n){return y.resolve(this.Je.getEntries(n))}addFieldIndex(e,n){return y.resolve()}deleteFieldIndex(e,n){return y.resolve()}getDocumentsMatchingTarget(e,n){return y.resolve(null)}getIndexType(e,n){return y.resolve(0)}getFieldIndexes(e,n){return y.resolve([])}getNextCollectionGroupToUpdate(e){return y.resolve(null)}getMinOffset(e,n){return y.resolve(_t.min())}getMinOffsetFromCollectionGroup(e,n){return y.resolve(_t.min())}updateCollectionGroup(e,n,s){return y.resolve()}updateIndexEntries(e,n){return y.resolve()}}class Ul{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new me(oe.comparator),i=!r.has(s);return this.index[n]=r.add(s),i}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new me(oe.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eo=new Uint8Array(0);class uC{constructor(e,n){this.user=e,this.databaseId=n,this.Ye=new Ul,this.Xe=new Un(s=>ws(s),(s,r)=>zi(s,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.Ye.has(n)){const s=n.lastSegment(),r=n.popLast();e.addOnCommittedListener(()=>{this.Ye.add(n)});const i={collectionId:s,parent:ht(r)};return Ed(e).put(i)}return y.resolve()}getCollectionParents(e,n){const s=[],r=IDBKeyRange.bound([n,""],[Im(n),""],!1,!0);return Ed(e).W(r).next(i=>{for(const o of i){if(o.collectionId!==n)break;s.push(Ht(o.parent))}return s})}addFieldIndex(e,n){const s=Io(e),r=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}(n);delete r.indexId;const i=s.add(r);if(n.indexState){const o=jr(e);return i.next(a=>{o.put(pd(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const s=Io(e),r=jr(e),i=qr(e);return s.delete(n.indexId).next(()=>r.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const s=qr(e);let r=!0;const i=new Map;return y.forEach(this.Ze(n),o=>this.tn(e,o).next(a=>{r&&(r=!!a),i.set(o,a)})).next(()=>{if(r){let o=J();const a=[];return y.forEach(i,(c,u)=>{var l;T("IndexedDbIndexManager",`Using index ${l=c,`id=${l.indexId}|cg=${l.collectionGroup}|f=${l.fields.map(M=>`${M.fieldPath}:${M.kind}`).join(",")}`} to execute ${ws(n)}`);const h=function(M,G){const te=gu(G);if(te===void 0)return null;for(const re of na(M,te.fieldPath))switch(re.op){case"array-contains-any":return re.value.arrayValue.values||[];case"array-contains":return[re.value]}return null}(u,c),f=function(M,G){const te=new Map;for(const re of Yn(G))for(const Ae of na(M,re.fieldPath))switch(Ae.op){case"==":case"in":te.set(re.fieldPath.canonicalString(),Ae.value);break;case"not-in":case"!=":return te.set(re.fieldPath.canonicalString(),Ae.value),Array.from(te.values())}return null}(u,c),g=function(M,G){const te=[];let re=!0;for(const Ae of Yn(G)){const rt=Ae.kind===0?ed(M,Ae.fieldPath,M.startAt):td(M,Ae.fieldPath,M.startAt);te.push(rt.value),re&&(re=rt.inclusive)}return new Rn(te,re)}(u,c),m=function(M,G){const te=[];let re=!0;for(const Ae of Yn(G)){const rt=Ae.kind===0?td(M,Ae.fieldPath,M.endAt):ed(M,Ae.fieldPath,M.endAt);te.push(rt.value),re&&(re=rt.inclusive)}return new Rn(te,re)}(u,c),v=this.en(c,u,g),S=this.en(c,u,m),N=this.nn(c,u,f),V=this.sn(c.indexId,h,v,g.inclusive,S,m.inclusive,N);return y.forEach(V,M=>s.J(M,n.limit).next(G=>{G.forEach(te=>{const re=k.fromSegments(te.documentKey);o.has(re)||(o=o.add(re),a.push(re))})}))}).next(()=>a)}return y.resolve(null)})}Ze(e){let n=this.Xe.get(e);return n||(e.filters.length===0?n=[e]:n=aC(de.create(e.filters,"and")).map(s=>wu(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt)),this.Xe.set(e,n),n)}sn(e,n,s,r,i,o,a){const c=(n!=null?n.length:1)*Math.max(s.length,i.length),u=c/(n!=null?n.length:1),l=[];for(let h=0;h<c;++h){const f=n?this.rn(n[h/u]):Eo,g=this.on(e,f,s[h%u],r),m=this.un(e,f,i[h%u],o),v=a.map(S=>this.on(e,f,S,!0));l.push(...this.createRange(g,m,v))}return l}on(e,n,s,r){const i=new ss(e,k.empty(),n,s);return r?i:i.Ue()}un(e,n,s,r){const i=new ss(e,k.empty(),n,s);return r?i.Ue():i}tn(e,n){const s=new oC(n),r=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,r).next(i=>{let o=null;for(const a of i)s.je(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let s=2;const r=this.Ze(n);return y.forEach(r,i=>this.tn(e,i).next(o=>{o?s!==0&&o.fields.length<function(a){let c=new me(Re.comparator),u=!1;for(const l of a.filters)for(const h of l.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?u=!0:c=c.add(h.field));for(const l of a.orderBy)l.field.isKeyField()||(c=c.add(l.field));return c.size+(u?1:0)}(i)&&(s=1):s=0})).next(()=>function(i){return i.limit!==null}(n)&&r.length>1&&s===2?1:s)}cn(e,n){const s=new Ur;for(const r of Yn(e)){const i=n.data.field(r.fieldPath);if(i==null)return null;const o=s.qe(r.kind);ns.Ie.ue(i,o)}return s.Fe()}rn(e){const n=new Ur;return ns.Ie.ue(e,n.qe(0)),n.Fe()}an(e,n){const s=new Ur;return ns.Ie.ue(ys(this.databaseId,n),s.qe(function(r){const i=Yn(r);return i.length===0?0:i[i.length-1].kind}(e))),s.Fe()}nn(e,n,s){if(s===null)return[];let r=[];r.push(new Ur);let i=0;for(const o of Yn(e)){const a=s[i++];for(const c of r)if(this.hn(n,o.fieldPath)&&Si(a))r=this.ln(r,o,a);else{const u=c.qe(o.kind);ns.Ie.ue(a,u)}}return this.fn(r)}en(e,n,s){return this.nn(e,n,s.position)}fn(e){const n=[];for(let s=0;s<e.length;++s)n[s]=e[s].Fe();return n}ln(e,n,s){const r=[...e],i=[];for(const o of s.arrayValue.values||[])for(const a of r){const c=new Ur;c.seed(a.Fe()),ns.Ie.ue(o,c.qe(n.kind)),i.push(c)}return i}hn(e,n){return!!e.filters.find(s=>s instanceof se&&s.field.isEqual(n)&&(s.op==="in"||s.op==="not-in"))}getFieldIndexes(e,n){const s=Io(e),r=jr(e);return(n?s.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):s.W()).next(i=>{const o=[];return y.forEach(i,a=>r.get([a.indexId,this.uid]).next(c=>{o.push(function(u,l){const h=l?new ea(l.sequenceNumber,new _t(Is(l.readTime),new k(Ht(l.documentKey)),l.largestBatchId)):ea.empty(),f=u.fields.map(([g,m])=>new K_(Re.fromServerFormat(g),m));return new bm(u.indexId,u.collectionGroup,f,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((s,r)=>{const i=s.indexState.sequenceNumber-r.indexState.sequenceNumber;return i!==0?i:Y(s.collectionGroup,r.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,s){const r=Io(e),i=jr(e);return this.dn(e).next(o=>r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>y.forEach(a,c=>i.put(pd(c.indexId,this.user,o,s)))))}updateIndexEntries(e,n){const s=new Map;return y.forEach(n,(r,i)=>{const o=s.get(r.collectionGroup);return(o?y.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(a=>(s.set(r.collectionGroup,a),y.forEach(a,c=>this._n(e,r,c).next(u=>{const l=this.wn(i,c);return u.isEqual(l)?y.resolve():this.mn(e,i,c,u,l)}))))})}gn(e,n,s,r){return qr(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.an(s,n.key),documentKey:n.key.path.toArray()})}yn(e,n,s,r){return qr(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.an(s,n.key),n.key.path.toArray()])}_n(e,n,s){const r=qr(e);let i=new me(dn);return r.Z({index:"documentKeyIndex",range:IDBKeyRange.only([s.indexId,this.uid,this.an(s,n)])},(o,a)=>{i=i.add(new ss(s.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>i)}wn(e,n){let s=new me(dn);const r=this.cn(n,e);if(r==null)return s;const i=gu(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Si(o))for(const a of o.arrayValue.values||[])s=s.add(new ss(n.indexId,e.key,this.rn(a),r))}else s=s.add(new ss(n.indexId,e.key,Eo,r));return s}mn(e,n,s,r,i){T("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(a,c,u,l,h){const f=a.getIterator(),g=c.getIterator();let m=Ls(f),v=Ls(g);for(;m||v;){let S=!1,N=!1;if(m&&v){const V=u(m,v);V<0?N=!0:V>0&&(S=!0)}else m!=null?N=!0:S=!0;S?(l(v),v=Ls(g)):N?(h(m),m=Ls(f)):(m=Ls(f),v=Ls(g))}}(r,i,dn,a=>{o.push(this.gn(e,n,s,a))},a=>{o.push(this.yn(e,n,s,a))}),y.waitFor(o)}dn(e){let n=1;return jr(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,r,i)=>{i.done(),n=r.sequenceNumber+1}).next(()=>n)}createRange(e,n,s){s=s.sort((o,a)=>dn(o,a)).filter((o,a,c)=>!a||dn(o,c[a-1])!==0);const r=[];r.push(e);for(const o of s){const a=dn(o,e),c=dn(o,n);if(a===0)r[0]=e.Ue();else if(a>0&&c<0)r.push(o),r.push(o.Ue());else if(c>0)break}r.push(n);const i=[];for(let o=0;o<r.length;o+=2){if(this.pn(r[o],r[o+1]))return[];const a=[r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,Eo,[]],c=[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,Eo,[]];i.push(IDBKeyRange.bound(a,c))}return i}pn(e,n){return dn(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Id)}getMinOffset(e,n){return y.mapArray(this.Ze(n),s=>this.tn(e,s).next(r=>r||L())).next(Id)}}function Ed(t){return Ke(t,"collectionParents")}function qr(t){return Ke(t,"indexEntries")}function Io(t){return Ke(t,"indexConfiguration")}function jr(t){return Ke(t,"indexState")}function Id(t){q(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let s=1;s<t.length;s++){const r=t[s].indexState.offset;Sl(r,e)<0&&(e=r),n<r.largestBatchId&&(n=r.largestBatchId)}return new _t(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class pt{constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}static withCacheSize(e){return new pt(e,pt.DEFAULT_COLLECTION_PERCENTILE,pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xy(t,e,n){const s=t.store("mutations"),r=t.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=s.Z({range:o},(l,h,f)=>(a++,f.delete()));i.push(c.next(()=>{q(a===1)}));const u=[];for(const l of n.mutations){const h=Ay(e,l.key.path,n.batchId);i.push(r.delete(h)),u.push(l.key)}return y.waitFor(i).next(()=>u)}function oa(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw L();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pt.DEFAULT_COLLECTION_PERCENTILE=10,pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pt.DEFAULT=new pt(41943040,pt.DEFAULT_COLLECTION_PERCENTILE,pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pt.DISABLED=new pt(-1,0,0);class Wa{constructor(e,n,s,r){this.userId=e,this.yt=n,this.indexManager=s,this.referenceDelegate=r,this.In={}}static re(e,n,s,r){q(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Wa(i,n,s,r)}checkEmpty(e){let n=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return gn(e).Z({index:"userMutationsIndex",range:s},(r,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,s,r){const i=qs(e),o=gn(e);return o.add({}).next(a=>{q(typeof a=="number");const c=new Pl(a,n,s,r),u=function(f,g,m){const v=m.baseMutations.map(N=>ki(f.ie,N)),S=m.mutations.map(N=>ki(f.ie,N));return{userId:g,batchId:m.batchId,localWriteTimeMs:m.localWriteTime.toMillis(),baseMutations:v,mutations:S}}(this.yt,this.userId,c),l=[];let h=new me((f,g)=>Y(f.canonicalString(),g.canonicalString()));for(const f of r){const g=Ay(this.userId,f.key.path,a);h=h.add(f.key.path.popLast()),l.push(o.put(u)),l.push(i.put(g,LT))}return h.forEach(f=>{l.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.In[a]=c.keys()}),y.waitFor(l).next(()=>c)})}lookupMutationBatch(e,n){return gn(e).get(n).next(s=>s?(q(s.userId===this.userId),ts(this.yt,s)):null)}Tn(e,n){return this.In[n]?y.resolve(this.In[n]):this.lookupMutationBatch(e,n).next(s=>{if(s){const r=s.keys();return this.In[n]=r,r}return null})}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=IDBKeyRange.lowerBound([this.userId,s]);let i=null;return gn(e).Z({index:"userMutationsIndex",range:r},(o,a,c)=>{a.userId===this.userId&&(q(a.batchId>=s),i=ts(this.yt,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=-1;return gn(e).Z({index:"userMutationsIndex",range:n,reverse:!0},(r,i,o)=>{s=i.batchId,o.done()}).next(()=>s)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return gn(e).W("userMutationsIndex",n).next(s=>s.map(r=>ts(this.yt,r)))}getAllMutationBatchesAffectingDocumentKey(e,n){const s=Bo(this.userId,n.path),r=IDBKeyRange.lowerBound(s),i=[];return qs(e).Z({range:r},(o,a,c)=>{const[u,l,h]=o,f=Ht(l);if(u===this.userId&&n.path.isEqual(f))return gn(e).get(h).next(g=>{if(!g)throw L();q(g.userId===this.userId),i.push(ts(this.yt,g))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new me(Y);const r=[];return n.forEach(i=>{const o=Bo(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=qs(e).Z({range:a},(u,l,h)=>{const[f,g,m]=u,v=Ht(g);f===this.userId&&i.path.isEqual(v)?s=s.add(m):h.done()});r.push(c)}),y.waitFor(r).next(()=>this.En(e,s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1,i=Bo(this.userId,s),o=IDBKeyRange.lowerBound(i);let a=new me(Y);return qs(e).Z({range:o},(c,u,l)=>{const[h,f,g]=c,m=Ht(f);h===this.userId&&s.isPrefixOf(m)?m.length===r&&(a=a.add(g)):l.done()}).next(()=>this.En(e,a))}En(e,n){const s=[],r=[];return n.forEach(i=>{r.push(gn(e).get(i).next(o=>{if(o===null)throw L();q(o.userId===this.userId),s.push(ts(this.yt,o))}))}),y.waitFor(r).next(()=>s)}removeMutationBatch(e,n){return xy(e.se,this.userId,n).next(s=>(e.addOnCommittedListener(()=>{this.An(n.batchId)}),y.forEach(s,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}An(e){delete this.In[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return y.resolve();const s=IDBKeyRange.lowerBound([this.userId]),r=[];return qs(e).Z({range:s},(i,o,a)=>{if(i[0]===this.userId){const c=Ht(i[1]);r.push(c)}else a.done()}).next(()=>{q(r.length===0)})})}containsKey(e,n){return Sy(e,this.userId,n)}Rn(e){return Dy(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Sy(t,e,n){const s=Bo(e,n.path),r=s[1],i=IDBKeyRange.lowerBound(s);let o=!1;return qs(t).Z({range:i,X:!0},(a,c,u)=>{const[l,h,f]=a;l===e&&h===r&&(o=!0),u.done()}).next(()=>o)}function gn(t){return Ke(t,"mutations")}function qs(t){return Ke(t,"documentMutations")}function Dy(t){return Ke(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new bs(0)}static vn(){return new bs(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(e,n){this.referenceDelegate=e,this.yt=n}allocateTargetId(e){return this.Vn(e).next(n=>{const s=new bs(n.highestTargetId);return n.highestTargetId=s.next(),this.Sn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Vn(e).next(n=>j.fromTimestamp(new Te(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Vn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,s){return this.Vn(e).next(r=>(r.highestListenSequenceNumber=n,s&&(r.lastRemoteSnapshotVersion=s.toTimestamp()),n>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=n),this.Sn(e,r)))}addTargetData(e,n){return this.Dn(e,n).next(()=>this.Vn(e).next(s=>(s.targetCount+=1,this.Cn(n,s),this.Sn(e,s))))}updateTargetData(e,n){return this.Dn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Fs(e).delete(n.targetId)).next(()=>this.Vn(e)).next(s=>(q(s.targetCount>0),s.targetCount-=1,this.Sn(e,s)))}removeTargets(e,n,s){let r=0;const i=[];return Fs(e).Z((o,a)=>{const c=Jr(a);c.sequenceNumber<=n&&s.get(c.targetId)===null&&(r++,i.push(this.removeTargetData(e,c)))}).next(()=>y.waitFor(i)).next(()=>r)}forEachTarget(e,n){return Fs(e).Z((s,r)=>{const i=Jr(r);n(i)})}Vn(e){return _d(e).get("targetGlobalKey").next(n=>(q(n!==null),n))}Sn(e,n){return _d(e).put("targetGlobalKey",n)}Dn(e,n){return Fs(e).put(_y(this.yt,n))}Cn(e,n){let s=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,s=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.Vn(e).next(n=>n.targetCount)}getTargetData(e,n){const s=ws(n),r=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let i=null;return Fs(e).Z({range:r,index:"queryTargetsIndex"},(o,a,c)=>{const u=Jr(a);zi(n,u.target)&&(i=u,c.done())}).next(()=>i)}addMatchingKeys(e,n,s){const r=[],i=wn(e);return n.forEach(o=>{const a=ht(o.path);r.push(i.put({targetId:s,path:a})),r.push(this.referenceDelegate.addReference(e,s,o))}),y.waitFor(r)}removeMatchingKeys(e,n,s){const r=wn(e);return y.forEach(n,i=>{const o=ht(i.path);return y.waitFor([r.delete([s,o]),this.referenceDelegate.removeReference(e,s,i)])})}removeMatchingKeysForTargetId(e,n){const s=wn(e),r=IDBKeyRange.bound([n],[n+1],!1,!0);return s.delete(r)}getMatchingKeysForTargetId(e,n){const s=IDBKeyRange.bound([n],[n+1],!1,!0),r=wn(e);let i=J();return r.Z({range:s,X:!0},(o,a,c)=>{const u=Ht(o[1]),l=new k(u);i=i.add(l)}).next(()=>i)}containsKey(e,n){const s=ht(n.path),r=IDBKeyRange.bound([s],[Im(s)],!1,!0);let i=0;return wn(e).Z({index:"documentTargetsIndex",X:!0,range:r},([o,a],c,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}ne(e,n){return Fs(e).get(n).next(s=>s?Jr(s):null)}}function Fs(t){return Ke(t,"targets")}function _d(t){return Ke(t,"targetGlobal")}function wn(t){return Ke(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Td([t,e],[n,s]){const r=Y(t,n);return r===0?Y(e,s):r}class hC{constructor(e){this.xn=e,this.buffer=new me(Td),this.Nn=0}kn(){return++this.Nn}On(e){const n=[e,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();Td(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class fC{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Mn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Fn(6e4)}stop(){this.Mn&&(this.Mn.cancel(),this.Mn=null)}get started(){return this.Mn!==null}Fn(e){T("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Mn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Mn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){$n(n)?T("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Vn(n)}await this.Fn(3e5)})}}class dC{constructor(e,n){this.$n=e,this.params=n}calculateTargetCount(e,n){return this.$n.Bn(e).next(s=>Math.floor(n/100*s))}nthSequenceNumber(e,n){if(n===0)return y.resolve(mt.at);const s=new hC(n);return this.$n.forEachTarget(e,r=>s.On(r.sequenceNumber)).next(()=>this.$n.Ln(e,r=>s.On(r))).next(()=>s.maxValue)}removeTargets(e,n,s){return this.$n.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.$n.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(T("LruGarbageCollector","Garbage collection skipped; disabled"),y.resolve(bd)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(T("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),bd):this.qn(e,n))}getCacheSize(e){return this.$n.getCacheSize(e)}qn(e,n){let s,r,i,o,a,c,u;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(T("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,o=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(s=h,a=Date.now(),this.removeTargets(e,s,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,s))).next(h=>(u=Date.now(),du()<=le.DEBUG&&T("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(u-c)+`ms
Total Duration: ${u-l}ms`),y.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:h})))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e,n){this.db=e,this.garbageCollector=function(s,r){return new dC(s,r)}(this,n)}Bn(e){const n=this.Un(e);return this.db.getTargetCache().getTargetCount(e).next(s=>n.next(r=>s+r))}Un(e){let n=0;return this.Ln(e,s=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Ln(e,n){return this.Kn(e,(s,r)=>n(r))}addReference(e,n,s){return bo(e,s)}removeReference(e,n,s){return bo(e,s)}removeTargets(e,n,s){return this.db.getTargetCache().removeTargets(e,n,s)}markPotentiallyOrphaned(e,n){return bo(e,n)}Gn(e,n){return function(s,r){let i=!1;return Dy(s).tt(o=>Sy(s,o,r).next(a=>(a&&(i=!0),y.resolve(!a)))).next(()=>i)}(e,n)}removeOrphanedDocuments(e,n){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Kn(e,(o,a)=>{if(a<=n){const c=this.Gn(e,o).next(u=>{if(!u)return i++,s.getEntry(e,o).next(()=>(s.removeEntry(o,j.min()),wn(e).delete([0,ht(o.path)])))});r.push(c)}}).next(()=>y.waitFor(r)).next(()=>s.apply(e)).next(()=>i)}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,n){return bo(e,n)}Kn(e,n){const s=wn(e);let r,i=mt.at;return s.Z({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:u})=>{o===0?(i!==mt.at&&n(new k(Ht(r)),i),i=u,r=c):i=mt.at}).next(()=>{i!==mt.at&&n(new k(Ht(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function bo(t,e){return wn(t).put(function(n,s){return{targetId:0,path:ht(n.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(){this.changes=new Un(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ve.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?y.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e){this.yt=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,s){return Gn(e).put(s)}removeEntry(e,n,s){return Gn(e).delete(function(r,i){const o=r.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],ra(i),o[o.length-1]]}(n,s))}updateMetadata(e,n){return this.getMetadata(e).next(s=>(s.byteSize+=n,this.Qn(e,s)))}getEntry(e,n){let s=ve.newInvalidDocument(n);return Gn(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(Qr(n))},(r,i)=>{s=this.jn(n,i)}).next(()=>s)}Wn(e,n){let s={size:0,document:ve.newInvalidDocument(n)};return Gn(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(Qr(n))},(r,i)=>{s={document:this.jn(n,i),size:oa(i)}}).next(()=>s)}getEntries(e,n){let s=yt();return this.zn(e,n,(r,i)=>{const o=this.jn(r,i);s=s.insert(r,o)}).next(()=>s)}Hn(e,n){let s=yt(),r=new Ne(k.comparator);return this.zn(e,n,(i,o)=>{const a=this.jn(i,o);s=s.insert(i,a),r=r.insert(i,oa(o))}).next(()=>({documents:s,Jn:r}))}zn(e,n,s){if(n.isEmpty())return y.resolve();let r=new me(Sd);n.forEach(c=>r=r.add(c));const i=IDBKeyRange.bound(Qr(r.first()),Qr(r.last())),o=r.getIterator();let a=o.getNext();return Gn(e).Z({index:"documentKeyIndex",range:i},(c,u,l)=>{const h=k.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&Sd(a,h)<0;)s(a,null),a=o.getNext();a&&a.isEqual(h)&&(s(a,u),a=o.hasNext()?o.getNext():null),a?l.j(Qr(a)):l.done()}).next(()=>{for(;a;)s(a,null),a=o.hasNext()?o.getNext():null})}getAllFromCollection(e,n,s){const r=[n.popLast().toArray(),n.lastSegment(),ra(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],i=[n.popLast().toArray(),n.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Gn(e).W(IDBKeyRange.bound(r,i,!0)).next(o=>{let a=yt();for(const c of o){const u=this.jn(k.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);a=a.insert(u.key,u)}return a})}getAllFromCollectionGroup(e,n,s,r){let i=yt();const o=xd(n,s),a=xd(n,_t.max());return Gn(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,u,l)=>{const h=this.jn(k.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(h.key,h),i.size===r&&l.done()}).next(()=>i)}newChangeBuffer(e){return new mC(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Cd(e).get("remoteDocumentGlobalKey").next(n=>(q(!!n),n))}Qn(e,n){return Cd(e).put("remoteDocumentGlobalKey",n)}jn(e,n){if(n){const s=eC(this.yt,n);if(!(s.isNoDocument()&&s.version.isEqual(j.min())))return s}return ve.newInvalidDocument(e)}}function ky(t){return new pC(t)}class mC extends Ny{constructor(e,n){super(),this.Yn=e,this.trackRemovals=n,this.Xn=new Un(s=>s.toString(),(s,r)=>s.isEqual(r))}applyChanges(e){const n=[];let s=0,r=new me((i,o)=>Y(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Xn.get(i);if(n.push(this.Yn.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=dd(this.Yn.yt,o);r=r.add(i.path.popLast());const u=oa(c);s+=u-a.size,n.push(this.Yn.addEntry(e,i,c))}else if(s-=a.size,this.trackRemovals){const c=dd(this.Yn.yt,o.convertToNoDocument(j.min()));n.push(this.Yn.addEntry(e,i,c))}}),r.forEach(i=>{n.push(this.Yn.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Yn.updateMetadata(e,s)),y.waitFor(n)}getFromCache(e,n){return this.Yn.Wn(e,n).next(s=>(this.Xn.set(n,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,n){return this.Yn.Hn(e,n).next(({documents:s,Jn:r})=>(r.forEach((i,o)=>{this.Xn.set(i,{size:o,readTime:s.get(i).readTime})}),s))}}function Cd(t){return Ke(t,"remoteDocumentGlobal")}function Gn(t){return Ke(t,"remoteDocumentsV14")}function Qr(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function xd(t,e){const n=e.documentKey.path.toArray();return[t,ra(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Sd(t,e){const n=t.path.toArray(),s=e.path.toArray();let r=0;for(let i=0;i<n.length-2&&i<s.length-2;++i)if(r=Y(n[i],s[i]),r)return r;return r=Y(n.length,s.length),r||(r=Y(n[n.length-2],s[s.length-2]),r||Y(n[n.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,n))).next(r=>(s!==null&&oi(s.mutation,r,Et.empty(),Te.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,J()).next(()=>s))}getLocalViewOfDocuments(e,n,s=J()){const r=Qt();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,s).next(i=>{let o=Yr();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const s=Qt();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,J()))}populateOverlays(e,n,s){const r=[];return s.forEach(i=>{n.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,s,r){let i=yt();const o=ai(),a=ai();return n.forEach((c,u)=>{const l=s.get(u.key);r.has(u.key)&&(l===void 0||l.mutation instanceof cn)?i=i.insert(u.key,u):l!==void 0&&(o.set(u.key,l.mutation.getFieldMask()),oi(l.mutation,u,l.mutation.getFieldMask(),Te.now()))}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,l)=>o.set(u,l)),n.forEach((u,l)=>{var h;return a.set(u,new yC(l,(h=o.get(u))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const s=ai();let r=new Ne((o,a)=>o-a),i=J();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let l=s.get(c)||Et.empty();l=a.applyToLocalView(u,l),s.set(c,l);const h=(r.get(a.batchId)||J()).add(c);r=r.insert(a.batchId,h)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),u=c.key,l=c.value,h=iy();l.forEach(f=>{if(!i.has(f)){const g=Zm(n.get(f),s.get(f));g!==null&&h.set(f,g),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return y.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s){return function(r){return k.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Ol(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s):this.getDocumentsMatchingCollectionQuery(e,n,s)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-i.size):y.resolve(Qt());let a=-1,c=i;return o.next(u=>y.forEach(u,(l,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(l)?y.resolve():this.remoteDocumentCache.getEntry(e,l).next(f=>{c=c.insert(l,f)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,J())).next(l=>({batchId:a,changes:ry(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new k(n)).next(s=>{let r=Yr();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,s){const r=n.collectionGroup;let i=Yr();return this.indexManager.getCollectionParents(e,r).next(o=>y.forEach(o,a=>{const c=function(u,l){return new an(l,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(n,a.child(r));return this.getDocumentsMatchingCollectionQuery(e,c,s).next(u=>{u.forEach((l,h)=>{i=i.insert(l,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,s){let r;return this.remoteDocumentCache.getAllFromCollection(e,n.path,s).next(i=>(r=i,this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId))).next(i=>{i.forEach((a,c)=>{const u=c.getKey();r.get(u)===null&&(r=r.insert(u,ve.newInvalidDocument(u)))});let o=Yr();return r.forEach((a,c)=>{const u=i.get(a);u!==void 0&&oi(u.mutation,c,Et.empty(),Te.now()),Rl(n,c)&&(o=o.insert(a,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e){this.yt=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,n){return y.resolve(this.Zn.get(n))}saveBundleMetadata(e,n){var s;return this.Zn.set(n.id,{id:(s=n).id,version:s.version,createTime:Me(s.createTime)}),y.resolve()}getNamedQuery(e,n){return y.resolve(this.ts.get(n))}saveNamedQuery(e,n){return this.ts.set(n.name,function(s){return{name:s.name,query:Vl(s.bundledQuery),readTime:Me(s.readTime)}}(n)),y.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(){this.overlays=new Ne(k.comparator),this.es=new Map}getOverlay(e,n){return y.resolve(this.overlays.get(n))}getOverlays(e,n){const s=Qt();return y.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((r,i)=>{this.oe(e,n,i)}),y.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.es.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.es.delete(s)),y.resolve()}getOverlaysForCollection(e,n,s){const r=Qt(),i=n.length+1,o=new k(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>s&&r.set(c.getKey(),c)}return y.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let i=new Ne((u,l)=>u-l);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>s){let l=i.get(u.largestBatchId);l===null&&(l=Qt(),i=i.insert(u.largestBatchId,l)),l.set(u.getKey(),u)}}const a=Qt(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,l)=>a.set(u,l)),!(a.size()>=r)););return y.resolve(a)}oe(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.es.get(r.largestBatchId).delete(s.key);this.es.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new Fl(n,s));let i=this.es.get(n);i===void 0&&(i=J(),this.es.set(n,i)),this.es.set(n,i.add(s.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(){this.ns=new me(Ue.ss),this.rs=new me(Ue.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,n){const s=new Ue(e,n);this.ns=this.ns.add(s),this.rs=this.rs.add(s)}us(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.cs(new Ue(e,n))}hs(e,n){e.forEach(s=>this.removeReference(s,n))}ls(e){const n=new k(new oe([])),s=new Ue(n,e),r=new Ue(n,e+1),i=[];return this.rs.forEachInRange([s,r],o=>{this.cs(o),i.push(o.key)}),i}fs(){this.ns.forEach(e=>this.cs(e))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const n=new k(new oe([])),s=new Ue(n,e),r=new Ue(n,e+1);let i=J();return this.rs.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Ue(e,0),s=this.ns.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class Ue{constructor(e,n){this.key=e,this._s=n}static ss(e,n){return k.comparator(e.key,n.key)||Y(e._s,n._s)}static os(e,n){return Y(e._s,n._s)||k.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.ws=1,this.gs=new me(Ue.ss)}checkEmpty(e){return y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const i=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Pl(i,n,s,r);this.mutationQueue.push(o);for(const a of r)this.gs=this.gs.add(new Ue(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return y.resolve(o)}lookupMutationBatch(e,n){return y.resolve(this.ys(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.ps(s),i=r<0?0:r;return y.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return y.resolve(this.mutationQueue.length===0?-1:this.ws-1)}getAllMutationBatches(e){return y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new Ue(n,0),r=new Ue(n,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([s,r],o=>{const a=this.ys(o._s);i.push(a)}),y.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new me(Y);return n.forEach(r=>{const i=new Ue(r,0),o=new Ue(r,Number.POSITIVE_INFINITY);this.gs.forEachInRange([i,o],a=>{s=s.add(a._s)})}),y.resolve(this.Is(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let i=s;k.isDocumentKey(i)||(i=i.child(""));const o=new Ue(new k(i),0);let a=new me(Y);return this.gs.forEachWhile(c=>{const u=c.key.path;return!!s.isPrefixOf(u)&&(u.length===r&&(a=a.add(c._s)),!0)},o),y.resolve(this.Is(a))}Is(e){const n=[];return e.forEach(s=>{const r=this.ys(s);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){q(this.Ts(n.batchId,"removed")===0),this.mutationQueue.shift();let s=this.gs;return y.forEach(n.mutations,r=>{const i=new Ue(r.key,n.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.gs=s})}An(e){}containsKey(e,n){const s=new Ue(n,0),r=this.gs.firstAfterOrEqual(s);return y.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,y.resolve()}Ts(e,n){return this.ps(e)}ps(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ys(e){const n=this.ps(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(e){this.Es=e,this.docs=new Ne(k.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),i=r?r.size:0,o=this.Es(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return y.resolve(s?s.document.mutableCopy():ve.newInvalidDocument(n))}getEntries(e,n){let s=yt();return n.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():ve.newInvalidDocument(r))}),y.resolve(s)}getAllFromCollection(e,n,s){let r=yt();const i=new k(n.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:a,value:{document:c}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||Sl(Tm(c),s)<=0||(r=r.insert(c.key,c.mutableCopy()))}return y.resolve(r)}getAllFromCollectionGroup(e,n,s,r){L()}As(e,n){return y.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new IC(this)}getSize(e){return y.resolve(this.size)}}class IC extends Ny{constructor(e){super(),this.Yn=e}applyChanges(e){const n=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?n.push(this.Yn.addEntry(e,r)):this.Yn.removeEntry(s)}),y.waitFor(n)}getFromCache(e,n){return this.Yn.getEntry(e,n)}getAllFromCache(e,n){return this.Yn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(e){this.persistence=e,this.Rs=new Un(n=>ws(n),zi),this.lastRemoteSnapshotVersion=j.min(),this.highestTargetId=0,this.bs=0,this.Ps=new ql,this.targetCount=0,this.vs=bs.Pn()}forEachTarget(e,n){return this.Rs.forEach((s,r)=>n(r)),y.resolve()}getLastRemoteSnapshotVersion(e){return y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return y.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),y.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.bs&&(this.bs=n),y.resolve()}Dn(e){this.Rs.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.vs=new bs(n),this.highestTargetId=n),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,n){return this.Dn(n),this.targetCount+=1,y.resolve()}updateTargetData(e,n){return this.Dn(n),y.resolve()}removeTargetData(e,n){return this.Rs.delete(n.target),this.Ps.ls(n.targetId),this.targetCount-=1,y.resolve()}removeTargets(e,n,s){let r=0;const i=[];return this.Rs.forEach((o,a)=>{a.sequenceNumber<=n&&s.get(a.targetId)===null&&(this.Rs.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),y.waitFor(i).next(()=>r)}getTargetCount(e){return y.resolve(this.targetCount)}getTargetData(e,n){const s=this.Rs.get(n)||null;return y.resolve(s)}addMatchingKeys(e,n,s){return this.Ps.us(n,s),y.resolve()}removeMatchingKeys(e,n,s){this.Ps.hs(n,s);const r=this.persistence.referenceDelegate,i=[];return r&&n.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),y.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Ps.ls(n),y.resolve()}getMatchingKeysForTargetId(e,n){const s=this.Ps.ds(n);return y.resolve(s)}containsKey(e,n){return y.resolve(this.Ps.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e,n){this.Vs={},this.overlays={},this.Ss=new mt(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new bC(this),this.indexManager=new cC,this.remoteDocumentCache=function(s){return new EC(s)}(s=>this.referenceDelegate.xs(s)),this.yt=new by(n),this.Ns=new wC(this.yt)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new AC,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.Vs[e.toKey()];return s||(s=new vC(n,this.referenceDelegate),this.Vs[e.toKey()]=s),s}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,n,s){T("MemoryPersistence","Starting transaction:",e);const r=new _C(this.Ss.next());return this.referenceDelegate.ks(),s(r).next(i=>this.referenceDelegate.Os(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ms(e,n){return y.or(Object.values(this.Vs).map(s=>()=>s.containsKey(e,n)))}}class _C extends xm{constructor(e){super(),this.currentSequenceNumber=e}}class Ya{constructor(e){this.persistence=e,this.Fs=new ql,this.$s=null}static Bs(e){return new Ya(e)}get Ls(){if(this.$s)return this.$s;throw L()}addReference(e,n,s){return this.Fs.addReference(s,n),this.Ls.delete(s.toString()),y.resolve()}removeReference(e,n,s){return this.Fs.removeReference(s,n),this.Ls.add(s.toString()),y.resolve()}markPotentiallyOrphaned(e,n){return this.Ls.add(n.toString()),y.resolve()}removeTarget(e,n){this.Fs.ls(n.targetId).forEach(r=>this.Ls.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(i=>this.Ls.add(i.toString()))}).next(()=>s.removeTargetData(e,n))}ks(){this.$s=new Set}Os(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return y.forEach(this.Ls,s=>{const r=k.fromPath(s);return this.qs(e,r).next(i=>{i||n.removeEntry(r,j.min())})}).next(()=>(this.$s=null,n.apply(e)))}updateLimboDocument(e,n){return this.qs(e,n).next(s=>{s?this.Ls.delete(n.toString()):this.Ls.add(n.toString())})}xs(e){return 0}qs(e,n){return y.or([()=>y.resolve(this.Fs.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ms(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(e){this.yt=e}$(e,n,s,r){const i=new ja("createOrUpgrade",n);s<1&&r>=1&&(function(a){a.createObjectStore("owner")}(e),function(a){a.createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",fd,{unique:!0}),a.createObjectStore("documentMutations")}(e),Dd(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=y.resolve();return s<3&&r>=3&&(s!==0&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),Dd(e)),o=o.next(()=>function(a){const c=a.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:j.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",u)}(i))),s<4&&r>=4&&(s!==0&&(o=o.next(()=>function(a,c){return c.store("mutations").W().next(u=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",fd,{unique:!0});const l=c.store("mutations"),h=u.map(f=>l.put(f));return y.waitFor(h)})}(e,i))),o=o.next(()=>{(function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),s<5&&r>=5&&(o=o.next(()=>this.Us(i))),s<6&&r>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Ks(i)))),s<7&&r>=7&&(o=o.next(()=>this.Gs(i))),s<8&&r>=8&&(o=o.next(()=>this.Qs(e,i))),s<9&&r>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e)})),s<10&&r>=10&&(o=o.next(()=>this.js(i))),s<11&&r>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),s<12&&r>=12&&(o=o.next(()=>{(function(a){const c=a.createObjectStore("documentOverlays",{keyPath:WT});c.createIndex("collectionPathOverlayIndex",YT,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",JT,{unique:!1})})(e)})),s<13&&r>=13&&(o=o.next(()=>function(a){const c=a.createObjectStore("remoteDocumentsV14",{keyPath:FT});c.createIndex("documentKeyIndex",VT),c.createIndex("collectionGroupIndex",$T)}(e)).next(()=>this.Ws(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),s<14&&r>=14&&(o=o.next(()=>this.zs(e,i))),s<15&&r>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:HT}).createIndex("sequenceNumberIndex",KT,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:GT}).createIndex("documentKeyIndex",zT,{unique:!1})}(e))),o}Ks(e){let n=0;return e.store("remoteDocuments").Z((s,r)=>{n+=oa(r)}).next(()=>{const s={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",s)})}Us(e){const n=e.store("mutationQueues"),s=e.store("mutations");return n.W().next(r=>y.forEach(r,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return s.W("userMutationsIndex",o).next(a=>y.forEach(a,c=>{q(c.userId===i.userId);const u=ts(this.yt,c);return xy(e,i.userId,u).next(()=>{})}))}))}Gs(e){const n=e.store("targetDocuments"),s=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const i=[];return s.Z((o,a)=>{const c=new oe(o),u=function(l){return[0,ht(l)]}(c);i.push(n.get(u).next(l=>l?y.resolve():(h=>n.put({targetId:0,path:ht(h),sequenceNumber:r.highestListenSequenceNumber}))(c)))}).next(()=>y.waitFor(i))})}Qs(e,n){e.createObjectStore("collectionParents",{keyPath:QT});const s=n.store("collectionParents"),r=new Ul,i=o=>{if(r.add(o)){const a=o.lastSegment(),c=o.popLast();return s.put({collectionId:a,parent:ht(c)})}};return n.store("remoteDocuments").Z({X:!0},(o,a)=>{const c=new oe(o);return i(c.popLast())}).next(()=>n.store("documentMutations").Z({X:!0},([o,a,c],u)=>{const l=Ht(a);return i(l.popLast())}))}js(e){const n=e.store("targets");return n.Z((s,r)=>{const i=Jr(r),o=_y(this.yt,i);return n.put(o)})}Ws(e,n){const s=n.store("remoteDocuments"),r=[];return s.Z((i,o)=>{const a=n.store("remoteDocumentsV14"),c=(u=o,u.document?new k(oe.fromString(u.document.name).popFirst(5)):u.noDocument?k.fromSegments(u.noDocument.path):u.unknownDocument?k.fromSegments(u.unknownDocument.path):L()).path.toArray();var u;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(l))}).next(()=>y.waitFor(r))}zs(e,n){const s=n.store("mutations"),r=ky(this.yt),i=new Ry(Ya.Bs,this.yt.ie);return s.W().next(o=>{const a=new Map;return o.forEach(c=>{var u;let l=(u=a.get(c.userId))!==null&&u!==void 0?u:J();ts(this.yt,c).keys().forEach(h=>l=l.add(h)),a.set(c.userId,l)}),y.forEach(a,(c,u)=>{const l=new qe(u),h=za.re(this.yt,l),f=i.getIndexManager(l),g=Wa.re(l,this.yt,f,i.referenceDelegate);return new Oy(r,g,h,f).recalculateAndSaveOverlaysForDocumentKeys(new bu(n,mt.at),c).next()})})}}function Dd(t){t.createObjectStore("targetDocuments",{keyPath:qT}).createIndex("documentTargetsIndex",jT,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",UT,{unique:!0}),t.createObjectStore("targetGlobal")}const Mc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class jl{constructor(e,n,s,r,i,o,a,c,u,l,h=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=s,this.Hs=i,this.window=o,this.document=a,this.Js=u,this.Ys=l,this.Xs=h,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=f=>Promise.resolve(),!jl.C())throw new b(w.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new gC(this,r),this.ii=n+"main",this.yt=new by(c),this.ri=new Ot(this.ii,this.Xs,new TC(this.yt)),this.Cs=new lC(this.referenceDelegate,this.yt),this.remoteDocumentCache=ky(this.yt),this.Ns=new tC,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,l===!1&&Oe("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ui().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new b(w.FAILED_PRECONDITION,Mc);return this.ci(),this.ai(),this.hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Cs.getHighestSequenceNumber(e))}).then(e=>{this.Ss=new mt(e,this.Js)}).then(()=>{this.Ds=!0}).catch(e=>(this.ri&&this.ri.close(),Promise.reject(e)))}li(e){return this.si=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Hs.enqueueAndForget(async()=>{this.started&&await this.ui()}))}ui(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>_o(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)))})}).next(()=>this.di(e)).next(n=>this.isPrimary&&!n?this._i(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if($n(e))return T("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return T("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Hs.enqueueRetryable(()=>this.si(e)),this.isPrimary=e})}fi(e){return Hr(e).get("owner").next(n=>y.resolve(this.mi(n)))}gi(e){return _o(e).delete(this.clientId)}async yi(){if(this.isPrimary&&!this.pi(this.ni,18e5)){this.ni=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const s=Ke(n,"clientMetadata");return s.W().next(r=>{const i=this.Ii(r,18e5),o=r.filter(a=>i.indexOf(a)===-1);return y.forEach(o,a=>s.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.oi)for(const n of e)this.oi.removeItem(this.Ti(n.clientId))}}hi(){this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ui().then(()=>this.yi()).then(()=>this.hi()))}mi(e){return!!e&&e.ownerId===this.clientId}di(e){return this.Ys?y.resolve(!0):Hr(e).get("owner").next(n=>{if(n!==null&&this.pi(n.leaseTimestampMs,5e3)&&!this.Ei(n.ownerId)){if(this.mi(n)&&this.networkEnabled)return!0;if(!this.mi(n)){if(!n.allowTabSynchronization)throw new b(w.FAILED_PRECONDITION,Mc);return!1}}return!(!this.networkEnabled||!this.inForeground)||_o(e).W().next(s=>this.Ii(s,5e3).find(r=>{if(this.clientId!==r.clientId){const i=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&T("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Ds=!1,this.Ai(),this.ei&&(this.ei.cancel(),this.ei=null),this.Ri(),this.bi(),await this.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new bu(e,mt.at);return this._i(n).next(()=>this.gi(n))}),this.ri.close(),this.Pi()}Ii(e,n){return e.filter(s=>this.pi(s.updateTimeMs,n)&&!this.Ei(s.clientId))}vi(){return this.runTransaction("getActiveClients","readonly",e=>_o(e).W().next(n=>this.Ii(n,18e5).map(s=>s.clientId)))}get started(){return this.Ds}getMutationQueue(e,n){return Wa.re(e,this.yt,n,this.referenceDelegate)}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new uC(e,this.yt.ie.databaseId)}getDocumentOverlayCache(e){return za.re(this.yt,e)}getBundleCache(){return this.Ns}runTransaction(e,n,s){T("IndexedDbPersistence","Starting transaction:",e);const r=n==="readonly"?"readonly":"readwrite",i=(o=this.Xs)===15?ZT:o===14?Iy:o===13?Ey:o===12?XT:o===11?vy:void L();var o;let a;return this.ri.runTransaction(e,r,i,c=>(a=new bu(c,this.Ss?this.Ss.next():mt.at),n==="readwrite-primary"?this.fi(a).next(u=>!!u||this.di(a)).next(u=>{if(!u)throw Oe(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)),new b(w.FAILED_PRECONDITION,Cm);return s(a)}).next(u=>this.wi(a).next(()=>u)):this.Vi(a).next(()=>s(a)))).then(c=>(a.raiseOnCommittedEvent(),c))}Vi(e){return Hr(e).get("owner").next(n=>{if(n!==null&&this.pi(n.leaseTimestampMs,5e3)&&!this.Ei(n.ownerId)&&!this.mi(n)&&!(this.Ys||this.allowTabSynchronization&&n.allowTabSynchronization))throw new b(w.FAILED_PRECONDITION,Mc)})}wi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Hr(e).put("owner",n)}static C(){return Ot.C()}_i(e){const n=Hr(e);return n.get("owner").next(s=>this.mi(s)?(T("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):y.resolve())}pi(e,n){const s=Date.now();return!(e<s-n)&&(!(e>s)||(Oe(`Detected an update time that is in the future: ${e} > ${s}`),!1))}ci(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ti=()=>{this.Hs.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.ui()))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground=this.document.visibilityState==="visible")}Ri(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}ai(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Zs=()=>{this.Ai(),XI()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Hs.enterRestrictedMode(!0),this.Hs.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Zs))}bi(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}Ei(e){var n;try{const s=((n=this.oi)===null||n===void 0?void 0:n.getItem(this.Ti(e)))!==null;return T("IndexedDbPersistence",`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return Oe("IndexedDbPersistence","Failed to get zombied client id.",s),!1}}Ai(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(e){Oe("Failed to set zombie client id.",e)}}Pi(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch{}}Ti(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Hr(t){return Ke(t,"owner")}function _o(t){return Ke(t,"clientMetadata")}function Ql(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.Si=s,this.Di=r}static Ci(e,n){let s=J(),r=J();for(const i of n.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Hl(e,n.fromCache,s,r)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{constructor(){this.xi=!1}initialize(e,n){this.Ni=e,this.indexManager=n,this.xi=!0}getDocumentsMatchingQuery(e,n,s,r){return this.ki(e,n).next(i=>i||this.Oi(e,n,r,s)).next(i=>i||this.Mi(e,n))}ki(e,n){if(nd(n))return y.resolve(null);let s=wt(n);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=sa(n,null,"F"),s=wt(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=J(...i);return this.Ni.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,s).next(c=>{const u=this.Fi(n,a);return this.$i(n,u,o,c.readTime)?this.ki(e,sa(n,null,"F")):this.Bi(e,u,n,c)}))})))}Oi(e,n,s,r){return nd(n)||r.isEqual(j.min())?this.Mi(e,n):this.Ni.getDocuments(e,s).next(i=>{const o=this.Fi(n,i);return this.$i(n,o,s,r)?this.Mi(e,n):(du()<=le.DEBUG&&T("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),vu(n)),this.Bi(e,o,n,_m(r,-1)))})}Fi(e,n){let s=new me(Hm(e));return n.forEach((r,i)=>{Rl(e,i)&&(s=s.add(i))}),s}$i(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Mi(e,n){return du()<=le.DEBUG&&T("QueryEngine","Using full collection scan to execute query:",vu(n)),this.Ni.getDocumentsMatchingQuery(e,n,_t.min())}Bi(e,n,s,r){return this.Ni.getDocumentsMatchingQuery(e,s,r).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e,n,s,r){this.persistence=e,this.Li=n,this.yt=r,this.qi=new Ne(Y),this.Ui=new Un(i=>ws(i),zi),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(s)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Oy(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.qi))}}function By(t,e,n,s){return new CC(t,e,n,s)}async function Py(t,e){const n=R(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,n.Qi(e),n.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],a=[];let c=J();for(const u of r){o.push(u.batchId);for(const l of u.mutations)c=c.add(l.key)}for(const u of i){a.push(u.batchId);for(const l of u.mutations)c=c.add(l.key)}return n.localDocuments.getDocuments(s,c).next(u=>({ji:u,removedBatchIds:o,addedBatchIds:a}))})})}function xC(t,e){const n=R(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=n.Gi.newChangeBuffer({trackRemovals:!0});return function(o,a,c,u){const l=c.batch,h=l.keys();let f=y.resolve();return h.forEach(g=>{f=f.next(()=>u.getEntry(a,g)).next(m=>{const v=c.docVersions.get(g);q(v!==null),m.version.compareTo(v)<0&&(l.applyToRemoteDocument(m,c),m.isValidDocument()&&(m.setReadTime(c.commitVersion),u.addEntry(m)))})}),f.next(()=>o.mutationQueue.removeMutationBatch(a,l))}(n,s,e,i).next(()=>i.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(o){let a=J();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>n.localDocuments.getDocuments(s,r))})}function Ly(t){const e=R(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Cs.getLastRemoteSnapshotVersion(n))}function SC(t,e){const n=R(t),s=e.snapshotVersion;let r=n.qi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Gi.newChangeBuffer({trackRemovals:!0});r=n.qi;const a=[];e.targetChanges.forEach((l,h)=>{const f=r.get(h);if(!f)return;a.push(n.Cs.removeMatchingKeys(i,l.removedDocuments,h).next(()=>n.Cs.addMatchingKeys(i,l.addedDocuments,h)));let g=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.has(h)?g=g.withResumeToken($e.EMPTY_BYTE_STRING,j.min()).withLastLimboFreeSnapshotVersion(j.min()):l.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(l.resumeToken,s)),r=r.insert(h,g),function(m,v,S){return m.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(f,g,l)&&a.push(n.Cs.updateTargetData(i,g))});let c=yt(),u=J();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,l))}),a.push(Fy(i,o,e.documentUpdates).next(l=>{c=l.Wi,u=l.zi})),!s.isEqual(j.min())){const l=n.Cs.getLastRemoteSnapshotVersion(i).next(h=>n.Cs.setTargetsMetadata(i,i.currentSequenceNumber,s));a.push(l)}return y.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.qi=r,i))}function Fy(t,e,n){let s=J(),r=J();return n.forEach(i=>s=s.add(i)),e.getEntries(t,s).next(i=>{let o=yt();return n.forEach((a,c)=>{const u=i.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(j.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):T("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{Wi:o,zi:r}})}function DC(t,e){const n=R(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function pr(t,e){const n=R(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return n.Cs.getTargetData(s,e).next(i=>i?(r=i,y.resolve(r)):n.Cs.allocateTargetId(s).next(o=>(r=new Tn(e,o,0,s.currentSequenceNumber),n.Cs.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=n.qi.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.qi=n.qi.insert(s.targetId,s),n.Ui.set(e,s.targetId)),s})}async function mr(t,e,n){const s=R(t),r=s.qi.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!$n(o))throw o;T("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}s.qi=s.qi.remove(e),s.Ui.delete(r.target)}function aa(t,e,n){const s=R(t);let r=j.min(),i=J();return s.persistence.runTransaction("Execute query","readonly",o=>function(a,c,u){const l=R(a),h=l.Ui.get(u);return h!==void 0?y.resolve(l.qi.get(h)):l.Cs.getTargetData(c,u)}(s,o,wt(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,s.Cs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>s.Li.getDocumentsMatchingQuery(o,e,n?r:j.min(),n?i:J())).next(a=>(Uy(s,Qm(e),a),{documents:a,Hi:i})))}function Vy(t,e){const n=R(t),s=R(n.Cs),r=n.qi.get(e);return r?Promise.resolve(r.target):n.persistence.runTransaction("Get target data","readonly",i=>s.ne(i,e).next(o=>o?o.target:null))}function $y(t,e){const n=R(t),s=n.Ki.get(e)||j.min();return n.persistence.runTransaction("Get new document changes","readonly",r=>n.Gi.getAllFromCollectionGroup(r,e,_m(s,-1),Number.MAX_SAFE_INTEGER)).then(r=>(Uy(n,e,r),r))}function Uy(t,e,n){let s=t.Ki.get(e)||j.min();n.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),t.Ki.set(e,s)}async function NC(t,e,n,s){const r=R(t);let i=J(),o=yt();for(const u of n){const l=e.Ji(u.metadata.name);u.document&&(i=i.add(l));const h=e.Yi(u);h.setReadTime(e.Xi(u.metadata.readTime)),o=o.insert(l,h)}const a=r.Gi.newChangeBuffer({trackRemovals:!0}),c=await pr(r,function(u){return wt(Sr(oe.fromString(`__bundle__/docs/${u}`)))}(s));return r.persistence.runTransaction("Apply bundle documents","readwrite",u=>Fy(u,a,o).next(l=>(a.apply(u),l)).next(l=>r.Cs.removeMatchingKeysForTargetId(u,c.targetId).next(()=>r.Cs.addMatchingKeys(u,i,c.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(u,l.Wi,l.zi)).next(()=>l.Wi)))}async function kC(t,e,n=J()){const s=await pr(t,wt(Vl(e.bundledQuery))),r=R(t);return r.persistence.runTransaction("Save named query","readwrite",i=>{const o=Me(e.readTime);if(s.snapshotVersion.compareTo(o)>=0)return r.Ns.saveNamedQuery(i,e);const a=s.withResumeToken($e.EMPTY_BYTE_STRING,o);return r.qi=r.qi.insert(a.targetId,a),r.Cs.updateTargetData(i,a).next(()=>r.Cs.removeMatchingKeysForTargetId(i,s.targetId)).next(()=>r.Cs.addMatchingKeys(i,n,s.targetId)).next(()=>r.Ns.saveNamedQuery(i,e))})}function Nd(t,e){return`firestore_clients_${t}_${e}`}function kd(t,e,n){let s=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}function Bc(t,e){return`firestore_targets_${t}_${e}`}class ca{constructor(e,n,s,r){this.user=e,this.batchId=n,this.state=s,this.error=r}static Zi(e,n,s){const r=JSON.parse(s);let i,o=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new b(r.error.code,r.error.message))),o?new ca(e,n,r.state,i):(Oe("SharedClientState",`Failed to parse mutation state for ID '${n}': ${s}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ci{constructor(e,n,s){this.targetId=e,this.state=n,this.error=s}static Zi(e,n){const s=JSON.parse(n);let r,i=typeof s=="object"&&["not-current","current","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return i&&s.error&&(i=typeof s.error.message=="string"&&typeof s.error.code=="string",i&&(r=new b(s.error.code,s.error.message))),i?new ci(e,s.state,r):(Oe("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ua{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Zi(e,n){const s=JSON.parse(n);let r=typeof s=="object"&&s.activeTargetIds instanceof Array,i=Ga();for(let o=0;r&&o<s.activeTargetIds.length;++o)r=Dm(s.activeTargetIds[o]),i=i.add(s.activeTargetIds[o]);return r?new ua(e,i):(Oe("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Kl{constructor(e,n){this.clientId=e,this.onlineState=n}static Zi(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Kl(n.clientId,n.onlineState):(Oe("SharedClientState",`Failed to parse online state: ${e}`),null)}}class xu{constructor(){this.activeTargetIds=Ga()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Pc{constructor(e,n,s,r,i){this.window=e,this.Hs=n,this.persistenceKey=s,this.sr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ir=this.rr.bind(this),this.ur=new Ne(Y),this.started=!1,this.cr=[];const o=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ar=Nd(this.persistenceKey,this.sr),this.hr=function(a){return`firestore_sequence_number_${a}`}(this.persistenceKey),this.ur=this.ur.insert(this.sr,new xu),this.lr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.dr=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this._r=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.wr=function(a){return`firestore_online_state_${a}`}(this.persistenceKey),this.mr=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this.ir)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.vi();for(const s of e){if(s===this.sr)continue;const r=this.getItem(Nd(this.persistenceKey,s));if(r){const i=ua.Zi(s,r);i&&(this.ur=this.ur.insert(i.clientId,i))}}this.gr();const n=this.storage.getItem(this.wr);if(n){const s=this.yr(n);s&&this.pr(s)}for(const s of this.cr)this.rr(s);this.cr=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.hr,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ir(this.ur)}isActiveQueryTarget(e){let n=!1;return this.ur.forEach((s,r)=>{r.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Tr(e,"pending")}updateMutationState(e,n,s){this.Tr(e,n,s),this.Er(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Bc(this.persistenceKey,e));if(s){const r=ci.Zi(e,s);r&&(n=r.state)}}return this.Ar.er(e),this.gr(),n}removeLocalQueryTarget(e){this.Ar.nr(e),this.gr()}isLocalQueryTarget(e){return this.Ar.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Bc(this.persistenceKey,e))}updateQueryState(e,n,s){this.Rr(e,n,s)}handleUserChange(e,n,s){n.forEach(r=>{this.Er(r)}),this.currentUser=e,s.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.br(e)}notifyBundleLoaded(e){this.Pr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ir),this.removeItem(this.ar),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return T("SharedClientState","READ",e,n),n}setItem(e,n){T("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){T("SharedClientState","REMOVE",e),this.storage.removeItem(e)}rr(e){const n=e;if(n.storageArea===this.storage){if(T("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ar)return void Oe("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Hs.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.lr.test(n.key)){if(n.newValue==null){const s=this.vr(n.key);return this.Vr(s,null)}{const s=this.Sr(n.key,n.newValue);if(s)return this.Vr(s.clientId,s)}}else if(this.dr.test(n.key)){if(n.newValue!==null){const s=this.Dr(n.key,n.newValue);if(s)return this.Cr(s)}}else if(this._r.test(n.key)){if(n.newValue!==null){const s=this.Nr(n.key,n.newValue);if(s)return this.kr(s)}}else if(n.key===this.wr){if(n.newValue!==null){const s=this.yr(n.newValue);if(s)return this.pr(s)}}else if(n.key===this.hr){const s=function(r){let i=mt.at;if(r!=null)try{const o=JSON.parse(r);q(typeof o=="number"),i=o}catch(o){Oe("SharedClientState","Failed to read sequence number from WebStorage",o)}return i}(n.newValue);s!==mt.at&&this.sequenceNumberHandler(s)}else if(n.key===this.mr){const s=this.Or(n.newValue);await Promise.all(s.map(r=>this.syncEngine.Mr(r)))}}}else this.cr.push(n)})}}get Ar(){return this.ur.get(this.sr)}gr(){this.setItem(this.ar,this.Ar.tr())}Tr(e,n,s){const r=new ca(this.currentUser,e,n,s),i=kd(this.persistenceKey,this.currentUser,e);this.setItem(i,r.tr())}Er(e){const n=kd(this.persistenceKey,this.currentUser,e);this.removeItem(n)}br(e){const n={clientId:this.sr,onlineState:e};this.storage.setItem(this.wr,JSON.stringify(n))}Rr(e,n,s){const r=Bc(this.persistenceKey,e),i=new ci(e,n,s);this.setItem(r,i.tr())}Pr(e){const n=JSON.stringify(Array.from(e));this.setItem(this.mr,n)}vr(e){const n=this.lr.exec(e);return n?n[1]:null}Sr(e,n){const s=this.vr(e);return ua.Zi(s,n)}Dr(e,n){const s=this.dr.exec(e),r=Number(s[1]),i=s[2]!==void 0?s[2]:null;return ca.Zi(new qe(i),r,n)}Nr(e,n){const s=this._r.exec(e),r=Number(s[1]);return ci.Zi(r,n)}yr(e){return Kl.Zi(e)}Or(e){return JSON.parse(e)}async Cr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Fr(e.batchId,e.state,e.error);T("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}kr(e){return this.syncEngine.$r(e.targetId,e.state,e.error)}Vr(e,n){const s=n?this.ur.insert(e,n):this.ur.remove(e),r=this.Ir(this.ur),i=this.Ir(s),o=[],a=[];return i.forEach(c=>{r.has(c)||o.push(c)}),r.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.Br(o,a).then(()=>{this.ur=s})}pr(e){this.ur.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ir(e){let n=Ga();return e.forEach((s,r)=>{n=n.unionWith(r.activeTargetIds)}),n}}class qy{constructor(){this.Lr=new xu,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e){return this.Lr.er(e),this.qr[e]||"not-current"}updateQueryState(e,n,s){this.qr[e]=n}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.qr[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new xu,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{Ur(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}Ur(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){T("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){T("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.oo=n+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(e,n,s,r,i){const o=this.ho(e,n);T("RestConnection","Sending: ",o,s);const a={};return this.lo(a,r,i),this.fo(e,o,a,s).then(c=>(T("RestConnection","Received: ",c),c),c=>{throw cr("RestConnection",`${e} failed with error: `,c,"url: ",o,"request:",s),c})}_o(e,n,s,r,i,o){return this.ao(e,n,s,r,i)}lo(e,n,s){e["X-Goog-Api-Client"]="gl-js/ fire/"+xr,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}ho(e,n){const s=RC[e];return`${this.oo}/v1/${n}:${s}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}fo(e,n,s,r){return new Promise((i,o)=>{const a=new M_;a.setWithCredentials(!0),a.listenOnce(k_.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Oc.NO_ERROR:const u=a.getResponseJson();T("Connection","XHR received:",JSON.stringify(u)),i(u);break;case Oc.TIMEOUT:T("Connection",'RPC "'+e+'" timed out'),o(new b(w.DEADLINE_EXCEEDED,"Request time out"));break;case Oc.HTTP_ERROR:const l=a.getStatus();if(T("Connection",'RPC "'+e+'" failed with status:',l,"response text:",a.getResponseText()),l>0){let h=a.getResponseJson();Array.isArray(h)&&(h=h[0]);const f=h==null?void 0:h.error;if(f&&f.status&&f.message){const g=function(m){const v=m.toLowerCase().replace(/_/g,"-");return Object.values(w).indexOf(v)>=0?v:w.UNKNOWN}(f.status);o(new b(g,f.message))}else o(new b(w.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new b(w.UNAVAILABLE,"Connection failed."));break;default:L()}}finally{T("Connection",'RPC "'+e+'" completed.')}});const c=JSON.stringify(r);a.send(n,"POST",c,s,15)})}wo(e,n,s){const r=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=D_(),o=N_(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new R_({})),this.lo(a.initMessageHeaders,n,s),a.encodeInitMessageHeaders=!0;const c=r.join("");T("Connection","Creating WebChannel: "+c,a);const u=i.createWebChannel(c,a);let l=!1,h=!1;const f=new MC({Hr:m=>{h?T("Connection","Not sending because WebChannel is closed:",m):(l||(T("Connection","Opening WebChannel transport."),u.open(),l=!0),T("Connection","WebChannel sending:",m),u.send(m))},Jr:()=>u.close()}),g=(m,v,S)=>{m.listen(v,N=>{try{S(N)}catch(V){setTimeout(()=>{throw V},0)}})};return g(u,Ao.EventType.OPEN,()=>{h||T("Connection","WebChannel transport opened.")}),g(u,Ao.EventType.CLOSE,()=>{h||(h=!0,T("Connection","WebChannel transport closed"),f.io())}),g(u,Ao.EventType.ERROR,m=>{h||(h=!0,cr("Connection","WebChannel transport errored:",m),f.io(new b(w.UNAVAILABLE,"The operation could not be completed")))}),g(u,Ao.EventType.MESSAGE,m=>{var v;if(!h){const S=m.data[0];q(!!S);const N=S,V=N.error||((v=N[0])===null||v===void 0?void 0:v.error);if(V){T("Connection","WebChannel received error:",V);const M=V.status;let G=function(re){const Ae=Le[re];if(Ae!==void 0)return ny(Ae)}(M),te=V.message;G===void 0&&(G=w.INTERNAL,te="Unknown error status: "+M+" with message "+V.message),h=!0,f.io(new b(G,te)),u.close()}else T("Connection","WebChannel received:",S),f.ro(S)}}),g(o,O_.STAT_EVENT,m=>{m.stat===qf.PROXY?T("Connection","Detected buffering proxy"):m.stat===qf.NOPROXY&&T("Connection","Detected no buffering proxy")}),setTimeout(()=>{f.so()},0),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jy(){return typeof window<"u"?window:null}function Po(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zi(t){return new CT(t,!0)}class Gl{constructor(e,n,s=1e3,r=1.5,i=6e4){this.Hs=e,this.timerId=n,this.mo=s,this.yo=r,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(e){this.cancel();const n=Math.floor(this.Io+this.bo()),s=Math.max(0,Date.now()-this.Eo),r=Math.max(0,n-s);r>0&&T("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Io} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,r,()=>(this.Eo=Date.now(),e())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){this.To!==null&&(this.To.skipDelay(),this.To=null)}cancel(){this.To!==null&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(e,n,s,r,i,o,a,c){this.Hs=e,this.vo=s,this.Vo=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new Gl(e,n)}No(){return this.state===1||this.state===5||this.ko()}ko(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Oo()}async stop(){this.No()&&await this.close(0)}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&this.Do===null&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(e){this.Lo(),this.stream.send(e)}async $o(){if(this.ko())return this.close(0)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}qo(){this.Co&&(this.Co.cancel(),this.Co=null)}async close(e,n){this.Lo(),this.qo(),this.xo.cancel(),this.So++,e!==4?this.xo.reset():n&&n.code===w.RESOURCE_EXHAUSTED?(Oe(n.toString()),Oe("Using maximum backoff delay to prevent overloading the backend."),this.xo.Ao()):n&&n.code===w.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Uo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Zr(n)}Uo(){}auth(){this.state=1;const e=this.Ko(this.So),n=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.So===n&&this.Go(s,r)},s=>{e(()=>{const r=new b(w.UNKNOWN,"Fetching auth token failed: "+s.message);return this.Qo(r)})})}Go(e,n){const s=this.Ko(this.So);this.stream=this.jo(e,n),this.stream.Yr(()=>{s(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(r=>{s(()=>this.Qo(r))}),this.stream.onMessage(r=>{s(()=>this.onMessage(r))})}Oo(){this.state=5,this.xo.Ro(async()=>{this.state=0,this.start()})}Qo(e){return T("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Ko(e){return n=>{this.Hs.enqueueAndForget(()=>this.So===e?n():(T("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class PC extends Qy{constructor(e,n,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,o),this.yt=i}jo(e,n){return this.connection.wo("Listen",e,n)}onMessage(e){this.xo.reset();const n=DT(this.yt,e),s=function(r){if(!("targetChange"in r))return j.min();const i=r.targetChange;return i.targetIds&&i.targetIds.length?j.min():i.readTime?Me(i.readTime):j.min()}(e);return this.listener.Wo(n,s)}zo(e){const n={};n.database=Ni(this.yt),n.addTarget=function(r,i){let o;const a=i.target;return o=ta(a)?{documents:dy(r,a)}:{query:gy(r,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=cy(r,i.resumeToken):i.snapshotVersion.compareTo(j.min())>0&&(o.readTime=gr(r,i.snapshotVersion.toTimestamp())),o}(this.yt,e);const s=kT(this.yt,e);s&&(n.labels=s),this.Bo(n)}Ho(e){const n={};n.database=Ni(this.yt),n.removeTarget=e,this.Bo(n)}}class LC extends Qy{constructor(e,n,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,o),this.yt=i,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}Uo(){this.Jo&&this.Xo([])}jo(e,n){return this.connection.wo("Write",e,n)}onMessage(e){if(q(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();const n=NT(e.writeResults,e.commitTime),s=Me(e.commitTime);return this.listener.Zo(s,n)}return q(!e.writeResults||e.writeResults.length===0),this.Jo=!0,this.listener.tu()}eu(){const e={};e.database=Ni(this.yt),this.Bo(e)}Xo(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>ki(this.yt,s))};this.Bo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC extends class{}{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.yt=r,this.nu=!1}su(){if(this.nu)throw new b(w.FAILED_PRECONDITION,"The client has already been terminated.")}ao(e,n,s){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.connection.ao(e,n,s,r,i)).catch(r=>{throw r.name==="FirebaseError"?(r.code===w.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new b(w.UNKNOWN,r.toString())})}_o(e,n,s,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection._o(e,n,s,i,o,r)).catch(i=>{throw i.name==="FirebaseError"?(i.code===w.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new b(w.UNKNOWN,i.toString())})}terminate(){this.nu=!0}}class VC{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){this.iu===0&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(e){this.state==="Online"?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.lu(),this.iu=0,e==="Online"&&(this.ou=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}au(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(Oe(n),this.ou=!1):T("OnlineStateTracker",n)}lu(){this.ru!==null&&(this.ru.cancel(),this.ru=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $C{constructor(e,n,s,r,i){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.Ur(o=>{s.enqueueAndForget(async()=>{qn(this)&&(T("RemoteStore","Restarting streams for network reachability change."),await async function(a){const c=R(a);c._u.add(4),await kr(c),c.gu.set("Unknown"),c._u.delete(4),await eo(c)}(this))})}),this.gu=new VC(s,r)}}async function eo(t){if(qn(t))for(const e of t.wu)await e(!0)}async function kr(t){for(const e of t.wu)await e(!1)}function Ja(t,e){const n=R(t);n.du.has(e.targetId)||(n.du.set(e.targetId,e),Yl(n)?Wl(n):Rr(n).ko()&&zl(n,e))}function Oi(t,e){const n=R(t),s=Rr(n);n.du.delete(e),s.ko()&&Hy(n,e),n.du.size===0&&(s.ko()?s.Fo():qn(n)&&n.gu.set("Unknown"))}function zl(t,e){t.yu.Ot(e.targetId),Rr(t).zo(e)}function Hy(t,e){t.yu.Ot(e),Rr(t).Ho(e)}function Wl(t){t.yu=new IT({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ne:e=>t.du.get(e)||null}),Rr(t).start(),t.gu.uu()}function Yl(t){return qn(t)&&!Rr(t).No()&&t.du.size>0}function qn(t){return R(t)._u.size===0}function Ky(t){t.yu=void 0}async function UC(t){t.du.forEach((e,n)=>{zl(t,e)})}async function qC(t,e){Ky(t),Yl(t)?(t.gu.hu(e),Wl(t)):t.gu.set("Unknown")}async function jC(t,e,n){if(t.gu.set("Online"),e instanceof ay&&e.state===2&&e.cause)try{await async function(s,r){const i=r.cause;for(const o of r.targetIds)s.du.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.du.delete(o),s.yu.removeTarget(o))}(t,e)}catch(s){T("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),await la(t,s)}else if(e instanceof Mo?t.yu.Kt(e):e instanceof oy?t.yu.Jt(e):t.yu.jt(e),!n.isEqual(j.min()))try{const s=await Ly(t.localStore);n.compareTo(s)>=0&&await function(r,i){const o=r.yu.Zt(i);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const u=r.du.get(c);u&&r.du.set(c,u.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const c=r.du.get(a);if(!c)return;r.du.set(a,c.withResumeToken($e.EMPTY_BYTE_STRING,c.snapshotVersion)),Hy(r,a);const u=new Tn(c.target,a,1,c.sequenceNumber);zl(r,u)}),r.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(s){T("RemoteStore","Failed to raise snapshot:",s),await la(t,s)}}async function la(t,e,n){if(!$n(e))throw e;t._u.add(1),await kr(t),t.gu.set("Offline"),n||(n=()=>Ly(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{T("RemoteStore","Retrying IndexedDB access"),await n(),t._u.delete(1),await eo(t)})}function Gy(t,e){return e().catch(n=>la(t,n,e))}async function Or(t){const e=R(t),n=Mn(e);let s=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;QC(e);)try{const r=await DC(e.localStore,s);if(r===null){e.fu.length===0&&n.Fo();break}s=r.batchId,HC(e,r)}catch(r){await la(e,r)}zy(e)&&Wy(e)}function QC(t){return qn(t)&&t.fu.length<10}function HC(t,e){t.fu.push(e);const n=Mn(t);n.ko()&&n.Yo&&n.Xo(e.mutations)}function zy(t){return qn(t)&&!Mn(t).No()&&t.fu.length>0}function Wy(t){Mn(t).start()}async function KC(t){Mn(t).eu()}async function GC(t){const e=Mn(t);for(const n of t.fu)e.Xo(n.mutations)}async function zC(t,e,n){const s=t.fu.shift(),r=Ll.from(s,e,n);await Gy(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await Or(t)}async function WC(t,e){e&&Mn(t).Yo&&await async function(n,s){if(r=s.code,ty(r)&&r!==w.ABORTED){const i=n.fu.shift();Mn(n).Mo(),await Gy(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Or(n)}var r}(t,e),zy(t)&&Wy(t)}async function Rd(t,e){const n=R(t);n.asyncQueue.verifyOperationInProgress(),T("RemoteStore","RemoteStore received new credentials");const s=qn(n);n._u.add(3),await kr(n),s&&n.gu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n._u.delete(3),await eo(n)}async function Su(t,e){const n=R(t);e?(n._u.delete(2),await eo(n)):e||(n._u.add(2),await kr(n),n.gu.set("Unknown"))}function Rr(t){return t.pu||(t.pu=function(e,n,s){const r=R(e);return r.su(),new PC(n,r.connection,r.authCredentials,r.appCheckCredentials,r.yt,s)}(t.datastore,t.asyncQueue,{Yr:UC.bind(null,t),Zr:qC.bind(null,t),Wo:jC.bind(null,t)}),t.wu.push(async e=>{e?(t.pu.Mo(),Yl(t)?Wl(t):t.gu.set("Unknown")):(await t.pu.stop(),Ky(t))})),t.pu}function Mn(t){return t.Iu||(t.Iu=function(e,n,s){const r=R(e);return r.su(),new LC(n,r.connection,r.authCredentials,r.appCheckCredentials,r.yt,s)}(t.datastore,t.asyncQueue,{Yr:KC.bind(null,t),Zr:WC.bind(null,t),tu:GC.bind(null,t),Zo:zC.bind(null,t)}),t.wu.push(async e=>{e?(t.Iu.Mo(),await Or(t)):(await t.Iu.stop(),t.fu.length>0&&(T("RemoteStore",`Stopping write stream with ${t.fu.length} pending writes`),t.fu=[]))})),t.Iu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new Qe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,s,r,i){const o=Date.now()+s,a=new Jl(e,n,o,r,i);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new b(w.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Mr(t,e){if(Oe("AsyncQueue",`${e}: ${t}`),$n(t))return new b(w.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e){this.comparator=e?(n,s)=>e(n,s)||k.comparator(n.key,s.key):(n,s)=>k.comparator(n.key,s.key),this.keyedMap=Yr(),this.sortedSet=new Ne(this.comparator)}static emptySet(e){return new Xs(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Xs)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new Xs;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(){this.Tu=new Ne(k.comparator)}track(e){const n=e.doc.key,s=this.Tu.get(n);s?e.type!==0&&s.type===3?this.Tu=this.Tu.insert(n,e):e.type===3&&s.type!==1?this.Tu=this.Tu.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.Tu=this.Tu.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.Tu=this.Tu.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.Tu=this.Tu.remove(n):e.type===1&&s.type===2?this.Tu=this.Tu.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.Tu=this.Tu.insert(n,{type:2,doc:e.doc}):L():this.Tu=this.Tu.insert(n,e)}Eu(){const e=[];return this.Tu.inorderTraversal((n,s)=>{e.push(s)}),e}}class yr{constructor(e,n,s,r,i,o,a,c,u){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,s,r,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new yr(e,n,Xs.emptySet(n),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Wi(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(){this.Au=void 0,this.listeners=[]}}class JC{constructor(){this.queries=new Un(e=>jm(e),Wi),this.onlineState="Unknown",this.Ru=new Set}}async function Xl(t,e){const n=R(t),s=e.query;let r=!1,i=n.queries.get(s);if(i||(r=!0,i=new YC),r)try{i.Au=await n.onListen(s)}catch(o){const a=Mr(o,`Initialization of query '${vu(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.listeners.push(e),e.bu(n.onlineState),i.Au&&e.Pu(i.Au)&&eh(n)}async function Zl(t,e){const n=R(t),s=e.query;let r=!1;const i=n.queries.get(s);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),r=i.listeners.length===0)}if(r)return n.queries.delete(s),n.onUnlisten(s)}function XC(t,e){const n=R(t);let s=!1;for(const r of e){const i=r.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.Pu(r)&&(s=!0);o.Au=r}}s&&eh(n)}function ZC(t,e,n){const s=R(t),r=s.queries.get(e);if(r)for(const i of r.listeners)i.onError(n);s.queries.delete(e)}function eh(t){t.Ru.forEach(e=>{e.next()})}class th{constructor(e,n,s){this.query=e,this.vu=n,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=s||{}}Pu(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new yr(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),n=!0):this.Cu(e,this.onlineState)&&(this.xu(e),n=!0),this.Su=e,n}onError(e){this.vu.error(e)}bu(e){this.onlineState=e;let n=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),n=!0),n}Cu(e,n){if(!e.fromCache)return!0;const s=n!=="Offline";return(!this.options.Nu||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Du(e){if(e.docChanges.length>0)return!0;const n=this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}xu(e){e=yr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ex{constructor(e,n){this.ku=e,this.byteLength=n}Ou(){return"metadata"in this.ku}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e){this.yt=e}Ji(e){return Kt(this.yt,e)}Yi(e){return e.metadata.exists?fy(this.yt,e.document,!1):ve.newNoDocument(this.Ji(e.metadata.name),this.Xi(e.metadata.readTime))}Xi(e){return Me(e)}}class tx{constructor(e,n,s){this.Mu=e,this.localStore=n,this.yt=s,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Yy(e)}Fu(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.ku.namedQuery)this.queries.push(e.ku.namedQuery);else if(e.ku.documentMetadata){this.documents.push({metadata:e.ku.documentMetadata}),e.ku.documentMetadata.exists||++n;const s=oe.fromString(e.ku.documentMetadata.name);this.collectionGroups.add(s.get(s.length-2))}else e.ku.document&&(this.documents[this.documents.length-1].document=e.ku.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}$u(e){const n=new Map,s=new Bd(this.yt);for(const r of e)if(r.metadata.queries){const i=s.Ji(r.metadata.name);for(const o of r.metadata.queries){const a=(n.get(o)||J()).add(i);n.set(o,a)}}return n}async complete(){const e=await NC(this.localStore,new Bd(this.yt),this.documents,this.Mu.id),n=this.$u(this.documents);for(const s of this.queries)await kC(this.localStore,s,n.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Bu:this.collectionGroups,Lu:e}}}function Yy(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e){this.key=e}}class Xy{constructor(e){this.key=e}}class Zy{constructor(e,n){this.query=e,this.qu=n,this.Uu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=J(),this.mutatedKeys=J(),this.Gu=Hm(e),this.Qu=new Xs(this.Gu)}get ju(){return this.qu}Wu(e,n){const s=n?n.zu:new Md,r=n?n.Qu:this.Qu;let i=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((l,h)=>{const f=r.get(l),g=Rl(this.query,h)?h:null,m=!!f&&this.mutatedKeys.has(f.key),v=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let S=!1;f&&g?f.data.isEqual(g.data)?m!==v&&(s.track({type:3,doc:g}),S=!0):this.Hu(f,g)||(s.track({type:2,doc:g}),S=!0,(c&&this.Gu(g,c)>0||u&&this.Gu(g,u)<0)&&(a=!0)):!f&&g?(s.track({type:0,doc:g}),S=!0):f&&!g&&(s.track({type:1,doc:f}),S=!0,(c||u)&&(a=!0)),S&&(g?(o=o.add(g),i=v?i.add(l):i.delete(l)):(o=o.delete(l),i=i.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),i=i.delete(l.key),s.track({type:1,doc:l})}return{Qu:o,zu:s,$i:a,mutatedKeys:i}}Hu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s){const r=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;const i=e.zu.Eu();i.sort((u,l)=>function(h,f){const g=m=>{switch(m){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return L()}};return g(h)-g(f)}(u.type,l.type)||this.Gu(u.doc,l.doc)),this.Ju(s);const o=n?this.Yu():[],a=this.Ku.size===0&&this.current?1:0,c=a!==this.Uu;return this.Uu=a,i.length!==0||c?{snapshot:new yr(this.query,e.Qu,r,i,e.mutatedKeys,a===0,c,!1,!!s&&s.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}bu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new Md,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(e){return!this.qu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}Ju(e){e&&(e.addedDocuments.forEach(n=>this.qu=this.qu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.qu=this.qu.delete(n)),this.current=e.current)}Yu(){if(!this.current)return[];const e=this.Ku;this.Ku=J(),this.Qu.forEach(s=>{this.Zu(s.key)&&(this.Ku=this.Ku.add(s.key))});const n=[];return e.forEach(s=>{this.Ku.has(s)||n.push(new Xy(s))}),this.Ku.forEach(s=>{e.has(s)||n.push(new Jy(s))}),n}tc(e){this.qu=e.Hi,this.Ku=J();const n=this.Wu(e.documents);return this.applyChanges(n,!0)}ec(){return yr.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,this.Uu===0,this.hasCachedResults)}}class nx{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class sx{constructor(e){this.key=e,this.nc=!1}}class rx{constructor(e,n,s,r,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.sc={},this.ic=new Un(a=>jm(a),Wi),this.rc=new Map,this.oc=new Set,this.uc=new Ne(k.comparator),this.cc=new Map,this.ac=new ql,this.hc={},this.lc=new Map,this.fc=bs.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return this.dc===!0}}async function ix(t,e){const n=oh(t);let s,r;const i=n.ic.get(e);if(i)s=i.targetId,n.sharedClientState.addLocalQueryTarget(s),r=i.view.ec();else{const o=await pr(n.localStore,wt(e));n.isPrimaryClient&&Ja(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);s=o.targetId,r=await nh(n,e,s,a==="current",o.resumeToken)}return r}async function nh(t,e,n,s,r){t._c=(h,f,g)=>async function(m,v,S,N){let V=v.view.Wu(S);V.$i&&(V=await aa(m.localStore,v.query,!1).then(({documents:te})=>v.view.Wu(te,V)));const M=N&&N.targetChanges.get(v.targetId),G=v.view.applyChanges(V,m.isPrimaryClient,M);return Du(m,v.targetId,G.Xu),G.snapshot}(t,h,f,g);const i=await aa(t.localStore,e,!0),o=new Zy(e,i.Hi),a=o.Wu(i.documents),c=Xi.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline",r),u=o.applyChanges(a,t.isPrimaryClient,c);Du(t,n,u.Xu);const l=new nx(e,n,o);return t.ic.set(e,l),t.rc.has(n)?t.rc.get(n).push(e):t.rc.set(n,[e]),u.snapshot}async function ox(t,e){const n=R(t),s=n.ic.get(e),r=n.rc.get(s.targetId);if(r.length>1)return n.rc.set(s.targetId,r.filter(i=>!Wi(i,e))),void n.ic.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await mr(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),Oi(n.remoteStore,s.targetId),wr(n,s.targetId)}).catch(Vn)):(wr(n,s.targetId),await mr(n.localStore,s.targetId,!0))}async function ax(t,e,n){const s=ah(t);try{const r=await function(i,o){const a=R(i),c=Te.now(),u=o.reduce((f,g)=>f.add(g.key),J());let l,h;return a.persistence.runTransaction("Locally write mutations","readwrite",f=>{let g=yt(),m=J();return a.Gi.getEntries(f,u).next(v=>{g=v,g.forEach((S,N)=>{N.isValidDocument()||(m=m.add(S))})}).next(()=>a.localDocuments.getOverlayedDocuments(f,g)).next(v=>{l=v;const S=[];for(const N of o){const V=mT(N,l.get(N.key).overlayedDocument);V!=null&&S.push(new cn(N.key,V,Um(V.value.mapValue),_e.exists(!0)))}return a.mutationQueue.addMutationBatch(f,c,S,o)}).next(v=>{h=v;const S=v.applyToLocalDocumentSet(l,m);return a.documentOverlayCache.saveOverlays(f,v.batchId,S)})}).then(()=>({batchId:h.batchId,changes:ry(l)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(i,o,a){let c=i.hc[i.currentUser.toKey()];c||(c=new Ne(Y)),c=c.insert(o,a),i.hc[i.currentUser.toKey()]=c}(s,r.batchId,n),await un(s,r.changes),await Or(s.remoteStore)}catch(r){const i=Mr(r,"Failed to persist write");n.reject(i)}}async function ew(t,e){const n=R(t);try{const s=await SC(n.localStore,e);e.targetChanges.forEach((r,i)=>{const o=n.cc.get(i);o&&(q(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.nc=!0:r.modifiedDocuments.size>0?q(o.nc):r.removedDocuments.size>0&&(q(o.nc),o.nc=!1))}),await un(n,s,e)}catch(s){await Vn(s)}}function Pd(t,e,n){const s=R(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.ic.forEach((i,o)=>{const a=o.view.bu(e);a.snapshot&&r.push(a.snapshot)}),function(i,o){const a=R(i);a.onlineState=o;let c=!1;a.queries.forEach((u,l)=>{for(const h of l.listeners)h.bu(o)&&(c=!0)}),c&&eh(a)}(s.eventManager,e),r.length&&s.sc.Wo(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function cx(t,e,n){const s=R(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.cc.get(e),i=r&&r.key;if(i){let o=new Ne(k.comparator);o=o.insert(i,ve.newNoDocument(i,j.min()));const a=J().add(i),c=new Ji(j.min(),new Map,new me(Y),o,a);await ew(s,c),s.uc=s.uc.remove(i),s.cc.delete(e),ih(s)}else await mr(s.localStore,e,!1).then(()=>wr(s,e,n)).catch(Vn)}async function ux(t,e){const n=R(t),s=e.batch.batchId;try{const r=await xC(n.localStore,e);rh(n,s,null),sh(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await un(n,r)}catch(r){await Vn(r)}}async function lx(t,e,n){const s=R(t);try{const r=await function(i,o){const a=R(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return a.mutationQueue.lookupMutationBatch(c,o).next(l=>(q(l!==null),u=l.keys(),a.mutationQueue.removeMutationBatch(c,l))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>a.localDocuments.getDocuments(c,u))})}(s.localStore,e);rh(s,e,n),sh(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await un(s,r)}catch(r){await Vn(r)}}async function hx(t,e){const n=R(t);qn(n.remoteStore)||T("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=await function(i){const o=R(i);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(n.localStore);if(s===-1)return void e.resolve();const r=n.lc.get(s)||[];r.push(e),n.lc.set(s,r)}catch(s){const r=Mr(s,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}function sh(t,e){(t.lc.get(e)||[]).forEach(n=>{n.resolve()}),t.lc.delete(e)}function rh(t,e,n){const s=R(t);let r=s.hc[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),s.hc[s.currentUser.toKey()]=r}}function wr(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.rc.get(e))t.ic.delete(s),n&&t.sc.wc(s,n);t.rc.delete(e),t.isPrimaryClient&&t.ac.ls(e).forEach(s=>{t.ac.containsKey(s)||tw(t,s)})}function tw(t,e){t.oc.delete(e.path.canonicalString());const n=t.uc.get(e);n!==null&&(Oi(t.remoteStore,n),t.uc=t.uc.remove(e),t.cc.delete(n),ih(t))}function Du(t,e,n){for(const s of n)s instanceof Jy?(t.ac.addReference(s.key,e),fx(t,s)):s instanceof Xy?(T("SyncEngine","Document no longer in limbo: "+s.key),t.ac.removeReference(s.key,e),t.ac.containsKey(s.key)||tw(t,s.key)):L()}function fx(t,e){const n=e.key,s=n.path.canonicalString();t.uc.get(n)||t.oc.has(s)||(T("SyncEngine","New document in limbo: "+n),t.oc.add(s),ih(t))}function ih(t){for(;t.oc.size>0&&t.uc.size<t.maxConcurrentLimboResolutions;){const e=t.oc.values().next().value;t.oc.delete(e);const n=new k(oe.fromString(e)),s=t.fc.next();t.cc.set(s,new sx(n)),t.uc=t.uc.insert(n,s),Ja(t.remoteStore,new Tn(wt(Sr(n.path)),s,2,mt.at))}}async function un(t,e,n){const s=R(t),r=[],i=[],o=[];s.ic.isEmpty()||(s.ic.forEach((a,c)=>{o.push(s._c(c,e,n).then(u=>{if((u||n)&&s.isPrimaryClient&&s.sharedClientState.updateQueryState(c.targetId,u!=null&&u.fromCache?"not-current":"current"),u){r.push(u);const l=Hl.Ci(c.targetId,u);i.push(l)}}))}),await Promise.all(o),s.sc.Wo(r),await async function(a,c){const u=R(a);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",l=>y.forEach(c,h=>y.forEach(h.Si,f=>u.persistence.referenceDelegate.addReference(l,h.targetId,f)).next(()=>y.forEach(h.Di,f=>u.persistence.referenceDelegate.removeReference(l,h.targetId,f)))))}catch(l){if(!$n(l))throw l;T("LocalStore","Failed to update sequence numbers: "+l)}for(const l of c){const h=l.targetId;if(!l.fromCache){const f=u.qi.get(h),g=f.snapshotVersion,m=f.withLastLimboFreeSnapshotVersion(g);u.qi=u.qi.insert(h,m)}}}(s.localStore,i))}async function dx(t,e){const n=R(t);if(!n.currentUser.isEqual(e)){T("SyncEngine","User change. New user:",e.toKey());const s=await Py(n.localStore,e);n.currentUser=e,function(r,i){r.lc.forEach(o=>{o.forEach(a=>{a.reject(new b(w.CANCELLED,i))})}),r.lc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await un(n,s.ji)}}function gx(t,e){const n=R(t),s=n.cc.get(e);if(s&&s.nc)return J().add(s.key);{let r=J();const i=n.rc.get(e);if(!i)return r;for(const o of i){const a=n.ic.get(o);r=r.unionWith(a.view.ju)}return r}}async function px(t,e){const n=R(t),s=await aa(n.localStore,e.query,!0),r=e.view.tc(s);return n.isPrimaryClient&&Du(n,e.targetId,r.Xu),r}async function mx(t,e){const n=R(t);return $y(n.localStore,e).then(s=>un(n,s))}async function yx(t,e,n,s){const r=R(t),i=await function(o,a){const c=R(o),u=R(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",l=>u.Tn(l,a).next(h=>h?c.localDocuments.getDocuments(l,h):y.resolve(null)))}(r.localStore,e);i!==null?(n==="pending"?await Or(r.remoteStore):n==="acknowledged"||n==="rejected"?(rh(r,e,s||null),sh(r,e),function(o,a){R(R(o).mutationQueue).An(a)}(r.localStore,e)):L(),await un(r,i)):T("SyncEngine","Cannot apply mutation batch with id: "+e)}async function wx(t,e){const n=R(t);if(oh(n),ah(n),e===!0&&n.dc!==!0){const s=n.sharedClientState.getAllActiveQueryTargets(),r=await Ld(n,s.toArray());n.dc=!0,await Su(n.remoteStore,!0);for(const i of r)Ja(n.remoteStore,i)}else if(e===!1&&n.dc!==!1){const s=[];let r=Promise.resolve();n.rc.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?s.push(o):r=r.then(()=>(wr(n,o),mr(n.localStore,o,!0))),Oi(n.remoteStore,o)}),await r,await Ld(n,s),function(i){const o=R(i);o.cc.forEach((a,c)=>{Oi(o.remoteStore,c)}),o.ac.fs(),o.cc=new Map,o.uc=new Ne(k.comparator)}(n),n.dc=!1,await Su(n.remoteStore,!1)}}async function Ld(t,e,n){const s=R(t),r=[],i=[];for(const o of e){let a;const c=s.rc.get(o);if(c&&c.length!==0){a=await pr(s.localStore,wt(c[0]));for(const u of c){const l=s.ic.get(u),h=await px(s,l);h.snapshot&&i.push(h.snapshot)}}else{const u=await Vy(s.localStore,o);a=await pr(s.localStore,u),await nh(s,nw(u),o,!1,a.resumeToken)}r.push(a)}return s.sc.Wo(i),r}function nw(t){return qm(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Ax(t){const e=R(t);return R(R(e.localStore).persistence).vi()}async function vx(t,e,n,s){const r=R(t);if(r.dc)return void T("SyncEngine","Ignoring unexpected query state notification.");const i=r.rc.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await $y(r.localStore,Qm(i[0])),a=Ji.createSynthesizedRemoteEventForCurrentChange(e,n==="current",$e.EMPTY_BYTE_STRING);await un(r,o,a);break}case"rejected":await mr(r.localStore,e,!0),wr(r,e,s);break;default:L()}}async function Ex(t,e,n){const s=oh(t);if(s.dc){for(const r of e){if(s.rc.has(r)){T("SyncEngine","Adding an already active target "+r);continue}const i=await Vy(s.localStore,r),o=await pr(s.localStore,i);await nh(s,nw(i),o.targetId,!1,o.resumeToken),Ja(s.remoteStore,o)}for(const r of n)s.rc.has(r)&&await mr(s.localStore,r,!1).then(()=>{Oi(s.remoteStore,r),wr(s,r)}).catch(Vn)}}function oh(t){const e=R(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ew.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=gx.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=cx.bind(null,e),e.sc.Wo=XC.bind(null,e.eventManager),e.sc.wc=ZC.bind(null,e.eventManager),e}function ah(t){const e=R(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ux.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lx.bind(null,e),e}function Ix(t,e,n){const s=R(t);(async function(r,i,o){try{const a=await i.getMetadata();if(await function(h,f){const g=R(h),m=Me(f.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",v=>g.Ns.getBundleMetadata(v,f.id)).then(v=>!!v&&v.createTime.compareTo(m)>=0)}(r.localStore,a))return await i.close(),o._completeWith(function(h){return{taskState:"Success",documentsLoaded:h.totalDocuments,bytesLoaded:h.totalBytes,totalDocuments:h.totalDocuments,totalBytes:h.totalBytes}}(a)),Promise.resolve(new Set);o._updateProgress(Yy(a));const c=new tx(a,r.localStore,i.yt);let u=await i.mc();for(;u;){const h=await c.Fu(u);h&&o._updateProgress(h),u=await i.mc()}const l=await c.complete();return await un(r,l.Lu,void 0),await function(h,f){const g=R(h);return g.persistence.runTransaction("Save bundle","readwrite",m=>g.Ns.saveBundleMetadata(m,f))}(r.localStore,a),o._completeWith(l.progress),Promise.resolve(l.Bu)}catch(a){return cr("SyncEngine",`Loading bundle failed with ${a}`),o._failWith(a),Promise.resolve(new Set)}})(s,e,n).then(r=>{s.sharedClientState.notifyBundleLoaded(r)})}class sw{constructor(){this.synchronizeTabs=!1}async initialize(e){this.yt=Zi(e.databaseInfo.databaseId),this.sharedClientState=this.gc(e),this.persistence=this.yc(e),await this.persistence.start(),this.localStore=this.Ic(e),this.gcScheduler=this.Tc(e,this.localStore),this.indexBackfillerScheduler=this.Ec(e,this.localStore)}Tc(e,n){return null}Ec(e,n){return null}Ic(e){return By(this.persistence,new My,e.initialUser,this.yt)}yc(e){return new Ry(Ya.Bs,this.yt)}gc(e){return new qy}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class rw extends sw{constructor(e,n,s){super(),this.Ac=e,this.cacheSizeBytes=n,this.forceOwnership=s,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ac.initialize(this,e),await ah(this.Ac.syncEngine),await Or(this.Ac.remoteStore),await this.persistence.li(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Ic(e){return By(this.persistence,new My,e.initialUser,this.yt)}Tc(e,n){const s=this.persistence.referenceDelegate.garbageCollector;return new fC(s,e.asyncQueue,n)}Ec(e,n){const s=new Y_(n,this.persistence);return new W_(e.asyncQueue,s)}yc(e){const n=Ql(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?pt.withCacheSize(this.cacheSizeBytes):pt.DEFAULT;return new jl(this.synchronizeTabs,n,e.clientId,s,e.asyncQueue,jy(),Po(),this.yt,this.sharedClientState,!!this.forceOwnership)}gc(e){return new qy}}class bx extends rw{constructor(e,n){super(e,n,!1),this.Ac=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ac.syncEngine;this.sharedClientState instanceof Pc&&(this.sharedClientState.syncEngine={Fr:yx.bind(null,n),$r:vx.bind(null,n),Br:Ex.bind(null,n),vi:Ax.bind(null,n),Mr:mx.bind(null,n)},await this.sharedClientState.start()),await this.persistence.li(async s=>{await wx(this.Ac.syncEngine,s),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start():s||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(s&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():s||this.indexBackfillerScheduler.stop())})}gc(e){const n=jy();if(!Pc.C(n))throw new b(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=Ql(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Pc(n,e.asyncQueue,s,e.clientId,e.initialUser)}}class ch{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Pd(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=dx.bind(null,this.syncEngine),await Su(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new JC}createDatastore(e){const n=Zi(e.databaseInfo.databaseId),s=(r=e.databaseInfo,new BC(r));var r;return function(i,o,a,c){return new FC(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return n=this.localStore,s=this.datastore,r=e.asyncQueue,i=a=>Pd(this.syncEngine,a,0),o=Od.C()?new Od:new OC,new $C(n,s,r,i,o);var n,s,r,i,o}createSyncEngine(e,n){return function(s,r,i,o,a,c,u){const l=new rx(s,r,i,o,a,c);return u&&(l.dc=!0),l}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=R(e);T("RemoteStore","RemoteStore shutting down."),n._u.add(5),await kr(n),n.mu.shutdown(),n.gu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uh(t,e,n){if(!n)throw new b(w.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function iw(t,e,n,s){if(e===!0&&s===!0)throw new b(w.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Fd(t){if(!k.isDocumentKey(t))throw new b(w.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Vd(t){if(k.isDocumentKey(t))throw new b(w.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Xa(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":L()}function ue(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new b(w.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Xa(t);throw new b(w.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function ow(t,e){if(e<=0)throw new b(w.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $d=new Map;class Ud{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new b(w.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new b(w.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,iw("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e,n,s,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ud({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new b(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new b(w.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ud(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new L_;switch(n.type){case"gapi":const s=n.client;return new U_(s,n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new b(w.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=$d.get(e);n&&(T("ComponentProvider","Removing Datastore"),$d.delete(e),n.terminate())}(this),Promise.resolve()}}function _x(t,e,n,s={}){var r;const i=(t=ue(t,to))._getSettings();if(i.host!=="firestore.googleapis.com"&&i.host!==e&&cr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:`${e}:${n}`,ssl:!1})),s.mockUserToken){let o,a;if(typeof s.mockUserToken=="string")o=s.mockUserToken,a=qe.MOCK_USER;else{o=ab(s.mockUserToken,(r=t._app)===null||r===void 0?void 0:r.options.projectId);const c=s.mockUserToken.sub||s.mockUserToken.user_id;if(!c)throw new b(w.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new qe(c)}t._authCredentials=new F_(new vm(o,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Gt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ee(this.firestore,e,this._key)}}class Xe{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Xe(this.firestore,e,this._query)}}class Gt extends Xe{constructor(e,n,s){super(e,n,Sr(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ee(this.firestore,null,new k(e))}withConverter(e){return new Gt(this.firestore,e,this._path)}}function aw(t,e,...n){if(t=Fe(t),uh("collection","path",e),t instanceof to){const s=oe.fromString(e,...n);return Vd(s),new Gt(t,null,s)}{if(!(t instanceof Ee||t instanceof Gt))throw new b(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(oe.fromString(e,...n));return Vd(s),new Gt(t.firestore,null,s)}}function Tx(t,e){if(t=ue(t,to),uh("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new b(w.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Xe(t,null,function(n){return new an(oe.emptyPath(),n)}(e))}function ha(t,e,...n){if(t=Fe(t),arguments.length===1&&(e=Em.R()),uh("doc","path",e),t instanceof to){const s=oe.fromString(e,...n);return Fd(s),new Ee(t,null,new k(s))}{if(!(t instanceof Ee||t instanceof Gt))throw new b(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(oe.fromString(e,...n));return Fd(s),new Ee(t.firestore,t instanceof Gt?t.converter:null,new k(s))}}function cw(t,e){return t=Fe(t),e=Fe(e),(t instanceof Ee||t instanceof Gt)&&(e instanceof Ee||e instanceof Gt)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function uw(t,e){return t=Fe(t),e=Fe(e),t instanceof Xe&&e instanceof Xe&&t.firestore===e.firestore&&Wi(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qd(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const s={value:t.slice(n,n+e),done:!1};return n+=e,s}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Rc(this.observer.next,e)}error(e){this.observer.error?this.Rc(this.observer.error,e):Oe("Uncaught Error in snapshot listener:",e.toString())}bc(){this.muted=!0}Rc(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(e,n){this.Pc=e,this.yt=n,this.metadata=new Qe,this.buffer=new Uint8Array,this.vc=new TextDecoder("utf-8"),this.Vc().then(s=>{s&&s.Ou()?this.metadata.resolve(s.ku.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(s==null?void 0:s.ku)}`))},s=>this.metadata.reject(s))}close(){return this.Pc.cancel()}async getMetadata(){return this.metadata.promise}async mc(){return await this.getMetadata(),this.Vc()}async Vc(){const e=await this.Sc();if(e===null)return null;const n=this.vc.decode(e),s=Number(n);isNaN(s)&&this.Dc(`length string (${n}) is not valid number`);const r=await this.Cc(s);return new ex(JSON.parse(r),e.length+s)}xc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async Sc(){for(;this.xc()<0&&!await this.Nc(););if(this.buffer.length===0)return null;const e=this.xc();e<0&&this.Dc("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async Cc(e){for(;this.buffer.length<e;)await this.Nc()&&this.Dc("Reached the end of bundle when more is expected.");const n=this.vc.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Dc(e){throw this.Pc.cancel(),new Error(`Invalid bundle format: ${e}`)}async Nc(){const e=await this.Pc.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new b(w.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(s,r){const i=R(s),o=Ni(i.yt)+"/documents",a={documents:r.map(h=>Di(i.yt,h))},c=await i._o("BatchGetDocuments",o,a,r.length),u=new Map;c.forEach(h=>{const f=ST(i.yt,h);u.set(f.key.toString(),f)});const l=[];return r.forEach(h=>{const f=u.get(h.toString());q(!!f),l.push(f)}),l}(this.datastore,e);return n.forEach(s=>this.recordVersion(s)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastWriteError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new Nr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,s)=>{const r=k.fromPath(s);this.mutations.push(new Ml(r,this.precondition(r)))}),await async function(n,s){const r=R(n),i=Ni(r.yt)+"/documents",o={writes:s.map(a=>ki(r.yt,a))};await r.ao("Commit",i,o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw L();n=j.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!n.isEqual(s))throw new b(w.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(j.min())?_e.exists(!1):_e.updateTime(n):_e.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(j.min()))throw new b(w.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _e.updateTime(n)}return _e.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(e,n,s,r,i){this.asyncQueue=e,this.datastore=n,this.options=s,this.updateFunction=r,this.deferred=i,this.kc=s.maxAttempts,this.xo=new Gl(this.asyncQueue,"transaction_retry")}run(){this.kc-=1,this.Oc()}Oc(){this.xo.Ro(async()=>{const e=new xx(this.datastore),n=this.Mc(e);n&&n.then(s=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(s)}).catch(r=>{this.Fc(r)}))}).catch(s=>{this.Fc(s)})})}Mc(e){try{const n=this.updateFunction(e);return!Gi(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Fc(e){this.kc>0&&this.$c(e)?(this.kc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Oc(),Promise.resolve()))):this.deferred.reject(e)}$c(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!ty(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{constructor(e,n,s,r){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=qe.UNAUTHENTICATED,this.clientId=Em.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(s,async i=>{T("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(s,i=>(T("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new b(w.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Qe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=Mr(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function lw(t,e){t.asyncQueue.verifyOperationInProgress(),T("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async r=>{s.isEqual(r)||(await Py(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function hw(t,e){t.asyncQueue.verifyOperationInProgress();const n=await lh(t);T("FirestoreClient","Initializing OnlineComponentProvider");const s=await t.getConfiguration();await e.initialize(n,s),t.setCredentialChangeListener(r=>Rd(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Rd(e.remoteStore,i)),t.onlineComponents=e}async function lh(t){return t.offlineComponents||(T("FirestoreClient","Using default OfflineComponentProvider"),await lw(t,new sw)),t.offlineComponents}async function ec(t){return t.onlineComponents||(T("FirestoreClient","Using default OnlineComponentProvider"),await hw(t,new ch)),t.onlineComponents}function fw(t){return lh(t).then(e=>e.persistence)}function hh(t){return lh(t).then(e=>e.localStore)}function dw(t){return ec(t).then(e=>e.remoteStore)}function fh(t){return ec(t).then(e=>e.syncEngine)}function Nx(t){return ec(t).then(e=>e.datastore)}async function Ar(t){const e=await ec(t),n=e.eventManager;return n.onListen=ix.bind(null,e.syncEngine),n.onUnlisten=ox.bind(null,e.syncEngine),n}function kx(t){return t.asyncQueue.enqueue(async()=>{const e=await fw(t),n=await dw(t);return e.setNetworkEnabled(!0),function(s){const r=R(s);return r._u.delete(0),eo(r)}(n)})}function Ox(t){return t.asyncQueue.enqueue(async()=>{const e=await fw(t),n=await dw(t);return e.setNetworkEnabled(!1),async function(s){const r=R(s);r._u.add(0),await kr(r),r.gu.set("Offline")}(n)})}function Rx(t,e){const n=new Qe;return t.asyncQueue.enqueueAndForget(async()=>async function(s,r,i){try{const o=await function(a,c){const u=R(a);return u.persistence.runTransaction("read document","readonly",l=>u.localDocuments.getDocument(l,c))}(s,r);o.isFoundDocument()?i.resolve(o):o.isNoDocument()?i.resolve(null):i.reject(new b(w.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(o){const a=Mr(o,`Failed to get document '${r} from cache`);i.reject(a)}}(await hh(t),e,n)),n.promise}function gw(t,e,n={}){const s=new Qe;return t.asyncQueue.enqueueAndForget(async()=>function(r,i,o,a,c){const u=new Za({next:h=>{i.enqueueAndForget(()=>Zl(r,l));const f=h.docs.has(o);!f&&h.fromCache?c.reject(new b(w.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&a&&a.source==="server"?c.reject(new b(w.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),l=new th(Sr(o.path),u,{includeMetadataChanges:!0,Nu:!0});return Xl(r,l)}(await Ar(t),t.asyncQueue,e,n,s)),s.promise}function Mx(t,e){const n=new Qe;return t.asyncQueue.enqueueAndForget(async()=>async function(s,r,i){try{const o=await aa(s,r,!0),a=new Zy(r,o.Hi),c=a.Wu(o.documents),u=a.applyChanges(c,!1);i.resolve(u.snapshot)}catch(o){const a=Mr(o,`Failed to execute query '${r} against cache`);i.reject(a)}}(await hh(t),e,n)),n.promise}function pw(t,e,n={}){const s=new Qe;return t.asyncQueue.enqueueAndForget(async()=>function(r,i,o,a,c){const u=new Za({next:h=>{i.enqueueAndForget(()=>Zl(r,l)),h.fromCache&&a.source==="server"?c.reject(new b(w.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),l=new th(o,u,{includeMetadataChanges:!0,Nu:!0});return Xl(r,l)}(await Ar(t),t.asyncQueue,e,n,s)),s.promise}function Bx(t,e){const n=new Za(e);return t.asyncQueue.enqueueAndForget(async()=>function(s,r){R(s).Ru.add(r),r.next()}(await Ar(t),n)),()=>{n.bc(),t.asyncQueue.enqueueAndForget(async()=>function(s,r){R(s).Ru.delete(r)}(await Ar(t),n))}}function Px(t,e,n,s){const r=function(i,o){let a;return a=typeof i=="string"?new TextEncoder().encode(i):i,function(c,u){return new Cx(c,u)}(function(c,u){if(c instanceof Uint8Array)return qd(c,u);if(c instanceof ArrayBuffer)return qd(new Uint8Array(c),u);if(c instanceof ReadableStream)return c.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),o)}(n,Zi(e));t.asyncQueue.enqueueAndForget(async()=>{Ix(await fh(t),r,s)})}function Lx(t,e){return t.asyncQueue.enqueue(async()=>function(n,s){const r=R(n);return r.persistence.runTransaction("Get named query","readonly",i=>r.Ns.getNamedQuery(i,s))}(await hh(t),e))}class Fx{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.qc=!1,this.Uc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new Gl(this,"async_queue_retry"),this.Wc=()=>{const n=Po();n&&T("AsyncQueue","Visibility state changed to "+n.visibilityState),this.xo.Po()};const e=Po();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.qc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.zc(),this.Hc(e)}enterRestrictedMode(e){if(!this.qc){this.qc=!0,this.Qc=e||!1;const n=Po();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Wc)}}enqueue(e){if(this.zc(),this.qc)return new Promise(()=>{});const n=new Qe;return this.Hc(()=>this.qc&&this.Qc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Lc.push(e),this.Jc()))}async Jc(){if(this.Lc.length!==0){try{await this.Lc[0](),this.Lc.shift(),this.xo.reset()}catch(e){if(!$n(e))throw e;T("AsyncQueue","Operation failed with retryable error: "+e)}this.Lc.length>0&&this.xo.Ro(()=>this.Jc())}}Hc(e){const n=this.Bc.then(()=>(this.Gc=!0,e().catch(s=>{this.Kc=s,this.Gc=!1;const r=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(s);throw Oe("INTERNAL UNHANDLED ERROR: ",r),s}).then(s=>(this.Gc=!1,s))));return this.Bc=n,n}enqueueAfterDelay(e,n,s){this.zc(),this.jc.indexOf(e)>-1&&(n=0);const r=Jl.createAndSchedule(this,e,n,s,i=>this.Yc(i));return this.Uc.push(r),r}zc(){this.Kc&&L()}verifyOperationInProgress(){}async Xc(){let e;do e=this.Bc,await e;while(e!==this.Bc)}Zc(e){for(const n of this.Uc)if(n.timerId===e)return!0;return!1}ta(e){return this.Xc().then(()=>{this.Uc.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.Uc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Xc()})}ea(e){this.jc.push(e)}Yc(e){const n=this.Uc.indexOf(e);this.Uc.splice(n,1)}}function Nu(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const s=e;for(const r of n)if(r in s&&typeof s[r]=="function")return!0;return!1}(t,["next","error","complete"])}class Vx{constructor(){this._progressObserver={},this._taskCompletionResolver=new Qe,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,s){this._progressObserver={next:e,error:n,complete:s}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x=-1;class ke extends to{constructor(e,n,s,r){super(e,n,s,r),this.type="firestore",this._queue=new Fx,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||mw(this),this._firestoreClient.terminate()}}function Ge(t){return t._firestoreClient||mw(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function mw(t){var e;const n=t._freezeSettings(),s=function(r,i,o,a){return new J_(r,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Dx(t._authCredentials,t._appCheckCredentials,t._queue,s)}function Ux(t,e){ww(t=ue(t,ke));const n=Ge(t),s=t._freezeSettings(),r=new ch;return yw(n,r,new rw(r,s.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function qx(t){ww(t=ue(t,ke));const e=Ge(t),n=t._freezeSettings(),s=new ch;return yw(e,s,new bx(s,n.cacheSizeBytes))}function yw(t,e,n){const s=new Qe;return t.asyncQueue.enqueue(async()=>{try{await lw(t,n),await hw(t,e),s.resolve()}catch(r){const i=r;if(!function(o){return o.name==="FirebaseError"?o.code===w.FAILED_PRECONDITION||o.code===w.UNIMPLEMENTED:typeof DOMException<"u"&&o instanceof DOMException?o.code===22||o.code===20||o.code===11:!0}(i))throw i;cr("Error enabling offline persistence. Falling back to persistence disabled: "+i),s.reject(i)}}).then(()=>s.promise)}function jx(t){if(t._initialized&&!t._terminated)throw new b(w.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Qe;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(n){if(!Ot.C())return Promise.resolve();const s=n+"main";await Ot.delete(s)}(Ql(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function Qx(t){return function(e){const n=new Qe;return e.asyncQueue.enqueueAndForget(async()=>hx(await fh(e),n)),n.promise}(Ge(t=ue(t,ke)))}function Hx(t){return kx(Ge(t=ue(t,ke)))}function Kx(t){return Ox(Ge(t=ue(t,ke)))}function Gx(t,e){const n=Ge(t=ue(t,ke)),s=new Vx;return Px(n,t._databaseId,e,s),s}function zx(t,e){return Lx(Ge(t=ue(t,ke)),e).then(n=>n?new Xe(t,null,n.query):null)}function ww(t){if(t._initialized||t._terminated)throw new b(w.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Yt($e.fromBase64String(e))}catch(n){throw new b(w.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Yt($e.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new b(w.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Re(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new b(w.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new b(w.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Y(this._lat,e._lat)||Y(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wx=/^__.*__$/;class Yx{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new cn(e,this.data,this.fieldMask,n,this.fieldTransforms):new Dr(e,this.data,n,this.fieldTransforms)}}class Aw{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new cn(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function vw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw L()}}class nc{constructor(e,n,s,r,i,o){this.settings=e,this.databaseId=n,this.yt=s,this.ignoreUndefinedProperties=r,i===void 0&&this.na(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(e){return new nc(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.yt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.ia({path:s,oa:!1});return r.ua(e),r}ca(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.ia({path:s,oa:!1});return r.na(),r}aa(e){return this.ia({path:void 0,oa:!0})}ha(e){return fa(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}na(){if(this.path)for(let e=0;e<this.path.length;e++)this.ua(this.path.get(e))}ua(e){if(e.length===0)throw this.ha("Document fields must not be empty");if(vw(this.sa)&&Wx.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}class Jx{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.yt=s||Zi(e)}da(e,n,s,r=!1){return new nc({sa:e,methodName:n,fa:s,path:Re.emptyPath(),oa:!1,la:r},this.databaseId,this.yt,this.ignoreUndefinedProperties)}}function Ds(t){const e=t._freezeSettings(),n=Zi(t._databaseId);return new Jx(t._databaseId,!!e.ignoreUndefinedProperties,n)}function sc(t,e,n,s,r,i={}){const o=t.da(i.merge||i.mergeFields?2:0,e,n,r);mh("Data must be an object, but it was:",o,s);const a=bw(s,o);let c,u;if(i.merge)c=new Et(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const l=[];for(const h of i.mergeFields){const f=ku(e,h,n);if(!o.contains(f))throw new b(w.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);Tw(l,f)||l.push(f)}c=new Et(l),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new Yx(new Ye(a),c,u)}class no extends Ss{_toFieldTransform(e){if(e.sa!==2)throw e.sa===1?e.ha(`${this._methodName}() can only appear at the top level of your update data`):e.ha(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof no}}function Ew(t,e,n){return new nc({sa:3,fa:e.settings.fa,methodName:t._methodName,oa:n},e.databaseId,e.yt,e.ignoreUndefinedProperties)}class dh extends Ss{_toFieldTransform(e){return new Yi(e.path,new fr)}isEqual(e){return e instanceof dh}}class Xx extends Ss{constructor(e,n){super(e),this._a=n}_toFieldTransform(e){const n=Ew(this,e,!0),s=this._a.map(i=>Ns(i,n)),r=new As(s);return new Yi(e.path,r)}isEqual(e){return this===e}}class Zx extends Ss{constructor(e,n){super(e),this._a=n}_toFieldTransform(e){const n=Ew(this,e,!0),s=this._a.map(i=>Ns(i,n)),r=new vs(s);return new Yi(e.path,r)}isEqual(e){return this===e}}class eS extends Ss{constructor(e,n){super(e),this.wa=n}_toFieldTransform(e){const n=new dr(e.yt,zm(e.yt,this.wa));return new Yi(e.path,n)}isEqual(e){return this===e}}function gh(t,e,n,s){const r=t.da(1,e,n);mh("Data must be an object, but it was:",r,s);const i=[],o=Ye.empty();xs(s,(c,u)=>{const l=yh(e,c,n);u=Fe(u);const h=r.ca(l);if(u instanceof no)i.push(l);else{const f=Ns(u,h);f!=null&&(i.push(l),o.set(l,f))}});const a=new Et(i);return new Aw(o,a,r.fieldTransforms)}function ph(t,e,n,s,r,i){const o=t.da(1,e,n),a=[ku(e,s,n)],c=[r];if(i.length%2!=0)throw new b(w.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)a.push(ku(e,i[f])),c.push(i[f+1]);const u=[],l=Ye.empty();for(let f=a.length-1;f>=0;--f)if(!Tw(u,a[f])){const g=a[f];let m=c[f];m=Fe(m);const v=o.ca(g);if(m instanceof no)u.push(g);else{const S=Ns(m,v);S!=null&&(u.push(g),l.set(g,S))}}const h=new Et(u);return new Aw(l,h,o.fieldTransforms)}function Iw(t,e,n,s=!1){return Ns(n,t.da(s?4:3,e))}function Ns(t,e){if(_w(t=Fe(t)))return mh("Unsupported field value:",e,t),bw(t,e);if(t instanceof Ss)return function(n,s){if(!vw(s.sa))throw s.ha(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.ha(`${n._methodName}() is not currently supported inside arrays`);const r=n._toFieldTransform(s);r&&s.fieldTransforms.push(r)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.oa&&e.sa!==4)throw e.ha("Nested arrays are not supported");return function(n,s){const r=[];let i=0;for(const o of n){let a=Ns(o,s.aa(i));a==null&&(a={nullValue:"NULL_VALUE"}),r.push(a),i++}return{arrayValue:{values:r}}}(t,e)}return function(n,s){if((n=Fe(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return zm(s.yt,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const r=Te.fromDate(n);return{timestampValue:gr(s.yt,r)}}if(n instanceof Te){const r=new Te(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:gr(s.yt,r)}}if(n instanceof tc)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Yt)return{bytesValue:cy(s.yt,n._byteString)};if(n instanceof Ee){const r=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(r))throw s.ha(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:Bl(n.firestore._databaseId||s.databaseId,n._key.path)}}throw s.ha(`Unsupported field value: ${Xa(n)}`)}(t,e)}function bw(t,e){const n={};return Sm(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):xs(t,(s,r)=>{const i=Ns(r,e.ra(s));i!=null&&(n[s]=i)}),{mapValue:{fields:n}}}function _w(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Te||t instanceof tc||t instanceof Yt||t instanceof Ee||t instanceof Ss)}function mh(t,e,n){if(!_w(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const s=Xa(n);throw s==="an object"?e.ha(t+" a custom object"):e.ha(t+" "+s)}}function ku(t,e,n){if((e=Fe(e))instanceof Bn)return e._internalPath;if(typeof e=="string")return yh(t,e);throw fa("Field path arguments must be of type string or ",t,!1,void 0,n)}const tS=new RegExp("[~\\*/\\[\\]]");function yh(t,e,n){if(e.search(tS)>=0)throw fa(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Bn(...e.split("."))._internalPath}catch{throw fa(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function fa(t,e,n,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${s}`),o&&(c+=` in document ${r}`),c+=")"),new b(w.INVALID_ARGUMENT,a+t+c)}function Tw(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,n,s,r,i){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ee(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new nS(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(rc("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class nS extends Ri{data(){return super.data()}}function rc(t,e){return typeof e=="string"?yh(t,e):e instanceof Bn?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new b(w.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wh{}class so extends wh{}function pn(t,e,...n){let s=[];e instanceof wh&&s.push(e),s=s.concat(n),function(r){const i=r.filter(a=>a instanceof Ah).length,o=r.filter(a=>a instanceof ic).length;if(i>1||i>0&&o>0)throw new b(w.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)t=r._apply(t);return t}class ic extends so{constructor(e,n,s){super(),this._field=e,this._op=n,this._value=s,this.type="where"}static _create(e,n,s){return new ic(e,n,s)}_apply(e){const n=this._parse(e);return Sw(e._query,n),new Xe(e.firestore,e.converter,Au(e._query,n))}_parse(e){const n=Ds(e.firestore);return function(r,i,o,a,c,u,l){let h;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new b(w.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){Qd(l,u);const f=[];for(const g of l)f.push(jd(a,r,g));h={arrayValue:{values:f}}}else h=jd(a,r,l)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||Qd(l,u),h=Iw(o,i,l,u==="in"||u==="not-in");return se.create(c,u,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function sS(t,e,n){const s=e,r=rc("where",t);return ic._create(r,s,n)}class Ah extends wh{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Ah(e,n)}_parse(e){const n=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return n.length===1?n[0]:de.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,r){let i=s;const o=r.getFlattenedFilters();for(const a of o)Sw(i,a),i=Au(i,a)}(e._query,n),new Xe(e.firestore,e.converter,Au(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class vh extends so{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new vh(e,n)}_apply(e){const n=function(s,r,i){if(s.startAt!==null)throw new b(w.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new b(w.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new Js(r,i);return function(a,c){if(kl(a)===null){const u=Qa(a);u!==null&&Dw(a,u,c.field)}}(s,o),o}(e._query,this._field,this._direction);return new Xe(e.firestore,e.converter,function(s,r){const i=s.explicitOrderBy.concat([r]);return new an(s.path,s.collectionGroup,i,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function rS(t,e="asc"){const n=e,s=rc("orderBy",t);return vh._create(s,n)}class oc extends so{constructor(e,n,s){super(),this.type=e,this._limit=n,this._limitType=s}static _create(e,n,s){return new oc(e,n,s)}_apply(e){return new Xe(e.firestore,e.converter,sa(e._query,this._limit,this._limitType))}}function iS(t){return ow("limit",t),oc._create("limit",t,"F")}function oS(t){return ow("limitToLast",t),oc._create("limitToLast",t,"L")}class ac extends so{constructor(e,n,s){super(),this.type=e,this._docOrFields=n,this._inclusive=s}static _create(e,n,s){return new ac(e,n,s)}_apply(e){const n=xw(e,this.type,this._docOrFields,this._inclusive);return new Xe(e.firestore,e.converter,function(s,r){return new an(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,r,s.endAt)}(e._query,n))}}function aS(...t){return ac._create("startAt",t,!0)}function cS(...t){return ac._create("startAfter",t,!1)}class cc extends so{constructor(e,n,s){super(),this.type=e,this._docOrFields=n,this._inclusive=s}static _create(e,n,s){return new cc(e,n,s)}_apply(e){const n=xw(e,this.type,this._docOrFields,this._inclusive);return new Xe(e.firestore,e.converter,function(s,r){return new an(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,r)}(e._query,n))}}function uS(...t){return cc._create("endBefore",t,!1)}function lS(...t){return cc._create("endAt",t,!0)}function xw(t,e,n,s){if(n[0]=Fe(n[0]),n[0]instanceof Ri)return function(r,i,o,a,c){if(!a)throw new b(w.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const u=[];for(const l of fs(r))if(l.field.isKeyField())u.push(ys(i,a.key));else{const h=a.data.field(l.field);if(Nl(h))throw new b(w.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+l.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const f=l.field.canonicalString();throw new b(w.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}u.push(h)}return new Rn(u,c)}(t._query,t.firestore._databaseId,e,n[0]._document,s);{const r=Ds(t.firestore);return function(i,o,a,c,u,l){const h=i.explicitOrderBy;if(u.length>h.length)throw new b(w.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const f=[];for(let g=0;g<u.length;g++){const m=u[g];if(h[g].field.isKeyField()){if(typeof m!="string")throw new b(w.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof m}`);if(!Ol(i)&&m.indexOf("/")!==-1)throw new b(w.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${m}' contains a slash.`);const v=i.path.child(oe.fromString(m));if(!k.isDocumentKey(v))throw new b(w.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${v}' is not because it contains an odd number of segments.`);const S=new k(v);f.push(ys(o,S))}else{const v=Iw(a,c,m);f.push(v)}}return new Rn(f,l)}(t._query,t.firestore._databaseId,r,e,n,s)}}function jd(t,e,n){if(typeof(n=Fe(n))=="string"){if(n==="")throw new b(w.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ol(e)&&n.indexOf("/")!==-1)throw new b(w.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(oe.fromString(n));if(!k.isDocumentKey(s))throw new b(w.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return ys(t,new k(s))}if(n instanceof Ee)return ys(t,n._key);throw new b(w.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Xa(n)}.`)}function Qd(t,e){if(!Array.isArray(t)||t.length===0)throw new b(w.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new b(w.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function Sw(t,e){if(e.isInequality()){const s=Qa(t),r=e.field;if(s!==null&&!s.isEqual(r))throw new b(w.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${s.toString()}' and '${r.toString()}'`);const i=kl(t);i!==null&&Dw(t,r,i)}const n=function(s,r){for(const i of s)for(const o of i.getFlattenedFilters())if(r.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new b(w.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new b(w.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function Dw(t,e,n){if(!n.isEqual(e))throw new b(w.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class Eh{convertValue(e,n="none"){switch(ms(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Se(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ps(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw L()}}convertObject(e,n){const s={};return xs(e.fields,(r,i)=>{s[r]=this.convertValue(i,n)}),s}convertGeoPoint(e){return new tc(Se(e.latitude),Se(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=Nm(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(Ci(e));default:return null}}convertTimestamp(e){const n=kn(e);return new Te(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=oe.fromString(e);q(wy(s));const r=new Nn(s.get(1),s.get(3)),i=new k(s.popFirst(5));return r.isEqual(n)||Oe(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uc(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class hS extends Eh{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ee(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class rn extends Ri{constructor(e,n,s,r,i,o){super(e,n,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ui(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(rc("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}}class ui extends rn{data(e={}){return super.data(e)}}class Pn{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new as(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new ui(this._firestore,this._userDataWriter,s.key,s,new as(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new b(w.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,r){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>{const a=new ui(s._firestore,s._userDataWriter,o.doc.key,o.doc,new as(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:a,oldIndex:-1,newIndex:i++}})}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>r||o.type!==3).map(o=>{const a=new ui(s._firestore,s._userDataWriter,o.doc.key,o.doc,new as(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),u=i.indexOf(o.doc.key)),{type:fS(o.type),doc:a,oldIndex:c,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function fS(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return L()}}function Nw(t,e){return t instanceof rn&&e instanceof rn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Pn&&e instanceof Pn&&t._firestore===e._firestore&&uw(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(t){t=ue(t,Ee);const e=ue(t.firestore,ke);return gw(Ge(e),t._key).then(n=>Ih(e,t,n))}class ks extends Eh{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ee(this.firestore,null,n)}}function gS(t){t=ue(t,Ee);const e=ue(t.firestore,ke),n=Ge(e),s=new ks(e);return Rx(n,t._key).then(r=>new rn(e,s,t._key,r,new as(r!==null&&r.hasLocalMutations,!0),t.converter))}function pS(t){t=ue(t,Ee);const e=ue(t.firestore,ke);return gw(Ge(e),t._key,{source:"server"}).then(n=>Ih(e,t,n))}function mS(t){t=ue(t,Xe);const e=ue(t.firestore,ke),n=Ge(e),s=new ks(e);return Cw(t._query),pw(n,t._query).then(r=>new Pn(e,s,t,r))}function yS(t){t=ue(t,Xe);const e=ue(t.firestore,ke),n=Ge(e),s=new ks(e);return Mx(n,t._query).then(r=>new Pn(e,s,t,r))}function wS(t){t=ue(t,Xe);const e=ue(t.firestore,ke),n=Ge(e),s=new ks(e);return pw(n,t._query,{source:"server"}).then(r=>new Pn(e,s,t,r))}function Hd(t,e,n){t=ue(t,Ee);const s=ue(t.firestore,ke),r=uc(t.converter,e,n);return ro(s,[sc(Ds(s),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,_e.none())])}function Kd(t,e,n,...s){t=ue(t,Ee);const r=ue(t.firestore,ke),i=Ds(r);let o;return o=typeof(e=Fe(e))=="string"||e instanceof Bn?ph(i,"updateDoc",t._key,e,n,s):gh(i,"updateDoc",t._key,e),ro(r,[o.toMutation(t._key,_e.exists(!0))])}function AS(t){return ro(ue(t.firestore,ke),[new Nr(t._key,_e.none())])}function vS(t,e){const n=ue(t.firestore,ke),s=ha(t),r=uc(t.converter,e);return ro(n,[sc(Ds(t.firestore),"addDoc",s._key,r,t.converter!==null,{}).toMutation(s._key,_e.exists(!1))]).then(()=>s)}function kw(t,...e){var n,s,r;t=Fe(t);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||Nu(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(Nu(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(s=h.error)===null||s===void 0?void 0:s.bind(h),e[o+2]=(r=h.complete)===null||r===void 0?void 0:r.bind(h)}let c,u,l;if(t instanceof Ee)u=ue(t.firestore,ke),l=Sr(t._key.path),c={next:h=>{e[o]&&e[o](Ih(u,t,h))},error:e[o+1],complete:e[o+2]};else{const h=ue(t,Xe);u=ue(h.firestore,ke),l=h._query;const f=new ks(u);c={next:g=>{e[o]&&e[o](new Pn(u,f,h,g))},error:e[o+1],complete:e[o+2]},Cw(t._query)}return function(h,f,g,m){const v=new Za(m),S=new th(f,v,g);return h.asyncQueue.enqueueAndForget(async()=>Xl(await Ar(h),S)),()=>{v.bc(),h.asyncQueue.enqueueAndForget(async()=>Zl(await Ar(h),S))}}(Ge(u),l,a,c)}function ES(t,e){return Bx(Ge(t=ue(t,ke)),Nu(e)?e:{next:e})}function ro(t,e){return function(n,s){const r=new Qe;return n.asyncQueue.enqueueAndForget(async()=>ax(await fh(n),s,r)),r.promise}(Ge(t),e)}function Ih(t,e,n){const s=n.docs.get(e._key),r=new ks(t);return new rn(t,r,e._key,s,new as(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IS={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Ds(e)}set(e,n,s){this._verifyNotCommitted();const r=An(e,this._firestore),i=uc(r.converter,n,s),o=sc(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,s);return this._mutations.push(o.toMutation(r._key,_e.none())),this}update(e,n,s,...r){this._verifyNotCommitted();const i=An(e,this._firestore);let o;return o=typeof(n=Fe(n))=="string"||n instanceof Bn?ph(this._dataReader,"WriteBatch.update",i._key,n,s,r):gh(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,_e.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=An(e,this._firestore);return this._mutations=this._mutations.concat(new Nr(n._key,_e.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new b(w.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function An(t,e){if((t=Fe(t)).firestore!==e)throw new b(w.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S extends class{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Ds(e)}get(e){const n=An(e,this._firestore),s=new hS(this._firestore);return this._transaction.lookup([n._key]).then(r=>{if(!r||r.length!==1)return L();const i=r[0];if(i.isFoundDocument())return new Ri(this._firestore,s,i.key,i,n.converter);if(i.isNoDocument())return new Ri(this._firestore,s,n._key,null,n.converter);throw L()})}set(e,n,s){const r=An(e,this._firestore),i=uc(r.converter,n,s),o=sc(this._dataReader,"Transaction.set",r._key,i,r.converter!==null,s);return this._transaction.set(r._key,o),this}update(e,n,s,...r){const i=An(e,this._firestore);let o;return o=typeof(n=Fe(n))=="string"||n instanceof Bn?ph(this._dataReader,"Transaction.update",i._key,n,s,r):gh(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=An(e,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=An(e,this._firestore),s=new ks(this._firestore);return super.get(e).then(r=>new rn(this._firestore,s,n._key,r._document,new as(!1,!1),n.converter))}}function TS(t,e,n){t=ue(t,ke);const s=Object.assign(Object.assign({},IS),n);return function(r){if(r.maxAttempts<1)throw new b(w.INVALID_ARGUMENT,"Max attempts must be at least 1")}(s),function(r,i,o){const a=new Qe;return r.asyncQueue.enqueueAndForget(async()=>{const c=await Nx(r);new Sx(r.asyncQueue,c,o,i,a).run()}),a.promise}(Ge(t),r=>e(new _S(t,r)),s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CS(){return new no("deleteField")}function xS(){return new dh("serverTimestamp")}function SS(...t){return new Xx("arrayUnion",t)}function DS(...t){return new Zx("arrayRemove",t)}function NS(t){return new eS("increment",t)}(function(t,e=!0){(function(n){xr=n})(rl),or(new ds("firestore",(n,{instanceIdentifier:s,options:r})=>{const i=n.getProvider("app").getImmediate(),o=new ke(new V_(n.getProvider("auth-internal")),new j_(n.getProvider("app-check-internal")),function(a,c){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new b(w.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nn(a.options.projectId,c)}(i,s),i);return r=Object.assign({useFetchStreams:e},r),o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),_n(jf,"3.8.0",t),_n(jf,"3.8.0","esm2017")})();const kS="@firebase/firestore-compat",OS="0.3.0";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bh(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new b("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gd(){if(typeof Uint8Array>"u")throw new b("unimplemented","Uint8Arrays are not available in this environment.")}function zd(){if(!X_())throw new b("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Mi{constructor(e){this._delegate=e}static fromBase64String(e){return zd(),new Mi(Yt.fromBase64String(e))}static fromUint8Array(e){return Gd(),new Mi(Yt.fromUint8Array(e))}toBase64(){return zd(),this._delegate.toBase64()}toUint8Array(){return Gd(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ou(t){return RS(t,["next","error","complete"])}function RS(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const s of e)if(s in n&&typeof n[s]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{enableIndexedDbPersistence(e,n){return Ux(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return qx(e._delegate)}clearIndexedDbPersistence(e){return jx(e._delegate)}}class Ow{constructor(e,n,s){this._delegate=n,this._persistenceProvider=s,this.INTERNAL={delete:()=>this.terminate()},e instanceof Nn||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&cr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,s={}){_x(this._delegate,e,n,s)}enableNetwork(){return Hx(this._delegate)}disableNetwork(){return Kx(this._delegate)}enablePersistence(e){let n=!1,s=!1;return e&&(n=!!e.synchronizeTabs,s=!!e.experimentalForceOwningTab,iw("synchronizeTabs",n,"experimentalForceOwningTab",s)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,s)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return Qx(this._delegate)}onSnapshotsInSync(e){return ES(this._delegate,e)}get app(){if(!this._appCompat)throw new b("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new vr(this,aw(this._delegate,e))}catch(n){throw at(n,"collection()","Firestore.collection()")}}doc(e){try{return new Ct(this,ha(this._delegate,e))}catch(n){throw at(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ot(this,Tx(this._delegate,e))}catch(n){throw at(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return TS(this._delegate,n=>e(new Rw(this,n)))}batch(){return Ge(this._delegate),new Mw(new bS(this._delegate,e=>ro(this._delegate,e)))}loadBundle(e){return Gx(this._delegate,e)}namedQuery(e){return zx(this._delegate,e).then(n=>n?new ot(this,n):null)}}class lc extends Eh{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mi(new Yt(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return Ct.forKey(n,this.firestore,null)}}function BS(t){B_(t)}class Rw{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new lc(e)}get(e){const n=cs(e);return this._delegate.get(n).then(s=>new Bi(this._firestore,new rn(this._firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,n.converter)))}set(e,n,s){const r=cs(e);return s?(bh("Transaction.set",s),this._delegate.set(r,n,s)):this._delegate.set(r,n),this}update(e,n,s,...r){const i=cs(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,s,...r),this}delete(e){const n=cs(e);return this._delegate.delete(n),this}}class Mw{constructor(e){this._delegate=e}set(e,n,s){const r=cs(e);return s?(bh("WriteBatch.set",s),this._delegate.set(r,n,s)):this._delegate.set(r,n),this}update(e,n,s,...r){const i=cs(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,s,...r),this}delete(e){const n=cs(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class _s{constructor(e,n,s){this._firestore=e,this._userDataWriter=n,this._delegate=s}fromFirestore(e,n){const s=new ui(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Pi(this._firestore,s),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const s=_s.INSTANCES;let r=s.get(e);r||(r=new WeakMap,s.set(e,r));let i=r.get(n);return i||(i=new _s(e,new lc(e),n),r.set(n,i)),i}}_s.INSTANCES=new WeakMap;class Ct{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new lc(e)}static forPath(e,n,s){if(e.length%2!==0)throw new b("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Ct(n,new Ee(n._delegate,s,new k(e)))}static forKey(e,n,s){return new Ct(n,new Ee(n._delegate,s,e))}get id(){return this._delegate.id}get parent(){return new vr(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new vr(this.firestore,aw(this._delegate,e))}catch(n){throw at(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Fe(e),e instanceof Ee?cw(this._delegate,e):!1}set(e,n){n=bh("DocumentReference.set",n);try{return n?Hd(this._delegate,e,n):Hd(this._delegate,e)}catch(s){throw at(s,"setDoc()","DocumentReference.set()")}}update(e,n,...s){try{return arguments.length===1?Kd(this._delegate,e):Kd(this._delegate,e,n,...s)}catch(r){throw at(r,"updateDoc()","DocumentReference.update()")}}delete(){return AS(this._delegate)}onSnapshot(...e){const n=Bw(e),s=Pw(e,r=>new Bi(this.firestore,new rn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return kw(this._delegate,n,s)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=gS(this._delegate):(e==null?void 0:e.source)==="server"?n=pS(this._delegate):n=dS(this._delegate),n.then(s=>new Bi(this.firestore,new rn(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)))}withConverter(e){return new Ct(this.firestore,e?this._delegate.withConverter(_s.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function at(t,e,n){return t.message=t.message.replace(e,n),t}function Bw(t){for(const e of t)if(typeof e=="object"&&!Ou(e))return e;return{}}function Pw(t,e){var n,s;let r;return Ou(t[0])?r=t[0]:Ou(t[1])?r=t[1]:typeof t[0]=="function"?r={next:t[0],error:t[1],complete:t[2]}:r={next:t[1],error:t[2],complete:t[3]},{next:i=>{r.next&&r.next(e(i))},error:(n=r.error)===null||n===void 0?void 0:n.bind(r),complete:(s=r.complete)===null||s===void 0?void 0:s.bind(r)}}class Bi{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Ct(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return Nw(this._delegate,e._delegate)}}class Pi extends Bi{data(e){const n=this._delegate.data(e);return P_(n!==void 0),n}}class ot{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new lc(e)}where(e,n,s){try{return new ot(this.firestore,pn(this._delegate,sS(e,n,s)))}catch(r){throw at(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new ot(this.firestore,pn(this._delegate,rS(e,n)))}catch(s){throw at(s,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new ot(this.firestore,pn(this._delegate,iS(e)))}catch(n){throw at(n,"limit()","Query.limit()")}}limitToLast(e){try{return new ot(this.firestore,pn(this._delegate,oS(e)))}catch(n){throw at(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new ot(this.firestore,pn(this._delegate,aS(...e)))}catch(n){throw at(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new ot(this.firestore,pn(this._delegate,cS(...e)))}catch(n){throw at(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new ot(this.firestore,pn(this._delegate,uS(...e)))}catch(n){throw at(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new ot(this.firestore,pn(this._delegate,lS(...e)))}catch(n){throw at(n,"endAt()","Query.endAt()")}}isEqual(e){return uw(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=yS(this._delegate):(e==null?void 0:e.source)==="server"?n=wS(this._delegate):n=mS(this._delegate),n.then(s=>new Ru(this.firestore,new Pn(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)))}onSnapshot(...e){const n=Bw(e),s=Pw(e,r=>new Ru(this.firestore,new Pn(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return kw(this._delegate,n,s)}withConverter(e){return new ot(this.firestore,e?this._delegate.withConverter(_s.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class PS{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Pi(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Ru{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new ot(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Pi(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new PS(this._firestore,n))}forEach(e,n){this._delegate.forEach(s=>{e.call(n,new Pi(this._firestore,s))})}isEqual(e){return Nw(this._delegate,e._delegate)}}class vr extends ot{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Ct(this.firestore,e):null}doc(e){try{return e===void 0?new Ct(this.firestore,ha(this._delegate)):new Ct(this.firestore,ha(this._delegate,e))}catch(n){throw at(n,"doc()","CollectionReference.doc()")}}add(e){return vS(this._delegate,e).then(n=>new Ct(this.firestore,n))}isEqual(e){return cw(this._delegate,e._delegate)}withConverter(e){return new vr(this.firestore,e?this._delegate.withConverter(_s.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function cs(t){return ue(t,Ee)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h{constructor(...e){this._delegate=new Bn(...e)}static documentId(){return new _h(Re.keyField().canonicalString())}isEqual(e){return e=Fe(e),e instanceof Bn?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e){this._delegate=e}static serverTimestamp(){const e=xS();return e._methodName="FieldValue.serverTimestamp",new rs(e)}static delete(){const e=CS();return e._methodName="FieldValue.delete",new rs(e)}static arrayUnion(...e){const n=SS(...e);return n._methodName="FieldValue.arrayUnion",new rs(n)}static arrayRemove(...e){const n=DS(...e);return n._methodName="FieldValue.arrayRemove",new rs(n)}static increment(e){const n=NS(e);return n._methodName="FieldValue.increment",new rs(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LS={Firestore:Ow,GeoPoint:tc,Timestamp:Te,Blob:Mi,Transaction:Rw,WriteBatch:Mw,DocumentReference:Ct,DocumentSnapshot:Bi,Query:ot,QueryDocumentSnapshot:Pi,QuerySnapshot:Ru,CollectionReference:vr,FieldPath:_h,FieldValue:rs,setLogLevel:BS,CACHE_SIZE_UNLIMITED:$x};function FS(t,e){t.INTERNAL.registerComponent(new ds("firestore-compat",n=>{const s=n.getProvider("app-compat").getImmediate(),r=n.getProvider("firestore").getImmediate();return e(s,r)},"PUBLIC").setServiceProps(Object.assign({},LS)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VS(t){FS(t,(e,n)=>new Ow(e,n,new MS)),t.registerVersion(kS,OS)}VS(xa);const $S={apiKey:"AIzaSyCZFtGqh8zhx9K9rB-kU8qd1hXtqj587Rg",authDomain:"rock-portal.firebaseapp.com",projectId:"rock-portal",storageBucket:"rock-portal.appspot.com",messagingSenderId:"131657971820",appId:"1:131657971820:web:cef78d75b1ea0230c6c049"};xa.initializeApp($S);const To=xa.firestore(),US={class:"relative h-[65vw] min-h-[520px] max-h-[767px] w-full max-w-[1180px] top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2"},qS=Sv('<img src="'+OI+'" alt="bg image" class="w-full h-full absolute top-0 left-0 select-none pointer-events-none z-0" data-v-8cff0717><img src="'+RI+'" alt="sticker" class="w-[15%] h-auto top-[50%] left-[5%] absolute z-10 rotate-12" data-v-8cff0717><img src="'+MI+'" alt="sticker" class="w-[15%] h-auto top-[65%] left-[15%] absolute z-10 -rotate-12" data-v-8cff0717><img src="'+BI+'" alt="sticker" class="w-[40%] h-auto top-[52%] left-[55%] absolute z-10" data-v-8cff0717><a href="https://compositecomputer.club" title="C3" target="_blank" class="w-[23%] h-auto top-[10%] left-[70%] absolute z-10 -rotate-12" data-v-8cff0717><img src="'+PI+'" alt="sticker" class="w-full h-auto dropshadow" data-v-8cff0717></a><a href="https://mastodon.compositecomputer.club" title="mastodon" target="_blank" class="w-[15%] h-auto top-[7%] left-[50%] absolute z-10 rotate-12" data-v-8cff0717><img src="'+LI+'" alt="sticker" class="w-full h-auto dropshadow" data-v-8cff0717></a><a href="https://toybox.compositecomputer.club" title="ToyBox" target="_blank" class="w-[20%] h-auto top-[10%] left-[60%] absolute z-10" data-v-8cff0717><img src="'+FI+'" alt="sticker" class="w-full h-auto dropshadow" data-v-8cff0717></a>',7),jS=Li({__name:"HomeView",setup(t){const e=s=>new URL(Object.assign({"../assets/C3tyan.png":wI,"../assets/ToyBox.png":AI,"../assets/c++.png":vI,"../assets/c3-logo.png":EI,"../assets/cork-board.png":II,"../assets/github.png":bI,"../assets/linkIcons/google-fot.png":_I,"../assets/linkIcons/lc.png":TI,"../assets/linkIcons/niconico.webp":CI,"../assets/links.json":xI,"../assets/logo.svg":SI,"../assets/main.css":DI,"../assets/mastodon.png":NI,"../assets/wall.jpg":kI})[`../assets/${s}`],self.location).href,n=_r({VideoSharingServices:[],KIT:[],Google:[],Other:[]});return To.collection("portal-contents").doc("KIT").get().then(s=>{console.log(s.data());const r=s.data();n.KIT=r.contents}).catch(s=>{console.log(s),n.KIT=[]}),To.collection("portal-contents").doc("VideoSharingServices").get().then(s=>{console.log(s.data());const r=s.data();n.VideoSharingServices=r.contents}).catch(s=>{console.log(s),n.VideoSharingServices=[]}),To.collection("portal-contents").doc("Google").get().then(s=>{console.log(s.data());const r=s.data();n.Google=r.contents}).catch(s=>{console.log(s),n.Google=[]}),To.collection("portal-contents").doc("Other").get().then(s=>{console.log(s.data());const r=s.data();n.Other=r.contents}).catch(s=>{console.log(s),n.Other=[]}),(s,r)=>(vt(),Xn("main",US,[qS,je(go,{class:"top-[15%] left-[15%] rotate-3","pin-color":"yellow"},{default:Gr(()=>[(vt(!0),Xn(ct,null,fo(n.VideoSharingServices,(i,o)=>(vt(),Qs(po,{key:o,"link-icon":i.iconType==="internal"?e(i.icon):i.icon,"link-name":i.name,"link-url":i.url},null,8,["link-icon","link-name","link-url"]))),128))]),_:1}),je(go,{class:"top-[25%] left-[40%] -rotate-2","pin-color":"blue"},{default:Gr(()=>[(vt(!0),Xn(ct,null,fo(n.KIT,(i,o)=>(vt(),Qs(po,{key:o,"link-icon":i.iconType==="internal"?e(i.icon):i.icon,"link-name":i.name,"link-url":i.url},null,8,["link-icon","link-name","link-url"]))),128))]),_:1}),je(go,{class:"top-[45%] left-[25%] -rotate-2","pin-color":"red"},{default:Gr(()=>[(vt(!0),Xn(ct,null,fo(n.Google,(i,o)=>(vt(),Qs(po,{key:o,"link-icon":i.iconType==="internal"?e(i.icon):i.icon,"link-name":i.name,"link-url":i.url},null,8,["link-icon","link-name","link-url"]))),128))]),_:1}),je(go,{class:"top-[35%] left-[63%] rotate-3","pin-color":"green"},{default:Gr(()=>[(vt(!0),Xn(ct,null,fo(n.Other,(i,o)=>(vt(),Qs(po,{key:o,"link-icon":i.iconType==="internal"?e(i.icon):i.icon,"link-name":i.name,"link-url":i.url},null,8,["link-icon","link-name","link-url"]))),128))]),_:1})]))}});const QS=_a(jS,[["__scopeId","data-v-8cff0717"]]),HS=mI({history:OE("/rock-portal/"),routes:[{path:"/",name:"home",component:QS},{path:"/about",name:"about",component:()=>gE(()=>import("./AboutView-73bc9eca.js"),["assets/AboutView-73bc9eca.js","assets/AboutView-4d995ba2.css"])}]});const Lw=aE(hE);Lw.use(HS);Lw.mount("#app");export{_a as _,tr as a,Xn as c,vt as o};
